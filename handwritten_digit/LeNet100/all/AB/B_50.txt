loading data...
#train = 23525, #test = 4861, #valid = 5879
building model and compiling functions...
w=(32, 1, 5, 5),b=(32,)
layers other than "dense", "conv" layers, donnot have params
w=(32, 32, 5, 5),b=(32,)
layers other than "dense", "conv" layers, donnot have params
layers other than "dense", "conv" layers, donnot have params
w=(512, 256),b=(256,)
layers other than "dense", "conv" layers, donnot have params
w=(256, 10),b=(10,)
decomposing tensor W of shape (4, 512, 800)...
decomposing tensor B of shape (4, 800)...
starting training...
Epoch 1 of 100 took 16.968s
  training loss:		2.392324
  validation loss:		2.334660
  validation accuracy:		0.00 %
Epoch 2 of 100 took 16.606s
  training loss:		2.299905
  validation loss:		2.268113
  validation accuracy:		21.27 %
Epoch 3 of 100 took 16.681s
  training loss:		2.239299
  validation loss:		2.211238
  validation accuracy:		21.27 %
Epoch 4 of 100 took 17.285s
  training loss:		2.184774
  validation loss:		2.158679
  validation accuracy:		21.27 %
Epoch 5 of 100 took 17.575s
  training loss:		2.133886
  validation loss:		2.109156
  validation accuracy:		14.73 %
Epoch 6 of 100 took 16.968s
  training loss:		2.085779
  validation loss:		2.062012
  validation accuracy:		14.73 %
Epoch 7 of 100 took 17.825s
  training loss:		2.040299
  validation loss:		2.016076
  validation accuracy:		14.73 %
Epoch 8 of 100 took 17.876s
  training loss:		1.995778
  validation loss:		1.966731
  validation accuracy:		14.73 %
Epoch 9 of 100 took 17.917s
  training loss:		1.942906
  validation loss:		1.884696
  validation accuracy:		21.51 %
Epoch 10 of 100 took 17.938s
  training loss:		1.822153
  validation loss:		1.698960
  validation accuracy:		21.51 %
Epoch 11 of 100 took 17.478s
  training loss:		1.671805
  validation loss:		1.623723
  validation accuracy:		21.51 %
Epoch 12 of 100 took 16.883s
  training loss:		1.629620
  validation loss:		1.616318
  validation accuracy:		14.73 %
Epoch 13 of 100 took 16.790s
  training loss:		1.622960
  validation loss:		1.612293
  validation accuracy:		14.73 %
Epoch 14 of 100 took 16.914s
  training loss:		1.617804
  validation loss:		1.612007
  validation accuracy:		14.73 %
Epoch 15 of 100 took 16.777s
  training loss:		1.615241
  validation loss:		1.608633
  validation accuracy:		21.51 %
Epoch 16 of 100 took 16.986s
  training loss:		1.614271
  validation loss:		1.604939
  validation accuracy:		21.51 %
Epoch 17 of 100 took 16.486s
  training loss:		1.610413
  validation loss:		1.606568
  validation accuracy:		21.51 %
Epoch 18 of 100 took 13.400s
  training loss:		1.609634
  validation loss:		1.606883
  validation accuracy:		14.73 %
Epoch 19 of 100 took 13.006s
  training loss:		1.607455
  validation loss:		1.603541
  validation accuracy:		46.07 %
Epoch 20 of 100 took 13.608s
  training loss:		1.606012
  validation loss:		1.602585
  validation accuracy:		35.33 %
Epoch 21 of 100 took 13.161s
  training loss:		1.605437
  validation loss:		1.602808
  validation accuracy:		16.18 %
Epoch 22 of 100 took 12.997s
  training loss:		1.602556
  validation loss:		1.595333
  validation accuracy:		23.13 %
Epoch 23 of 100 took 13.004s
  training loss:		1.602157
  validation loss:		1.595242
  validation accuracy:		34.33 %
Epoch 24 of 100 took 12.993s
  training loss:		1.599502
  validation loss:		1.589822
  validation accuracy:		42.53 %
Epoch 25 of 100 took 13.002s
  training loss:		1.596233
  validation loss:		1.584078
  validation accuracy:		53.25 %
Epoch 26 of 100 took 13.006s
  training loss:		1.593143
  validation loss:		1.582045
  validation accuracy:		24.29 %
Epoch 27 of 100 took 13.005s
  training loss:		1.591351
  validation loss:		1.574949
  validation accuracy:		61.05 %
Epoch 28 of 100 took 13.040s
  training loss:		1.587432
  validation loss:		1.565341
  validation accuracy:		40.62 %
Epoch 29 of 100 took 13.110s
  training loss:		1.582806
  validation loss:		1.560504
  validation accuracy:		53.89 %
Epoch 30 of 100 took 13.022s
  training loss:		1.576731
  validation loss:		1.547127
  validation accuracy:		62.80 %
Epoch 31 of 100 took 13.000s
  training loss:		1.571277
  validation loss:		1.532977
  validation accuracy:		53.18 %
Epoch 32 of 100 took 13.000s
  training loss:		1.559274
  validation loss:		1.511537
  validation accuracy:		57.00 %
Epoch 33 of 100 took 13.075s
  training loss:		1.548784
  validation loss:		1.487669
  validation accuracy:		65.75 %
Epoch 34 of 100 took 13.080s
  training loss:		1.537098
  validation loss:		1.464006
  validation accuracy:		63.49 %
Epoch 35 of 100 took 13.004s
  training loss:		1.518280
  validation loss:		1.429499
  validation accuracy:		66.67 %
Epoch 36 of 100 took 12.998s
  training loss:		1.499860
  validation loss:		1.386141
  validation accuracy:		67.87 %
Epoch 37 of 100 took 12.996s
  training loss:		1.470692
  validation loss:		1.338478
  validation accuracy:		66.22 %
Epoch 38 of 100 took 13.004s
  training loss:		1.434419
  validation loss:		1.278354
  validation accuracy:		70.07 %
Epoch 39 of 100 took 12.993s
  training loss:		1.391678
  validation loss:		1.214302
  validation accuracy:		71.27 %
Epoch 40 of 100 took 12.998s
  training loss:		1.347677
  validation loss:		1.145788
  validation accuracy:		70.62 %
Epoch 41 of 100 took 13.012s
  training loss:		1.299393
  validation loss:		1.076443
  validation accuracy:		76.51 %
Epoch 42 of 100 took 12.993s
  training loss:		1.245756
  validation loss:		1.007218
  validation accuracy:		77.69 %
Epoch 43 of 100 took 13.341s
  training loss:		1.178940
  validation loss:		0.930528
  validation accuracy:		79.49 %
Epoch 44 of 100 took 14.777s
  training loss:		1.105942
  validation loss:		0.852066
  validation accuracy:		79.05 %
Epoch 45 of 100 took 13.326s
  training loss:		1.038815
  validation loss:		0.781712
  validation accuracy:		80.69 %
Epoch 46 of 100 took 13.263s
  training loss:		0.976585
  validation loss:		0.720902
  validation accuracy:		80.55 %
Epoch 47 of 100 took 13.278s
  training loss:		0.921505
  validation loss:		0.668325
  validation accuracy:		80.49 %
Epoch 48 of 100 took 13.233s
  training loss:		0.875190
  validation loss:		0.624224
  validation accuracy:		80.96 %
Epoch 49 of 100 took 13.170s
  training loss:		0.839723
  validation loss:		0.588188
  validation accuracy:		82.04 %
Epoch 50 of 100 took 13.144s
  training loss:		0.806043
  validation loss:		0.558415
  validation accuracy:		82.98 %
Epoch 51 of 100 took 13.231s
  training loss:		0.769164
  validation loss:		0.530991
  validation accuracy:		84.15 %
Epoch 52 of 100 took 13.153s
  training loss:		0.741565
  validation loss:		0.500886
  validation accuracy:		84.67 %
Epoch 53 of 100 took 13.238s
  training loss:		0.722237
  validation loss:		0.482561
  validation accuracy:		85.40 %
Epoch 54 of 100 took 13.180s
  training loss:		0.698629
  validation loss:		0.456276
  validation accuracy:		86.44 %
Epoch 55 of 100 took 13.173s
  training loss:		0.672957
  validation loss:		0.438796
  validation accuracy:		86.96 %
Epoch 56 of 100 took 13.171s
  training loss:		0.658478
  validation loss:		0.419286
  validation accuracy:		87.55 %
Epoch 57 of 100 took 13.230s
  training loss:		0.646554
  validation loss:		0.403090
  validation accuracy:		88.38 %
Epoch 58 of 100 took 13.286s
  training loss:		0.625133
  validation loss:		0.387932
  validation accuracy:		89.04 %
Epoch 59 of 100 took 13.183s
  training loss:		0.608587
  validation loss:		0.372068
  validation accuracy:		89.47 %
Epoch 60 of 100 took 13.172s
  training loss:		0.593520
  validation loss:		0.357028
  validation accuracy:		90.00 %
Epoch 61 of 100 took 13.165s
  training loss:		0.583574
  validation loss:		0.346062
  validation accuracy:		90.64 %
Epoch 62 of 100 took 13.150s
  training loss:		0.561972
  validation loss:		0.333784
  validation accuracy:		90.71 %
Epoch 63 of 100 took 13.231s
  training loss:		0.559863
  validation loss:		0.323225
  validation accuracy:		91.42 %
Epoch 64 of 100 took 13.189s
  training loss:		0.553987
  validation loss:		0.314464
  validation accuracy:		91.65 %
Epoch 65 of 100 took 13.176s
  training loss:		0.539876
  validation loss:		0.304301
  validation accuracy:		92.16 %
Epoch 66 of 100 took 13.171s
  training loss:		0.528635
  validation loss:		0.293844
  validation accuracy:		92.33 %
Epoch 67 of 100 took 13.179s
  training loss:		0.509676
  validation loss:		0.286492
  validation accuracy:		92.53 %
Epoch 68 of 100 took 13.182s
  training loss:		0.505052
  validation loss:		0.278128
  validation accuracy:		92.55 %
Epoch 69 of 100 took 13.178s
  training loss:		0.491560
  validation loss:		0.269991
  validation accuracy:		92.96 %
Epoch 70 of 100 took 13.173s
  training loss:		0.496945
  validation loss:		0.266144
  validation accuracy:		93.15 %
Epoch 71 of 100 took 13.165s
  training loss:		0.474382
  validation loss:		0.259065
  validation accuracy:		93.15 %
Epoch 72 of 100 took 13.181s
  training loss:		0.474688
  validation loss:		0.255459
  validation accuracy:		93.11 %
Epoch 73 of 100 took 13.187s
  training loss:		0.467874
  validation loss:		0.249833
  validation accuracy:		93.33 %
Epoch 74 of 100 took 13.321s
  training loss:		0.459619
  validation loss:		0.244619
  validation accuracy:		93.24 %
Epoch 75 of 100 took 13.165s
  training loss:		0.450926
  validation loss:		0.238753
  validation accuracy:		93.25 %
Epoch 76 of 100 took 13.198s
  training loss:		0.449028
  validation loss:		0.234810
  validation accuracy:		93.53 %
Epoch 77 of 100 took 13.279s
  training loss:		0.441524
  validation loss:		0.228021
  validation accuracy:		93.71 %
Epoch 78 of 100 took 13.205s
  training loss:		0.439468
  validation loss:		0.230615
  validation accuracy:		93.64 %
Epoch 79 of 100 took 13.216s
  training loss:		0.431078
  validation loss:		0.222225
  validation accuracy:		93.91 %
Epoch 80 of 100 took 13.262s
  training loss:		0.427750
  validation loss:		0.218052
  validation accuracy:		94.07 %
Epoch 81 of 100 took 13.231s
  training loss:		0.415971
  validation loss:		0.215125
  validation accuracy:		94.07 %
Epoch 82 of 100 took 13.174s
  training loss:		0.409242
  validation loss:		0.211672
  validation accuracy:		94.02 %
Epoch 83 of 100 took 13.336s
  training loss:		0.409314
  validation loss:		0.210077
  validation accuracy:		94.04 %
Epoch 84 of 100 took 13.179s
  training loss:		0.407891
  validation loss:		0.208933
  validation accuracy:		94.16 %
Epoch 85 of 100 took 13.173s
  training loss:		0.397738
  validation loss:		0.204647
  validation accuracy:		94.22 %
Epoch 86 of 100 took 13.196s
  training loss:		0.393067
  validation loss:		0.203164
  validation accuracy:		94.18 %
Epoch 87 of 100 took 13.181s
  training loss:		0.383852
  validation loss:		0.195080
  validation accuracy:		94.31 %
Epoch 88 of 100 took 13.170s
  training loss:		0.376535
  validation loss:		0.193999
  validation accuracy:		94.44 %
Epoch 89 of 100 took 13.169s
  training loss:		0.377039
  validation loss:		0.192122
  validation accuracy:		94.38 %
Epoch 90 of 100 took 13.331s
  training loss:		0.367735
  validation loss:		0.187971
  validation accuracy:		94.53 %
Epoch 91 of 100 took 13.192s
  training loss:		0.374067
  validation loss:		0.184924
  validation accuracy:		94.67 %
Epoch 92 of 100 took 13.169s
  training loss:		0.366205
  validation loss:		0.184205
  validation accuracy:		94.71 %
Epoch 93 of 100 took 13.249s
  training loss:		0.358358
  validation loss:		0.182131
  validation accuracy:		94.80 %
Epoch 94 of 100 took 13.232s
  training loss:		0.358468
  validation loss:		0.178949
  validation accuracy:		94.76 %
Epoch 95 of 100 took 13.231s
  training loss:		0.359829
  validation loss:		0.180651
  validation accuracy:		94.82 %
Epoch 96 of 100 took 13.281s
  training loss:		0.353862
  validation loss:		0.177483
  validation accuracy:		94.96 %
Epoch 97 of 100 took 13.185s
  training loss:		0.345622
  validation loss:		0.172133
  validation accuracy:		94.91 %
Epoch 98 of 100 took 13.172s
  training loss:		0.341990
  validation loss:		0.171439
  validation accuracy:		94.95 %
Epoch 99 of 100 took 13.169s
  training loss:		0.344496
  validation loss:		0.167653
  validation accuracy:		95.20 %
Epoch 100 of 100 took 13.185s
  training loss:		0.343614
  validation loss:		0.169617
  validation accuracy:		95.07 %
Final results:
  test loss:			0.174293
  test accuracy:		94.69 %
