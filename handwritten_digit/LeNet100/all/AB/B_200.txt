loading data...
#train = 23525, #test = 4861, #valid = 5879
building model and compiling functions...
w=(32, 1, 5, 5),b=(32,)
layers other than "dense", "conv" layers, donnot have params
w=(32, 32, 5, 5),b=(32,)
layers other than "dense", "conv" layers, donnot have params
layers other than "dense", "conv" layers, donnot have params
w=(512, 256),b=(256,)
layers other than "dense", "conv" layers, donnot have params
w=(256, 10),b=(10,)
decomposing tensor W of shape (4, 512, 800)...
decomposing tensor B of shape (4, 800)...
starting training...
Epoch 1 of 100 took 18.929s
  training loss:		2.761586
  validation loss:		2.330460
  validation accuracy:		0.00 %
Epoch 2 of 100 took 13.109s
  training loss:		2.293576
  validation loss:		2.260884
  validation accuracy:		21.27 %
Epoch 3 of 100 took 13.104s
  training loss:		2.232277
  validation loss:		2.203864
  validation accuracy:		21.24 %
Epoch 4 of 100 took 13.098s
  training loss:		2.177688
  validation loss:		2.151518
  validation accuracy:		22.78 %
Epoch 5 of 100 took 13.104s
  training loss:		2.127659
  validation loss:		2.102921
  validation accuracy:		22.78 %
Epoch 6 of 100 took 13.101s
  training loss:		2.081318
  validation loss:		2.057313
  validation accuracy:		22.78 %
Epoch 7 of 100 took 13.115s
  training loss:		2.037349
  validation loss:		2.014126
  validation accuracy:		22.78 %
Epoch 8 of 100 took 13.112s
  training loss:		1.995711
  validation loss:		1.973472
  validation accuracy:		22.78 %
Epoch 9 of 100 took 13.111s
  training loss:		1.957088
  validation loss:		1.934879
  validation accuracy:		22.78 %
Epoch 10 of 100 took 13.120s
  training loss:		1.920764
  validation loss:		1.897994
  validation accuracy:		22.78 %
Epoch 11 of 100 took 13.112s
  training loss:		1.886361
  validation loss:		1.862379
  validation accuracy:		22.85 %
Epoch 12 of 100 took 13.225s
  training loss:		1.853259
  validation loss:		1.825704
  validation accuracy:		23.20 %
Epoch 13 of 100 took 13.106s
  training loss:		1.818132
  validation loss:		1.783175
  validation accuracy:		26.80 %
Epoch 14 of 100 took 13.126s
  training loss:		1.778804
  validation loss:		1.723374
  validation accuracy:		38.78 %
Epoch 15 of 100 took 13.207s
  training loss:		1.714982
  validation loss:		1.606649
  validation accuracy:		45.35 %
Epoch 16 of 100 took 13.108s
  training loss:		1.605694
  validation loss:		1.426680
  validation accuracy:		58.11 %
Epoch 17 of 100 took 13.194s
  training loss:		1.478723
  validation loss:		1.242764
  validation accuracy:		66.44 %
Epoch 18 of 100 took 13.141s
  training loss:		1.364561
  validation loss:		1.083450
  validation accuracy:		72.22 %
Epoch 19 of 100 took 13.177s
  training loss:		1.280560
  validation loss:		0.982485
  validation accuracy:		77.51 %
Epoch 20 of 100 took 13.146s
  training loss:		1.215478
  validation loss:		0.897438
  validation accuracy:		80.04 %
Epoch 21 of 100 took 13.131s
  training loss:		1.176137
  validation loss:		0.855382
  validation accuracy:		80.96 %
Epoch 22 of 100 took 13.117s
  training loss:		1.136628
  validation loss:		0.794510
  validation accuracy:		81.25 %
Epoch 23 of 100 took 13.221s
  training loss:		1.108820
  validation loss:		0.775808
  validation accuracy:		81.82 %
Epoch 24 of 100 took 13.183s
  training loss:		1.080678
  validation loss:		0.731057
  validation accuracy:		82.49 %
Epoch 25 of 100 took 13.161s
  training loss:		1.059541
  validation loss:		0.701068
  validation accuracy:		83.44 %
Epoch 26 of 100 took 13.135s
  training loss:		1.041213
  validation loss:		0.690376
  validation accuracy:		84.07 %
Epoch 27 of 100 took 13.335s
  training loss:		1.024817
  validation loss:		0.656318
  validation accuracy:		84.62 %
Epoch 28 of 100 took 13.165s
  training loss:		0.988353
  validation loss:		0.632600
  validation accuracy:		85.13 %
Epoch 29 of 100 took 13.134s
  training loss:		0.968971
  validation loss:		0.608450
  validation accuracy:		85.78 %
Epoch 30 of 100 took 13.191s
  training loss:		0.920439
  validation loss:		0.557838
  validation accuracy:		86.33 %
Epoch 31 of 100 took 13.150s
  training loss:		0.885272
  validation loss:		0.522583
  validation accuracy:		87.40 %
Epoch 32 of 100 took 13.153s
  training loss:		0.842548
  validation loss:		0.482045
  validation accuracy:		87.91 %
Epoch 33 of 100 took 13.207s
  training loss:		0.799763
  validation loss:		0.444892
  validation accuracy:		88.73 %
Epoch 34 of 100 took 13.143s
  training loss:		0.751356
  validation loss:		0.410818
  validation accuracy:		89.45 %
Epoch 35 of 100 took 13.127s
  training loss:		0.712256
  validation loss:		0.379003
  validation accuracy:		89.89 %
Epoch 36 of 100 took 13.224s
  training loss:		0.674851
  validation loss:		0.348645
  validation accuracy:		90.53 %
Epoch 37 of 100 took 13.148s
  training loss:		0.635694
  validation loss:		0.320098
  validation accuracy:		91.07 %
Epoch 38 of 100 took 13.281s
  training loss:		0.614000
  validation loss:		0.305285
  validation accuracy:		91.44 %
Epoch 39 of 100 took 13.155s
  training loss:		0.593249
  validation loss:		0.295441
  validation accuracy:		92.13 %
Epoch 40 of 100 took 13.191s
  training loss:		0.563534
  validation loss:		0.276835
  validation accuracy:		92.38 %
Epoch 41 of 100 took 13.141s
  training loss:		0.553335
  validation loss:		0.268046
  validation accuracy:		92.60 %
Epoch 42 of 100 took 13.182s
  training loss:		0.535953
  validation loss:		0.252251
  validation accuracy:		93.05 %
Epoch 43 of 100 took 13.146s
  training loss:		0.511757
  validation loss:		0.246575
  validation accuracy:		93.16 %
Epoch 44 of 100 took 13.148s
  training loss:		0.498147
  validation loss:		0.237455
  validation accuracy:		93.35 %
Epoch 45 of 100 took 13.143s
  training loss:		0.488993
  validation loss:		0.230631
  validation accuracy:		93.67 %
Epoch 46 of 100 took 13.121s
  training loss:		0.480188
  validation loss:		0.226958
  validation accuracy:		93.69 %
Epoch 47 of 100 took 13.203s
  training loss:		0.464763
  validation loss:		0.212939
  validation accuracy:		94.11 %
Epoch 48 of 100 took 13.150s
  training loss:		0.463060
  validation loss:		0.214449
  validation accuracy:		94.11 %
Epoch 49 of 100 took 13.136s
  training loss:		0.451454
  validation loss:		0.204757
  validation accuracy:		94.42 %
Epoch 50 of 100 took 13.149s
  training loss:		0.439081
  validation loss:		0.197795
  validation accuracy:		94.47 %
Epoch 51 of 100 took 13.157s
  training loss:		0.436713
  validation loss:		0.194693
  validation accuracy:		94.67 %
Epoch 52 of 100 took 13.141s
  training loss:		0.423914
  validation loss:		0.189867
  validation accuracy:		94.62 %
Epoch 53 of 100 took 13.143s
  training loss:		0.422096
  validation loss:		0.184978
  validation accuracy:		94.87 %
Epoch 54 of 100 took 13.160s
  training loss:		0.418583
  validation loss:		0.182149
  validation accuracy:		94.95 %
Epoch 55 of 100 took 13.274s
  training loss:		0.411462
  validation loss:		0.177164
  validation accuracy:		95.07 %
Epoch 56 of 100 took 13.253s
  training loss:		0.403909
  validation loss:		0.169868
  validation accuracy:		95.36 %
Epoch 57 of 100 took 13.139s
  training loss:		0.395024
  validation loss:		0.167181
  validation accuracy:		95.44 %
Epoch 58 of 100 took 13.309s
  training loss:		0.393313
  validation loss:		0.164854
  validation accuracy:		95.45 %
Epoch 59 of 100 took 13.132s
  training loss:		0.390969
  validation loss:		0.163900
  validation accuracy:		95.62 %
Epoch 60 of 100 took 13.268s
  training loss:		0.379603
  validation loss:		0.161113
  validation accuracy:		95.67 %
Epoch 61 of 100 took 13.154s
  training loss:		0.376635
  validation loss:		0.156326
  validation accuracy:		95.69 %
Epoch 62 of 100 took 13.143s
  training loss:		0.365296
  validation loss:		0.150366
  validation accuracy:		95.82 %
Epoch 63 of 100 took 13.179s
  training loss:		0.365462
  validation loss:		0.147104
  validation accuracy:		95.95 %
Epoch 64 of 100 took 13.159s
  training loss:		0.357603
  validation loss:		0.145218
  validation accuracy:		96.04 %
Epoch 65 of 100 took 13.152s
  training loss:		0.355626
  validation loss:		0.144460
  validation accuracy:		95.98 %
Epoch 66 of 100 took 13.155s
  training loss:		0.344248
  validation loss:		0.140099
  validation accuracy:		96.05 %
Epoch 67 of 100 took 13.159s
  training loss:		0.339008
  validation loss:		0.138242
  validation accuracy:		95.98 %
Epoch 68 of 100 took 13.174s
  training loss:		0.333051
  validation loss:		0.137492
  validation accuracy:		96.16 %
Epoch 69 of 100 took 13.275s
  training loss:		0.331532
  validation loss:		0.135460
  validation accuracy:		96.20 %
Epoch 70 of 100 took 13.152s
  training loss:		0.326091
  validation loss:		0.132959
  validation accuracy:		96.24 %
Epoch 71 of 100 took 13.316s
  training loss:		0.322199
  validation loss:		0.130081
  validation accuracy:		96.33 %
Epoch 72 of 100 took 13.150s
  training loss:		0.317678
  validation loss:		0.126898
  validation accuracy:		96.44 %
Epoch 73 of 100 took 13.186s
  training loss:		0.319715
  validation loss:		0.126382
  validation accuracy:		96.38 %
Epoch 74 of 100 took 13.243s
  training loss:		0.304470
  validation loss:		0.122043
  validation accuracy:		96.40 %
Epoch 75 of 100 took 13.208s
  training loss:		0.305150
  validation loss:		0.121560
  validation accuracy:		96.47 %
Epoch 76 of 100 took 13.158s
  training loss:		0.299815
  validation loss:		0.118898
  validation accuracy:		96.49 %
Epoch 77 of 100 took 13.148s
  training loss:		0.295148
  validation loss:		0.117382
  validation accuracy:		96.47 %
Epoch 78 of 100 took 13.136s
  training loss:		0.295197
  validation loss:		0.119143
  validation accuracy:		96.38 %
Epoch 79 of 100 took 13.187s
  training loss:		0.290389
  validation loss:		0.116810
  validation accuracy:		96.44 %
Epoch 80 of 100 took 13.145s
  training loss:		0.279656
  validation loss:		0.114593
  validation accuracy:		96.47 %
Epoch 81 of 100 took 13.157s
  training loss:		0.280370
  validation loss:		0.114409
  validation accuracy:		96.49 %
Epoch 82 of 100 took 13.136s
  training loss:		0.278457
  validation loss:		0.113047
  validation accuracy:		96.45 %
Epoch 83 of 100 took 13.178s
  training loss:		0.270010
  validation loss:		0.110930
  validation accuracy:		96.45 %
Epoch 84 of 100 took 13.141s
  training loss:		0.267712
  validation loss:		0.107908
  validation accuracy:		96.60 %
Epoch 85 of 100 took 13.298s
  training loss:		0.269699
  validation loss:		0.107526
  validation accuracy:		96.65 %
Epoch 86 of 100 took 13.166s
  training loss:		0.268622
  validation loss:		0.107640
  validation accuracy:		96.58 %
Epoch 87 of 100 took 13.151s
  training loss:		0.261298
  validation loss:		0.106866
  validation accuracy:		96.60 %
Epoch 88 of 100 took 13.231s
  training loss:		0.257607
  validation loss:		0.105738
  validation accuracy:		96.69 %
Epoch 89 of 100 took 13.134s
  training loss:		0.255625
  validation loss:		0.102960
  validation accuracy:		96.71 %
Epoch 90 of 100 took 13.192s
  training loss:		0.257752
  validation loss:		0.101539
  validation accuracy:		96.80 %
Epoch 91 of 100 took 13.165s
  training loss:		0.249892
  validation loss:		0.099641
  validation accuracy:		96.85 %
Epoch 92 of 100 took 13.138s
  training loss:		0.252293
  validation loss:		0.099289
  validation accuracy:		96.87 %
Epoch 93 of 100 took 13.139s
  training loss:		0.250661
  validation loss:		0.099326
  validation accuracy:		96.85 %
Epoch 94 of 100 took 13.118s
  training loss:		0.240820
  validation loss:		0.099237
  validation accuracy:		96.78 %
Epoch 95 of 100 took 13.196s
  training loss:		0.237720
  validation loss:		0.098802
  validation accuracy:		96.87 %
Epoch 96 of 100 took 13.147s
  training loss:		0.238480
  validation loss:		0.096326
  validation accuracy:		96.89 %
Epoch 97 of 100 took 13.187s
  training loss:		0.245578
  validation loss:		0.095676
  validation accuracy:		96.96 %
Epoch 98 of 100 took 13.137s
  training loss:		0.230727
  validation loss:		0.093634
  validation accuracy:		96.96 %
Epoch 99 of 100 took 13.162s
  training loss:		0.230548
  validation loss:		0.093417
  validation accuracy:		96.96 %
Epoch 100 of 100 took 13.156s
  training loss:		0.231420
  validation loss:		0.092413
  validation accuracy:		97.00 %
Final results:
  test loss:			0.094549
  test accuracy:		96.76 %
