loading data...
#train = 23525, #test = 4861, #valid = 5879
building model and compiling functions...
w=(32, 1, 5, 5),b=(32,)
layers other than "dense", "conv" layers, donnot have params
w=(32, 32, 5, 5),b=(32,)
layers other than "dense", "conv" layers, donnot have params
layers other than "dense", "conv" layers, donnot have params
w=(512, 256),b=(256,)
layers other than "dense", "conv" layers, donnot have params
w=(256, 10),b=(10,)
decomposing tensor W of shape (4, 512, 800)...
decomposing tensor B of shape (4, 800)...
starting training...
Epoch 1 of 100 took 13.465s
  training loss:		2.375816
  validation loss:		2.304859
  validation accuracy:		0.00 %
Epoch 2 of 100 took 13.800s
  training loss:		2.174952
  validation loss:		1.916528
  validation accuracy:		21.27 %
Epoch 3 of 100 took 13.972s
  training loss:		1.731518
  validation loss:		1.631614
  validation accuracy:		14.73 %
Epoch 4 of 100 took 13.759s
  training loss:		1.624038
  validation loss:		1.611743
  validation accuracy:		21.27 %
Epoch 5 of 100 took 13.355s
  training loss:		1.615371
  validation loss:		1.608212
  validation accuracy:		21.51 %
Epoch 6 of 100 took 14.019s
  training loss:		1.612366
  validation loss:		1.608489
  validation accuracy:		21.51 %
Epoch 7 of 100 took 14.603s
  training loss:		1.610060
  validation loss:		1.604226
  validation accuracy:		21.27 %
Epoch 8 of 100 took 13.942s
  training loss:		1.609410
  validation loss:		1.606836
  validation accuracy:		21.51 %
Epoch 9 of 100 took 13.459s
  training loss:		1.607407
  validation loss:		1.603596
  validation accuracy:		32.33 %
Epoch 10 of 100 took 13.669s
  training loss:		1.606707
  validation loss:		1.599276
  validation accuracy:		22.24 %
Epoch 11 of 100 took 13.423s
  training loss:		1.605718
  validation loss:		1.602979
  validation accuracy:		15.69 %
Epoch 12 of 100 took 13.404s
  training loss:		1.603792
  validation loss:		1.598140
  validation accuracy:		42.53 %
Epoch 13 of 100 took 13.636s
  training loss:		1.602743
  validation loss:		1.596856
  validation accuracy:		57.31 %
Epoch 14 of 100 took 13.526s
  training loss:		1.603411
  validation loss:		1.595201
  validation accuracy:		36.87 %
Epoch 15 of 100 took 13.390s
  training loss:		1.599987
  validation loss:		1.594632
  validation accuracy:		28.18 %
Epoch 16 of 100 took 13.509s
  training loss:		1.598544
  validation loss:		1.584276
  validation accuracy:		21.60 %
Epoch 17 of 100 took 13.832s
  training loss:		1.596432
  validation loss:		1.583679
  validation accuracy:		53.15 %
Epoch 18 of 100 took 13.394s
  training loss:		1.594007
  validation loss:		1.580023
  validation accuracy:		44.11 %
Epoch 19 of 100 took 13.580s
  training loss:		1.589908
  validation loss:		1.569639
  validation accuracy:		32.53 %
Epoch 20 of 100 took 13.517s
  training loss:		1.586797
  validation loss:		1.563167
  validation accuracy:		50.55 %
Epoch 21 of 100 took 13.502s
  training loss:		1.584030
  validation loss:		1.553462
  validation accuracy:		51.11 %
Epoch 22 of 100 took 13.876s
  training loss:		1.575399
  validation loss:		1.546626
  validation accuracy:		49.02 %
Epoch 23 of 100 took 13.515s
  training loss:		1.571222
  validation loss:		1.534586
  validation accuracy:		54.80 %
Epoch 24 of 100 took 13.514s
  training loss:		1.561723
  validation loss:		1.525482
  validation accuracy:		35.45 %
Epoch 25 of 100 took 13.651s
  training loss:		1.554784
  validation loss:		1.493587
  validation accuracy:		59.91 %
Epoch 26 of 100 took 13.848s
  training loss:		1.540725
  validation loss:		1.475886
  validation accuracy:		59.85 %
Epoch 27 of 100 took 13.393s
  training loss:		1.527972
  validation loss:		1.439453
  validation accuracy:		59.38 %
Epoch 28 of 100 took 13.422s
  training loss:		1.508313
  validation loss:		1.404138
  validation accuracy:		62.04 %
Epoch 29 of 100 took 13.563s
  training loss:		1.483411
  validation loss:		1.365166
  validation accuracy:		64.55 %
Epoch 30 of 100 took 13.708s
  training loss:		1.461124
  validation loss:		1.312876
  validation accuracy:		63.33 %
Epoch 31 of 100 took 13.699s
  training loss:		1.419433
  validation loss:		1.249920
  validation accuracy:		63.18 %
Epoch 32 of 100 took 13.801s
  training loss:		1.369759
  validation loss:		1.185184
  validation accuracy:		66.22 %
Epoch 33 of 100 took 13.668s
  training loss:		1.322533
  validation loss:		1.123002
  validation accuracy:		69.85 %
Epoch 34 of 100 took 13.353s
  training loss:		1.278737
  validation loss:		1.053525
  validation accuracy:		69.00 %
Epoch 35 of 100 took 13.339s
  training loss:		1.233591
  validation loss:		0.994926
  validation accuracy:		72.69 %
Epoch 36 of 100 took 13.395s
  training loss:		1.182148
  validation loss:		0.942531
  validation accuracy:		73.05 %
Epoch 37 of 100 took 13.748s
  training loss:		1.137843
  validation loss:		0.880775
  validation accuracy:		77.64 %
Epoch 38 of 100 took 13.552s
  training loss:		1.074495
  validation loss:		0.818530
  validation accuracy:		79.62 %
Epoch 39 of 100 took 13.419s
  training loss:		1.017547
  validation loss:		0.759848
  validation accuracy:		81.31 %
Epoch 40 of 100 took 13.340s
  training loss:		0.958315
  validation loss:		0.701673
  validation accuracy:		82.38 %
Epoch 41 of 100 took 13.570s
  training loss:		0.909382
  validation loss:		0.654602
  validation accuracy:		82.67 %
Epoch 42 of 100 took 13.501s
  training loss:		0.859470
  validation loss:		0.614008
  validation accuracy:		83.11 %
Epoch 43 of 100 took 13.488s
  training loss:		0.812180
  validation loss:		0.577372
  validation accuracy:		83.82 %
Epoch 44 of 100 took 13.449s
  training loss:		0.777504
  validation loss:		0.546095
  validation accuracy:		84.24 %
Epoch 45 of 100 took 13.456s
  training loss:		0.748501
  validation loss:		0.523027
  validation accuracy:		84.55 %
Epoch 46 of 100 took 13.219s
  training loss:		0.713719
  validation loss:		0.494504
  validation accuracy:		85.51 %
Epoch 47 of 100 took 13.494s
  training loss:		0.692564
  validation loss:		0.476466
  validation accuracy:		86.31 %
Epoch 48 of 100 took 13.557s
  training loss:		0.662285
  validation loss:		0.451191
  validation accuracy:		87.13 %
Epoch 49 of 100 took 13.514s
  training loss:		0.641820
  validation loss:		0.430337
  validation accuracy:		88.05 %
Epoch 50 of 100 took 13.651s
  training loss:		0.623603
  validation loss:		0.412643
  validation accuracy:		88.42 %
Epoch 51 of 100 took 13.249s
  training loss:		0.596466
  validation loss:		0.389808
  validation accuracy:		89.27 %
Epoch 52 of 100 took 13.911s
  training loss:		0.578755
  validation loss:		0.371801
  validation accuracy:		89.85 %
Epoch 53 of 100 took 14.405s
  training loss:		0.552791
  validation loss:		0.354109
  validation accuracy:		90.35 %
Epoch 54 of 100 took 14.240s
  training loss:		0.540448
  validation loss:		0.337807
  validation accuracy:		91.24 %
Epoch 55 of 100 took 14.443s
  training loss:		0.529731
  validation loss:		0.324798
  validation accuracy:		91.47 %
Epoch 56 of 100 took 13.820s
  training loss:		0.500670
  validation loss:		0.306706
  validation accuracy:		92.25 %
Epoch 57 of 100 took 13.652s
  training loss:		0.487468
  validation loss:		0.293395
  validation accuracy:		92.69 %
Epoch 58 of 100 took 13.118s
  training loss:		0.470592
  validation loss:		0.281146
  validation accuracy:		93.02 %
Epoch 59 of 100 took 13.215s
  training loss:		0.464950
  validation loss:		0.271111
  validation accuracy:		93.49 %
Epoch 60 of 100 took 13.575s
  training loss:		0.449781
  validation loss:		0.259882
  validation accuracy:		93.60 %
Epoch 61 of 100 took 13.416s
  training loss:		0.438303
  validation loss:		0.249414
  validation accuracy:		93.93 %
Epoch 62 of 100 took 13.469s
  training loss:		0.432005
  validation loss:		0.244194
  validation accuracy:		93.89 %
Epoch 63 of 100 took 13.495s
  training loss:		0.414590
  validation loss:		0.236084
  validation accuracy:		93.84 %
Epoch 64 of 100 took 14.026s
  training loss:		0.412476
  validation loss:		0.230945
  validation accuracy:		94.11 %
Epoch 65 of 100 took 13.908s
  training loss:		0.401299
  validation loss:		0.224410
  validation accuracy:		94.22 %
Epoch 66 of 100 took 13.457s
  training loss:		0.397006
  validation loss:		0.220216
  validation accuracy:		94.31 %
Epoch 67 of 100 took 13.436s
  training loss:		0.387295
  validation loss:		0.213558
  validation accuracy:		94.44 %
Epoch 68 of 100 took 13.530s
  training loss:		0.379926
  validation loss:		0.209912
  validation accuracy:		94.33 %
Epoch 69 of 100 took 14.307s
  training loss:		0.373544
  validation loss:		0.205033
  validation accuracy:		94.55 %
Epoch 70 of 100 took 13.355s
  training loss:		0.368515
  validation loss:		0.199211
  validation accuracy:		94.51 %
Epoch 71 of 100 took 13.806s
  training loss:		0.363318
  validation loss:		0.197989
  validation accuracy:		94.42 %
Epoch 72 of 100 took 13.866s
  training loss:		0.352416
  validation loss:		0.194330
  validation accuracy:		94.53 %
Epoch 73 of 100 took 13.949s
  training loss:		0.354290
  validation loss:		0.190215
  validation accuracy:		94.78 %
Epoch 74 of 100 took 13.274s
  training loss:		0.342555
  validation loss:		0.185640
  validation accuracy:		94.89 %
Epoch 75 of 100 took 13.389s
  training loss:		0.347657
  validation loss:		0.185457
  validation accuracy:		94.80 %
Epoch 76 of 100 took 13.213s
  training loss:		0.333536
  validation loss:		0.179953
  validation accuracy:		94.96 %
Epoch 77 of 100 took 13.552s
  training loss:		0.334898
  validation loss:		0.176596
  validation accuracy:		95.00 %
Epoch 78 of 100 took 13.402s
  training loss:		0.328959
  validation loss:		0.174640
  validation accuracy:		95.11 %
Epoch 79 of 100 took 14.297s
  training loss:		0.322275
  validation loss:		0.171657
  validation accuracy:		95.05 %
Epoch 80 of 100 took 13.522s
  training loss:		0.312794
  validation loss:		0.168447
  validation accuracy:		95.22 %
Epoch 81 of 100 took 13.655s
  training loss:		0.315496
  validation loss:		0.167079
  validation accuracy:		95.22 %
Epoch 82 of 100 took 13.951s
  training loss:		0.316521
  validation loss:		0.165286
  validation accuracy:		95.25 %
Epoch 83 of 100 took 15.037s
  training loss:		0.317156
  validation loss:		0.164579
  validation accuracy:		95.35 %
Epoch 84 of 100 took 14.057s
  training loss:		0.311606
  validation loss:		0.161063
  validation accuracy:		95.35 %
Epoch 85 of 100 took 13.784s
  training loss:		0.306369
  validation loss:		0.161126
  validation accuracy:		95.25 %
Epoch 86 of 100 took 13.512s
  training loss:		0.301334
  validation loss:		0.156992
  validation accuracy:		95.38 %
Epoch 87 of 100 took 13.701s
  training loss:		0.296976
  validation loss:		0.154035
  validation accuracy:		95.45 %
Epoch 88 of 100 took 13.757s
  training loss:		0.293123
  validation loss:		0.154311
  validation accuracy:		95.36 %
Epoch 89 of 100 took 13.435s
  training loss:		0.289719
  validation loss:		0.153625
  validation accuracy:		95.55 %
Epoch 90 of 100 took 13.353s
  training loss:		0.289669
  validation loss:		0.152040
  validation accuracy:		95.42 %
Epoch 91 of 100 took 13.680s
  training loss:		0.288370
  validation loss:		0.148765
  validation accuracy:		95.64 %
Epoch 92 of 100 took 13.941s
  training loss:		0.286679
  validation loss:		0.148235
  validation accuracy:		95.56 %
Epoch 93 of 100 took 13.740s
  training loss:		0.290811
  validation loss:		0.147170
  validation accuracy:		95.64 %
Epoch 94 of 100 took 13.598s
  training loss:		0.278707
  validation loss:		0.144375
  validation accuracy:		95.71 %
Epoch 95 of 100 took 13.627s
  training loss:		0.274490
  validation loss:		0.140176
  validation accuracy:		95.71 %
Epoch 96 of 100 took 13.650s
  training loss:		0.274348
  validation loss:		0.140229
  validation accuracy:		95.71 %
Epoch 97 of 100 took 13.730s
  training loss:		0.277283
  validation loss:		0.139173
  validation accuracy:		95.82 %
Epoch 98 of 100 took 13.900s
  training loss:		0.278480
  validation loss:		0.140396
  validation accuracy:		95.82 %
Epoch 99 of 100 took 13.320s
  training loss:		0.271332
  validation loss:		0.139578
  validation accuracy:		95.76 %
Epoch 100 of 100 took 13.499s
  training loss:		0.275015
  validation loss:		0.136013
  validation accuracy:		95.80 %
Final results:
  test loss:			0.137923
  test accuracy:		95.82 %
