loading data...
#train = 23525, #test = 4861, #valid = 5879
building model and compiling functions...
w=(32, 1, 5, 5),b=(32,)
layers other than "dense", "conv" layers, donnot have params
w=(32, 32, 5, 5),b=(32,)
layers other than "dense", "conv" layers, donnot have params
layers other than "dense", "conv" layers, donnot have params
w=(512, 256),b=(256,)
layers other than "dense", "conv" layers, donnot have params
w=(256, 10),b=(10,)
decomposing tensor W of shape (4, 512, 800)...
decomposing tensor B of shape (4, 800)...
starting training...
Epoch 1 of 100 took 13.185s
  training loss:		2.501354
  validation loss:		2.326040
  validation accuracy:		0.00 %
Epoch 2 of 100 took 13.086s
  training loss:		2.276071
  validation loss:		2.136784
  validation accuracy:		48.73 %
Epoch 3 of 100 took 13.100s
  training loss:		1.940053
  validation loss:		1.555027
  validation accuracy:		56.20 %
Epoch 4 of 100 took 13.084s
  training loss:		1.612719
  validation loss:		1.390904
  validation accuracy:		62.00 %
Epoch 5 of 100 took 13.111s
  training loss:		1.450135
  validation loss:		1.176589
  validation accuracy:		73.55 %
Epoch 6 of 100 took 13.100s
  training loss:		1.259013
  validation loss:		0.934549
  validation accuracy:		79.89 %
Epoch 7 of 100 took 13.109s
  training loss:		1.088589
  validation loss:		0.751256
  validation accuracy:		82.09 %
Epoch 8 of 100 took 13.194s
  training loss:		0.939740
  validation loss:		0.624377
  validation accuracy:		83.93 %
Epoch 9 of 100 took 13.103s
  training loss:		0.835908
  validation loss:		0.540401
  validation accuracy:		84.95 %
Epoch 10 of 100 took 13.113s
  training loss:		0.754979
  validation loss:		0.481214
  validation accuracy:		86.11 %
Epoch 11 of 100 took 13.190s
  training loss:		0.687450
  validation loss:		0.429904
  validation accuracy:		87.49 %
Epoch 12 of 100 took 13.172s
  training loss:		0.635243
  validation loss:		0.390100
  validation accuracy:		88.05 %
Epoch 13 of 100 took 13.108s
  training loss:		0.584829
  validation loss:		0.356909
  validation accuracy:		89.36 %
Epoch 14 of 100 took 13.218s
  training loss:		0.546762
  validation loss:		0.323187
  validation accuracy:		90.40 %
Epoch 15 of 100 took 13.176s
  training loss:		0.520814
  validation loss:		0.298208
  validation accuracy:		91.20 %
Epoch 16 of 100 took 13.132s
  training loss:		0.487461
  validation loss:		0.272854
  validation accuracy:		92.05 %
Epoch 17 of 100 took 13.194s
  training loss:		0.468068
  validation loss:		0.254751
  validation accuracy:		92.49 %
Epoch 18 of 100 took 13.117s
  training loss:		0.434429
  validation loss:		0.237142
  validation accuracy:		93.04 %
Epoch 19 of 100 took 13.208s
  training loss:		0.412823
  validation loss:		0.221166
  validation accuracy:		93.58 %
Epoch 20 of 100 took 13.130s
  training loss:		0.398015
  validation loss:		0.208177
  validation accuracy:		93.84 %
Epoch 21 of 100 took 13.114s
  training loss:		0.377612
  validation loss:		0.197036
  validation accuracy:		94.11 %
Epoch 22 of 100 took 13.187s
  training loss:		0.366223
  validation loss:		0.188750
  validation accuracy:		94.29 %
Epoch 23 of 100 took 13.148s
  training loss:		0.358044
  validation loss:		0.180144
  validation accuracy:		94.45 %
Epoch 24 of 100 took 13.138s
  training loss:		0.337041
  validation loss:		0.169839
  validation accuracy:		94.91 %
Epoch 25 of 100 took 13.238s
  training loss:		0.330254
  validation loss:		0.166070
  validation accuracy:		94.95 %
Epoch 26 of 100 took 13.185s
  training loss:		0.325230
  validation loss:		0.159927
  validation accuracy:		95.25 %
Epoch 27 of 100 took 13.106s
  training loss:		0.310285
  validation loss:		0.155137
  validation accuracy:		95.27 %
Epoch 28 of 100 took 13.196s
  training loss:		0.302374
  validation loss:		0.151754
  validation accuracy:		95.40 %
Epoch 29 of 100 took 13.147s
  training loss:		0.295884
  validation loss:		0.149257
  validation accuracy:		95.38 %
Epoch 30 of 100 took 13.127s
  training loss:		0.293521
  validation loss:		0.144558
  validation accuracy:		95.47 %
Epoch 31 of 100 took 13.192s
  training loss:		0.283774
  validation loss:		0.138773
  validation accuracy:		95.60 %
Epoch 32 of 100 took 13.131s
  training loss:		0.280215
  validation loss:		0.136186
  validation accuracy:		95.73 %
Epoch 33 of 100 took 13.192s
  training loss:		0.271600
  validation loss:		0.133595
  validation accuracy:		95.80 %
Epoch 34 of 100 took 13.136s
  training loss:		0.265865
  validation loss:		0.131295
  validation accuracy:		95.80 %
Epoch 35 of 100 took 13.156s
  training loss:		0.261769
  validation loss:		0.127588
  validation accuracy:		95.96 %
Epoch 36 of 100 took 13.146s
  training loss:		0.259621
  validation loss:		0.124682
  validation accuracy:		96.00 %
Epoch 37 of 100 took 13.312s
  training loss:		0.249091
  validation loss:		0.122231
  validation accuracy:		96.09 %
Epoch 38 of 100 took 13.235s
  training loss:		0.251449
  validation loss:		0.121028
  validation accuracy:		96.16 %
Epoch 39 of 100 took 13.201s
  training loss:		0.245234
  validation loss:		0.118380
  validation accuracy:		96.18 %
Epoch 40 of 100 took 13.129s
  training loss:		0.241699
  validation loss:		0.116393
  validation accuracy:		96.16 %
Epoch 41 of 100 took 13.170s
  training loss:		0.240258
  validation loss:		0.113458
  validation accuracy:		96.33 %
Epoch 42 of 100 took 13.149s
  training loss:		0.230122
  validation loss:		0.111266
  validation accuracy:		96.42 %
Epoch 43 of 100 took 13.138s
  training loss:		0.229218
  validation loss:		0.109325
  validation accuracy:		96.55 %
Epoch 44 of 100 took 13.160s
  training loss:		0.227549
  validation loss:		0.108784
  validation accuracy:		96.55 %
Epoch 45 of 100 took 13.205s
  training loss:		0.223492
  validation loss:		0.107761
  validation accuracy:		96.56 %
Epoch 46 of 100 took 13.274s
  training loss:		0.216673
  validation loss:		0.105424
  validation accuracy:		96.73 %
Epoch 47 of 100 took 13.185s
  training loss:		0.217267
  validation loss:		0.103784
  validation accuracy:		96.65 %
Epoch 48 of 100 took 13.136s
  training loss:		0.215200
  validation loss:		0.103098
  validation accuracy:		96.73 %
Epoch 49 of 100 took 13.326s
  training loss:		0.214367
  validation loss:		0.101614
  validation accuracy:		96.84 %
Epoch 50 of 100 took 13.140s
  training loss:		0.214963
  validation loss:		0.099376
  validation accuracy:		97.00 %
Epoch 51 of 100 took 13.141s
  training loss:		0.204755
  validation loss:		0.098315
  validation accuracy:		96.95 %
Epoch 52 of 100 took 13.216s
  training loss:		0.201958
  validation loss:		0.096960
  validation accuracy:		97.00 %
Epoch 53 of 100 took 13.127s
  training loss:		0.203478
  validation loss:		0.096832
  validation accuracy:		97.02 %
Epoch 54 of 100 took 13.184s
  training loss:		0.198673
  validation loss:		0.094171
  validation accuracy:		97.11 %
Epoch 55 of 100 took 13.149s
  training loss:		0.197160
  validation loss:		0.093853
  validation accuracy:		97.07 %
Epoch 56 of 100 took 13.150s
  training loss:		0.197847
  validation loss:		0.093765
  validation accuracy:		97.02 %
Epoch 57 of 100 took 13.138s
  training loss:		0.187477
  validation loss:		0.091578
  validation accuracy:		97.13 %
Epoch 58 of 100 took 13.217s
  training loss:		0.191705
  validation loss:		0.091078
  validation accuracy:		97.11 %
Epoch 59 of 100 took 13.214s
  training loss:		0.187356
  validation loss:		0.089553
  validation accuracy:		97.20 %
Epoch 60 of 100 took 13.316s
  training loss:		0.188500
  validation loss:		0.088259
  validation accuracy:		97.24 %
Epoch 61 of 100 took 13.110s
  training loss:		0.191680
  validation loss:		0.088612
  validation accuracy:		97.18 %
Epoch 62 of 100 took 13.205s
  training loss:		0.186715
  validation loss:		0.087048
  validation accuracy:		97.22 %
Epoch 63 of 100 took 13.152s
  training loss:		0.185132
  validation loss:		0.086102
  validation accuracy:		97.20 %
Epoch 64 of 100 took 13.281s
  training loss:		0.183393
  validation loss:		0.086169
  validation accuracy:		97.16 %
Epoch 65 of 100 took 13.157s
  training loss:		0.180478
  validation loss:		0.083542
  validation accuracy:		97.29 %
Epoch 66 of 100 took 13.300s
  training loss:		0.178983
  validation loss:		0.083111
  validation accuracy:		97.31 %
Epoch 67 of 100 took 13.261s
  training loss:		0.179670
  validation loss:		0.082534
  validation accuracy:		97.33 %
Epoch 68 of 100 took 13.168s
  training loss:		0.176992
  validation loss:		0.081734
  validation accuracy:		97.31 %
Epoch 69 of 100 took 13.149s
  training loss:		0.179931
  validation loss:		0.082518
  validation accuracy:		97.35 %
Epoch 70 of 100 took 13.175s
  training loss:		0.173006
  validation loss:		0.079606
  validation accuracy:		97.44 %
Epoch 71 of 100 took 13.256s
  training loss:		0.166202
  validation loss:		0.079955
  validation accuracy:		97.40 %
Epoch 72 of 100 took 13.173s
  training loss:		0.170997
  validation loss:		0.078069
  validation accuracy:		97.42 %
Epoch 73 of 100 took 13.171s
  training loss:		0.168123
  validation loss:		0.077542
  validation accuracy:		97.45 %
Epoch 74 of 100 took 13.272s
  training loss:		0.168235
  validation loss:		0.077878
  validation accuracy:		97.49 %
Epoch 75 of 100 took 13.137s
  training loss:		0.169421
  validation loss:		0.077328
  validation accuracy:		97.51 %
Epoch 76 of 100 took 13.238s
  training loss:		0.164968
  validation loss:		0.076072
  validation accuracy:		97.49 %
Epoch 77 of 100 took 13.184s
  training loss:		0.166821
  validation loss:		0.075308
  validation accuracy:		97.53 %
Epoch 78 of 100 took 13.143s
  training loss:		0.163355
  validation loss:		0.074682
  validation accuracy:		97.56 %
Epoch 79 of 100 took 13.167s
  training loss:		0.161052
  validation loss:		0.074846
  validation accuracy:		97.55 %
Epoch 80 of 100 took 13.149s
  training loss:		0.165102
  validation loss:		0.073097
  validation accuracy:		97.75 %
Epoch 81 of 100 took 13.134s
  training loss:		0.161524
  validation loss:		0.073979
  validation accuracy:		97.62 %
Epoch 82 of 100 took 13.300s
  training loss:		0.158261
  validation loss:		0.072735
  validation accuracy:		97.67 %
Epoch 83 of 100 took 13.130s
  training loss:		0.156113
  validation loss:		0.071781
  validation accuracy:		97.67 %
Epoch 84 of 100 took 13.142s
  training loss:		0.155809
  validation loss:		0.072027
  validation accuracy:		97.60 %
Epoch 85 of 100 took 13.129s
  training loss:		0.159729
  validation loss:		0.072090
  validation accuracy:		97.67 %
Epoch 86 of 100 took 13.318s
  training loss:		0.157387
  validation loss:		0.071116
  validation accuracy:		97.69 %
Epoch 87 of 100 took 13.129s
  training loss:		0.155212
  validation loss:		0.070336
  validation accuracy:		97.71 %
Epoch 88 of 100 took 13.183s
  training loss:		0.151983
  validation loss:		0.069754
  validation accuracy:		97.75 %
Epoch 89 of 100 took 13.136s
  training loss:		0.151903
  validation loss:		0.069593
  validation accuracy:		97.76 %
Epoch 90 of 100 took 13.120s
  training loss:		0.150725
  validation loss:		0.069832
  validation accuracy:		97.76 %
Epoch 91 of 100 took 13.214s
  training loss:		0.151418
  validation loss:		0.068722
  validation accuracy:		97.80 %
Epoch 92 of 100 took 13.147s
  training loss:		0.149840
  validation loss:		0.067475
  validation accuracy:		97.80 %
Epoch 93 of 100 took 13.443s
  training loss:		0.148672
  validation loss:		0.068143
  validation accuracy:		97.80 %
Epoch 94 of 100 took 13.139s
  training loss:		0.146745
  validation loss:		0.067289
  validation accuracy:		97.75 %
Epoch 95 of 100 took 13.137s
  training loss:		0.147928
  validation loss:		0.066134
  validation accuracy:		97.84 %
Epoch 96 of 100 took 13.177s
  training loss:		0.144036
  validation loss:		0.066213
  validation accuracy:		97.78 %
Epoch 97 of 100 took 13.143s
  training loss:		0.140400
  validation loss:		0.065264
  validation accuracy:		97.89 %
Epoch 98 of 100 took 13.142s
  training loss:		0.147971
  validation loss:		0.065678
  validation accuracy:		97.82 %
Epoch 99 of 100 took 13.230s
  training loss:		0.147966
  validation loss:		0.065107
  validation accuracy:		97.89 %
Epoch 100 of 100 took 13.199s
  training loss:		0.143982
  validation loss:		0.064059
  validation accuracy:		97.91 %
Final results:
  test loss:			0.062218
  test accuracy:		97.96 %
