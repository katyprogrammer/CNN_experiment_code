loading data...
#train = 23525, #test = 4861, #valid = 5879
building model and compiling functions...
w=(32, 1, 5, 5),b=(32,)
layers other than "dense", "conv" layers, donnot have params
w=(32, 32, 5, 5),b=(32,)
layers other than "dense", "conv" layers, donnot have params
layers other than "dense", "conv" layers, donnot have params
w=(512, 256),b=(256,)
layers other than "dense", "conv" layers, donnot have params
w=(256, 10),b=(10,)
decomposing tensor W of shape (4, 512, 800)...
decomposing tensor B of shape (4, 800)...
starting training...
Epoch 1 of 100 took 13.291s
  training loss:		2.364169
  validation loss:		2.338084
  validation accuracy:		0.00 %
Epoch 2 of 100 took 13.513s
  training loss:		2.312214
  validation loss:		2.286548
  validation accuracy:		0.00 %
Epoch 3 of 100 took 13.278s
  training loss:		2.262133
  validation loss:		2.237097
  validation accuracy:		21.27 %
Epoch 4 of 100 took 13.623s
  training loss:		2.209852
  validation loss:		2.179745
  validation accuracy:		21.27 %
Epoch 5 of 100 took 13.706s
  training loss:		2.129430
  validation loss:		2.061218
  validation accuracy:		22.78 %
Epoch 6 of 100 took 13.752s
  training loss:		1.905416
  validation loss:		1.723005
  validation accuracy:		22.78 %
Epoch 7 of 100 took 13.403s
  training loss:		1.661166
  validation loss:		1.620134
  validation accuracy:		22.78 %
Epoch 8 of 100 took 13.528s
  training loss:		1.622558
  validation loss:		1.608798
  validation accuracy:		22.78 %
Epoch 9 of 100 took 13.267s
  training loss:		1.615004
  validation loss:		1.606315
  validation accuracy:		22.78 %
Epoch 10 of 100 took 14.014s
  training loss:		1.611070
  validation loss:		1.598869
  validation accuracy:		25.42 %
Epoch 11 of 100 took 13.420s
  training loss:		1.608545
  validation loss:		1.600220
  validation accuracy:		26.42 %
Epoch 12 of 100 took 14.350s
  training loss:		1.606084
  validation loss:		1.595452
  validation accuracy:		22.87 %
Epoch 13 of 100 took 13.932s
  training loss:		1.604285
  validation loss:		1.592116
  validation accuracy:		34.67 %
Epoch 14 of 100 took 13.460s
  training loss:		1.600593
  validation loss:		1.593757
  validation accuracy:		40.31 %
Epoch 15 of 100 took 13.347s
  training loss:		1.600240
  validation loss:		1.585202
  validation accuracy:		40.51 %
Epoch 16 of 100 took 13.272s
  training loss:		1.598323
  validation loss:		1.582320
  validation accuracy:		34.67 %
Epoch 17 of 100 took 14.095s
  training loss:		1.597390
  validation loss:		1.576352
  validation accuracy:		53.15 %
Epoch 18 of 100 took 14.407s
  training loss:		1.590699
  validation loss:		1.575645
  validation accuracy:		42.05 %
Epoch 19 of 100 took 13.678s
  training loss:		1.588593
  validation loss:		1.563305
  validation accuracy:		34.38 %
Epoch 20 of 100 took 13.415s
  training loss:		1.586732
  validation loss:		1.561008
  validation accuracy:		27.00 %
Epoch 21 of 100 took 13.186s
  training loss:		1.582733
  validation loss:		1.546384
  validation accuracy:		49.60 %
Epoch 22 of 100 took 13.071s
  training loss:		1.575241
  validation loss:		1.539811
  validation accuracy:		59.09 %
Epoch 23 of 100 took 14.202s
  training loss:		1.573642
  validation loss:		1.524795
  validation accuracy:		69.82 %
Epoch 24 of 100 took 14.790s
  training loss:		1.560342
  validation loss:		1.510265
  validation accuracy:		53.45 %
Epoch 25 of 100 took 13.437s
  training loss:		1.548833
  validation loss:		1.485303
  validation accuracy:		52.13 %
Epoch 26 of 100 took 14.738s
  training loss:		1.539604
  validation loss:		1.459996
  validation accuracy:		63.20 %
Epoch 27 of 100 took 15.333s
  training loss:		1.522935
  validation loss:		1.423977
  validation accuracy:		56.71 %
Epoch 28 of 100 took 13.597s
  training loss:		1.505254
  validation loss:		1.388079
  validation accuracy:		60.11 %
Epoch 29 of 100 took 13.256s
  training loss:		1.483931
  validation loss:		1.348405
  validation accuracy:		69.25 %
Epoch 30 of 100 took 13.671s
  training loss:		1.449085
  validation loss:		1.286283
  validation accuracy:		67.04 %
Epoch 31 of 100 took 14.144s
  training loss:		1.416656
  validation loss:		1.231410
  validation accuracy:		69.38 %
Epoch 32 of 100 took 15.183s
  training loss:		1.380191
  validation loss:		1.169612
  validation accuracy:		69.33 %
Epoch 33 of 100 took 14.501s
  training loss:		1.336661
  validation loss:		1.109073
  validation accuracy:		73.29 %
Epoch 34 of 100 took 14.141s
  training loss:		1.301340
  validation loss:		1.053425
  validation accuracy:		76.36 %
Epoch 35 of 100 took 13.589s
  training loss:		1.256310
  validation loss:		0.992174
  validation accuracy:		76.82 %
Epoch 36 of 100 took 14.157s
  training loss:		1.208137
  validation loss:		0.938311
  validation accuracy:		77.29 %
Epoch 37 of 100 took 14.281s
  training loss:		1.156155
  validation loss:		0.880554
  validation accuracy:		78.85 %
Epoch 38 of 100 took 14.876s
  training loss:		1.104691
  validation loss:		0.826652
  validation accuracy:		79.55 %
Epoch 39 of 100 took 13.705s
  training loss:		1.041767
  validation loss:		0.771034
  validation accuracy:		79.44 %
Epoch 40 of 100 took 13.922s
  training loss:		0.990570
  validation loss:		0.726963
  validation accuracy:		80.13 %
Epoch 41 of 100 took 14.050s
  training loss:		0.938556
  validation loss:		0.686622
  validation accuracy:		81.09 %
Epoch 42 of 100 took 14.123s
  training loss:		0.896133
  validation loss:		0.655063
  validation accuracy:		81.75 %
Epoch 43 of 100 took 13.755s
  training loss:		0.848107
  validation loss:		0.617719
  validation accuracy:		82.58 %
Epoch 44 of 100 took 13.894s
  training loss:		0.812139
  validation loss:		0.586872
  validation accuracy:		83.02 %
Epoch 45 of 100 took 13.895s
  training loss:		0.770481
  validation loss:		0.557074
  validation accuracy:		83.65 %
Epoch 46 of 100 took 13.679s
  training loss:		0.735895
  validation loss:		0.526861
  validation accuracy:		84.36 %
Epoch 47 of 100 took 13.721s
  training loss:		0.705477
  validation loss:		0.502584
  validation accuracy:		85.16 %
Epoch 48 of 100 took 13.732s
  training loss:		0.679495
  validation loss:		0.475633
  validation accuracy:		85.93 %
Epoch 49 of 100 took 13.913s
  training loss:		0.651415
  validation loss:		0.449799
  validation accuracy:		87.00 %
Epoch 50 of 100 took 13.931s
  training loss:		0.630665
  validation loss:		0.430133
  validation accuracy:		87.82 %
Epoch 51 of 100 took 13.587s
  training loss:		0.608319
  validation loss:		0.408777
  validation accuracy:		88.80 %
Epoch 52 of 100 took 14.594s
  training loss:		0.590820
  validation loss:		0.392118
  validation accuracy:		89.47 %
Epoch 53 of 100 took 14.856s
  training loss:		0.571492
  validation loss:		0.374416
  validation accuracy:		89.82 %
Epoch 54 of 100 took 14.469s
  training loss:		0.548802
  validation loss:		0.356828
  validation accuracy:		90.73 %
Epoch 55 of 100 took 14.124s
  training loss:		0.525816
  validation loss:		0.339277
  validation accuracy:		91.13 %
Epoch 56 of 100 took 14.474s
  training loss:		0.520109
  validation loss:		0.327207
  validation accuracy:		91.49 %
Epoch 57 of 100 took 13.335s
  training loss:		0.502712
  validation loss:		0.311744
  validation accuracy:		91.75 %
Epoch 58 of 100 took 13.660s
  training loss:		0.490697
  validation loss:		0.300687
  validation accuracy:		92.02 %
Epoch 59 of 100 took 15.398s
  training loss:		0.479616
  validation loss:		0.287284
  validation accuracy:		92.35 %
Epoch 60 of 100 took 14.459s
  training loss:		0.464112
  validation loss:		0.278087
  validation accuracy:		92.55 %
Epoch 61 of 100 took 14.046s
  training loss:		0.453665
  validation loss:		0.267931
  validation accuracy:		92.76 %
Epoch 62 of 100 took 14.567s
  training loss:		0.443241
  validation loss:		0.258131
  validation accuracy:		93.00 %
Epoch 63 of 100 took 14.047s
  training loss:		0.433077
  validation loss:		0.251038
  validation accuracy:		93.15 %
Epoch 64 of 100 took 13.909s
  training loss:		0.427332
  validation loss:		0.246719
  validation accuracy:		93.31 %
Epoch 65 of 100 took 13.771s
  training loss:		0.416744
  validation loss:		0.237016
  validation accuracy:		93.47 %
Epoch 66 of 100 took 14.590s
  training loss:		0.406250
  validation loss:		0.230843
  validation accuracy:		93.56 %
Epoch 67 of 100 took 15.806s
  training loss:		0.403856
  validation loss:		0.225907
  validation accuracy:		93.53 %
Epoch 68 of 100 took 15.510s
  training loss:		0.393812
  validation loss:		0.219402
  validation accuracy:		93.82 %
Epoch 69 of 100 took 13.488s
  training loss:		0.386270
  validation loss:		0.216584
  validation accuracy:		93.84 %
Epoch 70 of 100 took 13.482s
  training loss:		0.378770
  validation loss:		0.211848
  validation accuracy:		93.93 %
Epoch 71 of 100 took 13.053s
  training loss:		0.375396
  validation loss:		0.207563
  validation accuracy:		94.13 %
Epoch 72 of 100 took 13.484s
  training loss:		0.373535
  validation loss:		0.203915
  validation accuracy:		94.02 %
Epoch 73 of 100 took 13.533s
  training loss:		0.365773
  validation loss:		0.196972
  validation accuracy:		94.42 %
Epoch 74 of 100 took 13.317s
  training loss:		0.365996
  validation loss:		0.195455
  validation accuracy:		94.27 %
Epoch 75 of 100 took 15.812s
  training loss:		0.357347
  validation loss:		0.192385
  validation accuracy:		94.36 %
Epoch 76 of 100 took 14.131s
  training loss:		0.353635
  validation loss:		0.188853
  validation accuracy:		94.51 %
Epoch 77 of 100 took 14.420s
  training loss:		0.352944
  validation loss:		0.187698
  validation accuracy:		94.53 %
Epoch 78 of 100 took 13.889s
  training loss:		0.347372
  validation loss:		0.184010
  validation accuracy:		94.51 %
Epoch 79 of 100 took 13.433s
  training loss:		0.342404
  validation loss:		0.181278
  validation accuracy:		94.58 %
Epoch 80 of 100 took 13.196s
  training loss:		0.333345
  validation loss:		0.178287
  validation accuracy:		94.53 %
Epoch 81 of 100 took 13.366s
  training loss:		0.332546
  validation loss:		0.176315
  validation accuracy:		94.82 %
Epoch 82 of 100 took 13.330s
  training loss:		0.318791
  validation loss:		0.173307
  validation accuracy:		94.73 %
Epoch 83 of 100 took 13.551s
  training loss:		0.328898
  validation loss:		0.171599
  validation accuracy:		94.93 %
Epoch 84 of 100 took 14.017s
  training loss:		0.321904
  validation loss:		0.170016
  validation accuracy:		94.75 %
Epoch 85 of 100 took 13.914s
  training loss:		0.316117
  validation loss:		0.165888
  validation accuracy:		95.05 %
Epoch 86 of 100 took 14.072s
  training loss:		0.310334
  validation loss:		0.165361
  validation accuracy:		95.05 %
Epoch 87 of 100 took 13.699s
  training loss:		0.314083
  validation loss:		0.162542
  validation accuracy:		95.18 %
Epoch 88 of 100 took 14.494s
  training loss:		0.302079
  validation loss:		0.161197
  validation accuracy:		95.15 %
Epoch 89 of 100 took 14.135s
  training loss:		0.310190
  validation loss:		0.159078
  validation accuracy:		95.31 %
Epoch 90 of 100 took 14.147s
  training loss:		0.300426
  validation loss:		0.156525
  validation accuracy:		95.25 %
Epoch 91 of 100 took 13.308s
  training loss:		0.300365
  validation loss:		0.154681
  validation accuracy:		95.35 %
Epoch 92 of 100 took 13.569s
  training loss:		0.292142
  validation loss:		0.152900
  validation accuracy:		95.31 %
Epoch 93 of 100 took 13.289s
  training loss:		0.290247
  validation loss:		0.150351
  validation accuracy:		95.38 %
Epoch 94 of 100 took 13.211s
  training loss:		0.294175
  validation loss:		0.150934
  validation accuracy:		95.49 %
Epoch 95 of 100 took 13.944s
  training loss:		0.285778
  validation loss:		0.148828
  validation accuracy:		95.56 %
Epoch 96 of 100 took 14.078s
  training loss:		0.287164
  validation loss:		0.147526
  validation accuracy:		95.51 %
Epoch 97 of 100 took 14.012s
  training loss:		0.286369
  validation loss:		0.148114
  validation accuracy:		95.55 %
Epoch 98 of 100 took 13.540s
  training loss:		0.282093
  validation loss:		0.145357
  validation accuracy:		95.60 %
Epoch 99 of 100 took 14.534s
  training loss:		0.281264
  validation loss:		0.145362
  validation accuracy:		95.58 %
Epoch 100 of 100 took 14.516s
  training loss:		0.276309
  validation loss:		0.142611
  validation accuracy:		95.62 %
Final results:
  test loss:			0.145654
  test accuracy:		95.36 %
