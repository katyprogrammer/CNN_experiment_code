loading data...
#train = 24479, #test = 5139, #valid = 6117
building model and compiling functions...
w=(32, 1, 5, 5),b=(32,)
layers other than "dense", "conv" layers, donnot have params
w=(32, 32, 5, 5),b=(32,)
layers other than "dense", "conv" layers, donnot have params
layers other than "dense", "conv" layers, donnot have params
w=(512, 256),b=(256,)
layers other than "dense", "conv" layers, donnot have params
w=(256, 10),b=(10,)
decomposing tensor W of shape (4, 512, 800)...
decomposing tensor B of shape (4, 800)...
starting training...
Epoch 1 of 100 took 13.825s
  training loss:		2.287034
  validation loss:		2.264869
  validation accuracy:		22.47 %
Epoch 2 of 100 took 14.451s
  training loss:		2.243622
  validation loss:		2.221876
  validation accuracy:		22.47 %
Epoch 3 of 100 took 13.782s
  training loss:		2.202633
  validation loss:		2.182782
  validation accuracy:		22.47 %
Epoch 4 of 100 took 14.629s
  training loss:		2.165385
  validation loss:		2.147255
  validation accuracy:		22.47 %
Epoch 5 of 100 took 13.714s
  training loss:		2.131549
  validation loss:		2.114922
  validation accuracy:		22.47 %
Epoch 6 of 100 took 13.596s
  training loss:		2.100678
  validation loss:		2.085450
  validation accuracy:		22.47 %
Epoch 7 of 100 took 13.494s
  training loss:		2.072568
  validation loss:		2.058558
  validation accuracy:		22.47 %
Epoch 8 of 100 took 13.631s
  training loss:		2.046958
  validation loss:		2.034009
  validation accuracy:		22.47 %
Epoch 9 of 100 took 13.468s
  training loss:		2.023427
  validation loss:		2.011495
  validation accuracy:		22.47 %
Epoch 10 of 100 took 13.627s
  training loss:		2.001881
  validation loss:		1.990859
  validation accuracy:		22.47 %
Epoch 11 of 100 took 13.598s
  training loss:		1.982107
  validation loss:		1.971890
  validation accuracy:		22.47 %
Epoch 12 of 100 took 13.537s
  training loss:		1.963967
  validation loss:		1.954440
  validation accuracy:		22.47 %
Epoch 13 of 100 took 13.545s
  training loss:		1.947235
  validation loss:		1.938329
  validation accuracy:		22.47 %
Epoch 14 of 100 took 13.951s
  training loss:		1.931718
  validation loss:		1.923452
  validation accuracy:		22.47 %
Epoch 15 of 100 took 14.197s
  training loss:		1.917463
  validation loss:		1.909649
  validation accuracy:		22.47 %
Epoch 16 of 100 took 14.179s
  training loss:		1.904216
  validation loss:		1.896852
  validation accuracy:		22.47 %
Epoch 17 of 100 took 14.194s
  training loss:		1.891817
  validation loss:		1.884945
  validation accuracy:		22.47 %
Epoch 18 of 100 took 14.253s
  training loss:		1.880437
  validation loss:		1.873853
  validation accuracy:		22.47 %
Epoch 19 of 100 took 14.601s
  training loss:		1.869715
  validation loss:		1.863507
  validation accuracy:		22.47 %
Epoch 20 of 100 took 14.338s
  training loss:		1.859730
  validation loss:		1.853828
  validation accuracy:		22.47 %
Epoch 21 of 100 took 14.250s
  training loss:		1.850329
  validation loss:		1.844753
  validation accuracy:		22.47 %
Epoch 22 of 100 took 14.122s
  training loss:		1.841559
  validation loss:		1.836237
  validation accuracy:		22.47 %
Epoch 23 of 100 took 14.368s
  training loss:		1.833334
  validation loss:		1.828232
  validation accuracy:		22.47 %
Epoch 24 of 100 took 14.448s
  training loss:		1.825531
  validation loss:		1.820661
  validation accuracy:		22.47 %
Epoch 25 of 100 took 14.042s
  training loss:		1.818159
  validation loss:		1.813501
  validation accuracy:		22.47 %
Epoch 26 of 100 took 14.207s
  training loss:		1.811228
  validation loss:		1.806706
  validation accuracy:		22.47 %
Epoch 27 of 100 took 14.305s
  training loss:		1.804634
  validation loss:		1.800239
  validation accuracy:		22.47 %
Epoch 28 of 100 took 14.654s
  training loss:		1.798232
  validation loss:		1.794043
  validation accuracy:		22.47 %
Epoch 29 of 100 took 14.174s
  training loss:		1.792255
  validation loss:		1.788072
  validation accuracy:		22.47 %
Epoch 30 of 100 took 15.102s
  training loss:		1.786183
  validation loss:		1.782273
  validation accuracy:		22.47 %
Epoch 31 of 100 took 13.885s
  training loss:		1.780566
  validation loss:		1.776568
  validation accuracy:		22.47 %
Epoch 32 of 100 took 14.252s
  training loss:		1.774964
  validation loss:		1.770862
  validation accuracy:		22.47 %
Epoch 33 of 100 took 14.324s
  training loss:		1.769193
  validation loss:		1.765017
  validation accuracy:		22.47 %
Epoch 34 of 100 took 14.401s
  training loss:		1.763093
  validation loss:		1.758745
  validation accuracy:		22.47 %
Epoch 35 of 100 took 14.503s
  training loss:		1.756578
  validation loss:		1.751721
  validation accuracy:		22.47 %
Epoch 36 of 100 took 14.347s
  training loss:		1.748944
  validation loss:		1.743034
  validation accuracy:		22.47 %
Epoch 37 of 100 took 14.586s
  training loss:		1.738798
  validation loss:		1.731063
  validation accuracy:		22.47 %
Epoch 38 of 100 took 15.620s
  training loss:		1.724642
  validation loss:		1.713634
  validation accuracy:		22.47 %
Epoch 39 of 100 took 15.091s
  training loss:		1.703760
  validation loss:		1.688450
  validation accuracy:		22.47 %
Epoch 40 of 100 took 15.163s
  training loss:		1.676214
  validation loss:		1.658649
  validation accuracy:		33.33 %
Epoch 41 of 100 took 14.931s
  training loss:		1.649376
  validation loss:		1.634745
  validation accuracy:		25.02 %
Epoch 42 of 100 took 13.655s
  training loss:		1.630478
  validation loss:		1.620447
  validation accuracy:		24.68 %
Epoch 43 of 100 took 14.700s
  training loss:		1.620305
  validation loss:		1.612769
  validation accuracy:		22.80 %
Epoch 44 of 100 took 14.177s
  training loss:		1.614434
  validation loss:		1.608950
  validation accuracy:		20.90 %
Epoch 45 of 100 took 14.590s
  training loss:		1.610819
  validation loss:		1.606159
  validation accuracy:		23.80 %
Epoch 46 of 100 took 14.497s
  training loss:		1.608471
  validation loss:		1.603276
  validation accuracy:		38.33 %
Epoch 47 of 100 took 14.608s
  training loss:		1.606409
  validation loss:		1.601850
  validation accuracy:		19.73 %
Epoch 48 of 100 took 14.292s
  training loss:		1.604186
  validation loss:		1.601479
  validation accuracy:		19.73 %
Epoch 49 of 100 took 13.611s
  training loss:		1.603774
  validation loss:		1.598500
  validation accuracy:		31.17 %
Epoch 50 of 100 took 14.290s
  training loss:		1.602904
  validation loss:		1.598371
  validation accuracy:		20.08 %
Epoch 51 of 100 took 14.243s
  training loss:		1.601128
  validation loss:		1.596423
  validation accuracy:		35.95 %
Epoch 52 of 100 took 14.258s
  training loss:		1.599438
  validation loss:		1.594349
  validation accuracy:		37.57 %
Epoch 53 of 100 took 14.112s
  training loss:		1.597050
  validation loss:		1.593842
  validation accuracy:		26.07 %
Epoch 54 of 100 took 14.523s
  training loss:		1.596520
  validation loss:		1.591753
  validation accuracy:		28.20 %
Epoch 55 of 100 took 14.182s
  training loss:		1.592567
  validation loss:		1.587846
  validation accuracy:		28.18 %
Epoch 56 of 100 took 14.136s
  training loss:		1.590930
  validation loss:		1.583851
  validation accuracy:		42.87 %
Epoch 57 of 100 took 15.621s
  training loss:		1.588142
  validation loss:		1.580789
  validation accuracy:		40.58 %
Epoch 58 of 100 took 14.541s
  training loss:		1.584771
  validation loss:		1.574626
  validation accuracy:		42.75 %
Epoch 59 of 100 took 14.190s
  training loss:		1.579039
  validation loss:		1.569742
  validation accuracy:		29.97 %
Epoch 60 of 100 took 14.173s
  training loss:		1.574421
  validation loss:		1.560961
  validation accuracy:		45.23 %
Epoch 61 of 100 took 14.102s
  training loss:		1.566340
  validation loss:		1.550494
  validation accuracy:		42.93 %
Epoch 62 of 100 took 14.668s
  training loss:		1.558013
  validation loss:		1.535457
  validation accuracy:		47.62 %
Epoch 63 of 100 took 14.372s
  training loss:		1.543795
  validation loss:		1.514904
  validation accuracy:		52.28 %
Epoch 64 of 100 took 15.306s
  training loss:		1.525066
  validation loss:		1.486489
  validation accuracy:		49.15 %
Epoch 65 of 100 took 15.151s
  training loss:		1.494810
  validation loss:		1.436856
  validation accuracy:		67.27 %
Epoch 66 of 100 took 14.630s
  training loss:		1.449414
  validation loss:		1.359873
  validation accuracy:		69.00 %
Epoch 67 of 100 took 15.279s
  training loss:		1.372783
  validation loss:		1.234652
  validation accuracy:		80.27 %
Epoch 68 of 100 took 14.475s
  training loss:		1.276565
  validation loss:		1.074640
  validation accuracy:		82.80 %
Epoch 69 of 100 took 14.839s
  training loss:		1.155341
  validation loss:		0.890679
  validation accuracy:		86.35 %
Epoch 70 of 100 took 14.575s
  training loss:		1.027960
  validation loss:		0.721954
  validation accuracy:		87.75 %
Epoch 71 of 100 took 13.835s
  training loss:		0.921893
  validation loss:		0.593293
  validation accuracy:		88.17 %
Epoch 72 of 100 took 14.695s
  training loss:		0.820377
  validation loss:		0.496743
  validation accuracy:		89.62 %
Epoch 73 of 100 took 14.729s
  training loss:		0.731468
  validation loss:		0.427136
  validation accuracy:		90.23 %
Epoch 74 of 100 took 14.658s
  training loss:		0.664292
  validation loss:		0.372645
  validation accuracy:		91.07 %
Epoch 75 of 100 took 13.495s
  training loss:		0.599957
  validation loss:		0.335319
  validation accuracy:		91.55 %
Epoch 76 of 100 took 13.656s
  training loss:		0.549366
  validation loss:		0.303224
  validation accuracy:		92.25 %
Epoch 77 of 100 took 13.803s
  training loss:		0.503250
  validation loss:		0.281257
  validation accuracy:		92.38 %
Epoch 78 of 100 took 14.890s
  training loss:		0.465919
  validation loss:		0.259936
  validation accuracy:		93.13 %
Epoch 79 of 100 took 15.230s
  training loss:		0.429759
  validation loss:		0.242611
  validation accuracy:		93.42 %
Epoch 80 of 100 took 14.573s
  training loss:		0.410427
  validation loss:		0.230040
  validation accuracy:		93.67 %
Epoch 81 of 100 took 14.417s
  training loss:		0.382240
  validation loss:		0.218683
  validation accuracy:		94.03 %
Epoch 82 of 100 took 14.132s
  training loss:		0.363497
  validation loss:		0.208302
  validation accuracy:		94.13 %
Epoch 83 of 100 took 14.880s
  training loss:		0.348668
  validation loss:		0.201875
  validation accuracy:		94.33 %
Epoch 84 of 100 took 13.596s
  training loss:		0.338637
  validation loss:		0.193022
  validation accuracy:		94.58 %
Epoch 85 of 100 took 14.164s
  training loss:		0.320609
  validation loss:		0.185891
  validation accuracy:		94.75 %
Epoch 86 of 100 took 14.281s
  training loss:		0.307896
  validation loss:		0.181203
  validation accuracy:		94.83 %
Epoch 87 of 100 took 14.246s
  training loss:		0.295931
  validation loss:		0.175815
  validation accuracy:		94.95 %
Epoch 88 of 100 took 14.504s
  training loss:		0.286688
  validation loss:		0.171264
  validation accuracy:		95.00 %
Epoch 89 of 100 took 14.359s
  training loss:		0.279399
  validation loss:		0.167898
  validation accuracy:		95.20 %
Epoch 90 of 100 took 14.152s
  training loss:		0.274091
  validation loss:		0.162187
  validation accuracy:		95.27 %
Epoch 91 of 100 took 14.240s
  training loss:		0.264491
  validation loss:		0.158091
  validation accuracy:		95.40 %
Epoch 92 of 100 took 14.410s
  training loss:		0.252908
  validation loss:		0.154853
  validation accuracy:		95.57 %
Epoch 93 of 100 took 14.323s
  training loss:		0.252301
  validation loss:		0.152414
  validation accuracy:		95.62 %
Epoch 94 of 100 took 14.907s
  training loss:		0.244122
  validation loss:		0.149264
  validation accuracy:		95.75 %
Epoch 95 of 100 took 15.021s
  training loss:		0.234463
  validation loss:		0.145135
  validation accuracy:		95.72 %
Epoch 96 of 100 took 14.234s
  training loss:		0.235702
  validation loss:		0.141457
  validation accuracy:		95.87 %
Epoch 97 of 100 took 14.915s
  training loss:		0.224887
  validation loss:		0.138939
  validation accuracy:		96.05 %
Epoch 98 of 100 took 15.072s
  training loss:		0.218476
  validation loss:		0.136104
  validation accuracy:		96.00 %
Epoch 99 of 100 took 14.532s
  training loss:		0.215355
  validation loss:		0.135545
  validation accuracy:		96.02 %
Epoch 100 of 100 took 15.095s
  training loss:		0.215658
  validation loss:		0.132341
  validation accuracy:		96.12 %
Final results:
  test loss:			0.101230
  test accuracy:		97.24 %
