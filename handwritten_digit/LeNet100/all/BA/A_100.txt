loading data...
#train = 24479, #test = 5139, #valid = 6117
building model and compiling functions...
w=(32, 1, 5, 5),b=(32,)
layers other than "dense", "conv" layers, donnot have params
w=(32, 32, 5, 5),b=(32,)
layers other than "dense", "conv" layers, donnot have params
layers other than "dense", "conv" layers, donnot have params
w=(512, 256),b=(256,)
layers other than "dense", "conv" layers, donnot have params
w=(256, 10),b=(10,)
decomposing tensor W of shape (4, 512, 800)...
decomposing tensor B of shape (4, 800)...
starting training...
Epoch 1 of 100 took 13.465s
  training loss:		2.379866
  validation loss:		2.290159
  validation accuracy:		0.27 %
Epoch 2 of 100 took 13.446s
  training loss:		2.246765
  validation loss:		2.126467
  validation accuracy:		63.93 %
Epoch 3 of 100 took 13.447s
  training loss:		1.980249
  validation loss:		1.481296
  validation accuracy:		54.20 %
Epoch 4 of 100 took 13.456s
  training loss:		1.378390
  validation loss:		0.849977
  validation accuracy:		90.77 %
Epoch 5 of 100 took 13.479s
  training loss:		0.934072
  validation loss:		0.473050
  validation accuracy:		91.75 %
Epoch 6 of 100 took 13.474s
  training loss:		0.680339
  validation loss:		0.315122
  validation accuracy:		92.67 %
Epoch 7 of 100 took 13.464s
  training loss:		0.548876
  validation loss:		0.253063
  validation accuracy:		93.38 %
Epoch 8 of 100 took 13.468s
  training loss:		0.471162
  validation loss:		0.216612
  validation accuracy:		93.98 %
Epoch 9 of 100 took 13.576s
  training loss:		0.419985
  validation loss:		0.194928
  validation accuracy:		94.60 %
Epoch 10 of 100 took 13.467s
  training loss:		0.378927
  validation loss:		0.179295
  validation accuracy:		94.92 %
Epoch 11 of 100 took 13.562s
  training loss:		0.354616
  validation loss:		0.167572
  validation accuracy:		95.23 %
Epoch 12 of 100 took 13.494s
  training loss:		0.330484
  validation loss:		0.159048
  validation accuracy:		95.32 %
Epoch 13 of 100 took 13.575s
  training loss:		0.312350
  validation loss:		0.150206
  validation accuracy:		95.57 %
Epoch 14 of 100 took 13.518s
  training loss:		0.297965
  validation loss:		0.144298
  validation accuracy:		95.67 %
Epoch 15 of 100 took 13.501s
  training loss:		0.284579
  validation loss:		0.139137
  validation accuracy:		95.82 %
Epoch 16 of 100 took 13.543s
  training loss:		0.269153
  validation loss:		0.132601
  validation accuracy:		96.10 %
Epoch 17 of 100 took 13.502s
  training loss:		0.262257
  validation loss:		0.127356
  validation accuracy:		96.28 %
Epoch 18 of 100 took 13.577s
  training loss:		0.250962
  validation loss:		0.123183
  validation accuracy:		96.40 %
Epoch 19 of 100 took 13.521s
  training loss:		0.239871
  validation loss:		0.120035
  validation accuracy:		96.55 %
Epoch 20 of 100 took 13.511s
  training loss:		0.231835
  validation loss:		0.116187
  validation accuracy:		96.63 %
Epoch 21 of 100 took 13.513s
  training loss:		0.224303
  validation loss:		0.112835
  validation accuracy:		96.72 %
Epoch 22 of 100 took 13.517s
  training loss:		0.219452
  validation loss:		0.110547
  validation accuracy:		96.77 %
Epoch 23 of 100 took 13.514s
  training loss:		0.210976
  validation loss:		0.107513
  validation accuracy:		96.83 %
Epoch 24 of 100 took 13.707s
  training loss:		0.206459
  validation loss:		0.104671
  validation accuracy:		96.90 %
Epoch 25 of 100 took 13.525s
  training loss:		0.200265
  validation loss:		0.103346
  validation accuracy:		96.95 %
Epoch 26 of 100 took 13.542s
  training loss:		0.196823
  validation loss:		0.101387
  validation accuracy:		97.08 %
Epoch 27 of 100 took 13.507s
  training loss:		0.192607
  validation loss:		0.098460
  validation accuracy:		97.15 %
Epoch 28 of 100 took 13.503s
  training loss:		0.190105
  validation loss:		0.097524
  validation accuracy:		97.05 %
Epoch 29 of 100 took 13.522s
  training loss:		0.184453
  validation loss:		0.095687
  validation accuracy:		97.12 %
Epoch 30 of 100 took 13.499s
  training loss:		0.172096
  validation loss:		0.093325
  validation accuracy:		97.35 %
Epoch 31 of 100 took 13.681s
  training loss:		0.173613
  validation loss:		0.091836
  validation accuracy:		97.28 %
Epoch 32 of 100 took 13.510s
  training loss:		0.171557
  validation loss:		0.090763
  validation accuracy:		97.27 %
Epoch 33 of 100 took 13.507s
  training loss:		0.169658
  validation loss:		0.089454
  validation accuracy:		97.23 %
Epoch 34 of 100 took 13.511s
  training loss:		0.169507
  validation loss:		0.087939
  validation accuracy:		97.35 %
Epoch 35 of 100 took 13.497s
  training loss:		0.161640
  validation loss:		0.086721
  validation accuracy:		97.40 %
Epoch 36 of 100 took 13.584s
  training loss:		0.161017
  validation loss:		0.085633
  validation accuracy:		97.45 %
Epoch 37 of 100 took 13.606s
  training loss:		0.157032
  validation loss:		0.084306
  validation accuracy:		97.47 %
Epoch 38 of 100 took 13.509s
  training loss:		0.155523
  validation loss:		0.083462
  validation accuracy:		97.45 %
Epoch 39 of 100 took 13.491s
  training loss:		0.153314
  validation loss:		0.082472
  validation accuracy:		97.48 %
Epoch 40 of 100 took 13.590s
  training loss:		0.151670
  validation loss:		0.082141
  validation accuracy:		97.48 %
Epoch 41 of 100 took 13.550s
  training loss:		0.151731
  validation loss:		0.080553
  validation accuracy:		97.58 %
Epoch 42 of 100 took 13.503s
  training loss:		0.144794
  validation loss:		0.079479
  validation accuracy:		97.58 %
Epoch 43 of 100 took 13.514s
  training loss:		0.146577
  validation loss:		0.078923
  validation accuracy:		97.60 %
Epoch 44 of 100 took 13.661s
  training loss:		0.140411
  validation loss:		0.078386
  validation accuracy:		97.63 %
Epoch 45 of 100 took 13.499s
  training loss:		0.142701
  validation loss:		0.076655
  validation accuracy:		97.68 %
Epoch 46 of 100 took 13.564s
  training loss:		0.135782
  validation loss:		0.077242
  validation accuracy:		97.63 %
Epoch 47 of 100 took 13.508s
  training loss:		0.142616
  validation loss:		0.076311
  validation accuracy:		97.68 %
Epoch 48 of 100 took 13.633s
  training loss:		0.139176
  validation loss:		0.075445
  validation accuracy:		97.68 %
Epoch 49 of 100 took 13.561s
  training loss:		0.134237
  validation loss:		0.074277
  validation accuracy:		97.73 %
Epoch 50 of 100 took 13.493s
  training loss:		0.132529
  validation loss:		0.074024
  validation accuracy:		97.72 %
Epoch 51 of 100 took 13.562s
  training loss:		0.130851
  validation loss:		0.073478
  validation accuracy:		97.73 %
Epoch 52 of 100 took 13.498s
  training loss:		0.133184
  validation loss:		0.072824
  validation accuracy:		97.77 %
Epoch 53 of 100 took 13.554s
  training loss:		0.130583
  validation loss:		0.072708
  validation accuracy:		97.72 %
Epoch 54 of 100 took 13.513s
  training loss:		0.126584
  validation loss:		0.072208
  validation accuracy:		97.78 %
Epoch 55 of 100 took 13.527s
  training loss:		0.131265
  validation loss:		0.071788
  validation accuracy:		97.80 %
Epoch 56 of 100 took 13.507s
  training loss:		0.127497
  validation loss:		0.070806
  validation accuracy:		97.87 %
Epoch 57 of 100 took 13.508s
  training loss:		0.126658
  validation loss:		0.070154
  validation accuracy:		97.90 %
Epoch 58 of 100 took 13.514s
  training loss:		0.126876
  validation loss:		0.070148
  validation accuracy:		97.88 %
Epoch 59 of 100 took 13.636s
  training loss:		0.125591
  validation loss:		0.069376
  validation accuracy:		97.90 %
Epoch 60 of 100 took 13.548s
  training loss:		0.121965
  validation loss:		0.069326
  validation accuracy:		97.92 %
Epoch 61 of 100 took 13.666s
  training loss:		0.123725
  validation loss:		0.069115
  validation accuracy:		97.93 %
Epoch 62 of 100 took 13.517s
  training loss:		0.121049
  validation loss:		0.067593
  validation accuracy:		97.97 %
Epoch 63 of 100 took 13.606s
  training loss:		0.118444
  validation loss:		0.067450
  validation accuracy:		97.95 %
Epoch 64 of 100 took 13.516s
  training loss:		0.121021
  validation loss:		0.066974
  validation accuracy:		97.98 %
Epoch 65 of 100 took 13.514s
  training loss:		0.124091
  validation loss:		0.066865
  validation accuracy:		97.93 %
Epoch 66 of 100 took 13.663s
  training loss:		0.118352
  validation loss:		0.066070
  validation accuracy:		97.98 %
Epoch 67 of 100 took 13.526s
  training loss:		0.120182
  validation loss:		0.065949
  validation accuracy:		97.97 %
Epoch 68 of 100 took 13.674s
  training loss:		0.114066
  validation loss:		0.065951
  validation accuracy:		97.97 %
Epoch 69 of 100 took 13.496s
  training loss:		0.111528
  validation loss:		0.065388
  validation accuracy:		97.98 %
Epoch 70 of 100 took 13.507s
  training loss:		0.117763
  validation loss:		0.064791
  validation accuracy:		98.02 %
Epoch 71 of 100 took 13.529s
  training loss:		0.112628
  validation loss:		0.064584
  validation accuracy:		98.03 %
Epoch 72 of 100 took 13.503s
  training loss:		0.113726
  validation loss:		0.064395
  validation accuracy:		97.97 %
Epoch 73 of 100 took 13.674s
  training loss:		0.113840
  validation loss:		0.064412
  validation accuracy:		97.97 %
Epoch 74 of 100 took 13.503s
  training loss:		0.114447
  validation loss:		0.064155
  validation accuracy:		98.03 %
Epoch 75 of 100 took 13.687s
  training loss:		0.109345
  validation loss:		0.063425
  validation accuracy:		98.03 %
Epoch 76 of 100 took 13.504s
  training loss:		0.108565
  validation loss:		0.063506
  validation accuracy:		98.02 %
Epoch 77 of 100 took 13.675s
  training loss:		0.110519
  validation loss:		0.062447
  validation accuracy:		98.07 %
Epoch 78 of 100 took 13.507s
  training loss:		0.107191
  validation loss:		0.062636
  validation accuracy:		98.02 %
Epoch 79 of 100 took 13.542s
  training loss:		0.110902
  validation loss:		0.061714
  validation accuracy:		98.05 %
Epoch 80 of 100 took 13.646s
  training loss:		0.106325
  validation loss:		0.061782
  validation accuracy:		98.07 %
Epoch 81 of 100 took 13.518s
  training loss:		0.108796
  validation loss:		0.061641
  validation accuracy:		98.07 %
Epoch 82 of 100 took 13.504s
  training loss:		0.105725
  validation loss:		0.061006
  validation accuracy:		98.17 %
Epoch 83 of 100 took 13.685s
  training loss:		0.106818
  validation loss:		0.061244
  validation accuracy:		98.12 %
Epoch 84 of 100 took 13.515s
  training loss:		0.104466
  validation loss:		0.059990
  validation accuracy:		98.20 %
Epoch 85 of 100 took 13.517s
  training loss:		0.107140
  validation loss:		0.060270
  validation accuracy:		98.13 %
Epoch 86 of 100 took 13.511s
  training loss:		0.105697
  validation loss:		0.059767
  validation accuracy:		98.20 %
Epoch 87 of 100 took 13.507s
  training loss:		0.104303
  validation loss:		0.059329
  validation accuracy:		98.15 %
Epoch 88 of 100 took 13.517s
  training loss:		0.101200
  validation loss:		0.059232
  validation accuracy:		98.18 %
Epoch 89 of 100 took 13.690s
  training loss:		0.102145
  validation loss:		0.059386
  validation accuracy:		98.17 %
Epoch 90 of 100 took 13.505s
  training loss:		0.102449
  validation loss:		0.058694
  validation accuracy:		98.23 %
Epoch 91 of 100 took 13.549s
  training loss:		0.099909
  validation loss:		0.058637
  validation accuracy:		98.18 %
Epoch 92 of 100 took 13.495s
  training loss:		0.103252
  validation loss:		0.058517
  validation accuracy:		98.22 %
Epoch 93 of 100 took 13.563s
  training loss:		0.101971
  validation loss:		0.058387
  validation accuracy:		98.17 %
Epoch 94 of 100 took 13.501s
  training loss:		0.101970
  validation loss:		0.057955
  validation accuracy:		98.17 %
Epoch 95 of 100 took 13.512s
  training loss:		0.096786
  validation loss:		0.057281
  validation accuracy:		98.22 %
Epoch 96 of 100 took 13.508s
  training loss:		0.096936
  validation loss:		0.057466
  validation accuracy:		98.23 %
Epoch 97 of 100 took 13.506s
  training loss:		0.096349
  validation loss:		0.057076
  validation accuracy:		98.23 %
Epoch 98 of 100 took 13.524s
  training loss:		0.098939
  validation loss:		0.056994
  validation accuracy:		98.20 %
Epoch 99 of 100 took 13.523s
  training loss:		0.099933
  validation loss:		0.057034
  validation accuracy:		98.25 %
Epoch 100 of 100 took 13.506s
  training loss:		0.094662
  validation loss:		0.056664
  validation accuracy:		98.25 %
Final results:
  test loss:			0.029763
  test accuracy:		98.86 %
