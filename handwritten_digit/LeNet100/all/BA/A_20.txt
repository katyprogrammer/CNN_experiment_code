loading data...
#train = 24479, #test = 5139, #valid = 6117
building model and compiling functions...
w=(32, 1, 5, 5),b=(32,)
layers other than "dense", "conv" layers, donnot have params
w=(32, 32, 5, 5),b=(32,)
layers other than "dense", "conv" layers, donnot have params
layers other than "dense", "conv" layers, donnot have params
w=(512, 256),b=(256,)
layers other than "dense", "conv" layers, donnot have params
w=(256, 10),b=(10,)
decomposing tensor W of shape (4, 512, 800)...
decomposing tensor B of shape (4, 800)...
starting training...
Epoch 1 of 100 took 14.067s
  training loss:		2.382710
  validation loss:		2.307491
  validation accuracy:		0.00 %
Epoch 2 of 100 took 13.431s
  training loss:		2.273307
  validation loss:		2.231559
  validation accuracy:		22.47 %
Epoch 3 of 100 took 13.423s
  training loss:		2.198861
  validation loss:		2.146841
  validation accuracy:		22.47 %
Epoch 4 of 100 took 14.188s
  training loss:		2.085029
  validation loss:		1.942810
  validation accuracy:		19.73 %
Epoch 5 of 100 took 13.632s
  training loss:		1.807795
  validation loss:		1.646864
  validation accuracy:		22.47 %
Epoch 6 of 100 took 13.934s
  training loss:		1.659901
  validation loss:		1.615154
  validation accuracy:		22.47 %
Epoch 7 of 100 took 13.815s
  training loss:		1.640308
  validation loss:		1.608621
  validation accuracy:		30.38 %
Epoch 8 of 100 took 13.771s
  training loss:		1.630757
  validation loss:		1.604448
  validation accuracy:		33.00 %
Epoch 9 of 100 took 13.805s
  training loss:		1.619812
  validation loss:		1.600410
  validation accuracy:		22.47 %
Epoch 10 of 100 took 13.689s
  training loss:		1.615066
  validation loss:		1.595520
  validation accuracy:		48.45 %
Epoch 11 of 100 took 14.191s
  training loss:		1.606946
  validation loss:		1.590944
  validation accuracy:		24.57 %
Epoch 12 of 100 took 13.806s
  training loss:		1.602395
  validation loss:		1.583733
  validation accuracy:		50.92 %
Epoch 13 of 100 took 13.868s
  training loss:		1.596959
  validation loss:		1.575138
  validation accuracy:		50.63 %
Epoch 14 of 100 took 13.790s
  training loss:		1.588262
  validation loss:		1.563366
  validation accuracy:		46.77 %
Epoch 15 of 100 took 13.782s
  training loss:		1.575725
  validation loss:		1.543544
  validation accuracy:		50.78 %
Epoch 16 of 100 took 13.627s
  training loss:		1.558843
  validation loss:		1.515653
  validation accuracy:		49.77 %
Epoch 17 of 100 took 13.772s
  training loss:		1.529347
  validation loss:		1.463389
  validation accuracy:		72.77 %
Epoch 18 of 100 took 13.721s
  training loss:		1.484708
  validation loss:		1.371852
  validation accuracy:		79.13 %
Epoch 19 of 100 took 14.012s
  training loss:		1.406822
  validation loss:		1.229289
  validation accuracy:		80.12 %
Epoch 20 of 100 took 14.145s
  training loss:		1.285857
  validation loss:		1.043597
  validation accuracy:		81.07 %
Epoch 21 of 100 took 13.687s
  training loss:		1.165812
  validation loss:		0.883996
  validation accuracy:		82.70 %
Epoch 22 of 100 took 13.667s
  training loss:		1.068309
  validation loss:		0.764546
  validation accuracy:		84.02 %
Epoch 23 of 100 took 13.748s
  training loss:		0.973069
  validation loss:		0.664460
  validation accuracy:		85.92 %
Epoch 24 of 100 took 13.532s
  training loss:		0.890689
  validation loss:		0.578674
  validation accuracy:		87.10 %
Epoch 25 of 100 took 13.699s
  training loss:		0.818920
  validation loss:		0.507886
  validation accuracy:		88.27 %
Epoch 26 of 100 took 13.995s
  training loss:		0.751811
  validation loss:		0.443471
  validation accuracy:		89.47 %
Epoch 27 of 100 took 13.565s
  training loss:		0.692729
  validation loss:		0.394852
  validation accuracy:		90.37 %
Epoch 28 of 100 took 14.327s
  training loss:		0.629607
  validation loss:		0.350860
  validation accuracy:		91.27 %
Epoch 29 of 100 took 13.786s
  training loss:		0.586305
  validation loss:		0.321278
  validation accuracy:		91.77 %
Epoch 30 of 100 took 13.954s
  training loss:		0.540183
  validation loss:		0.292947
  validation accuracy:		92.15 %
Epoch 31 of 100 took 14.211s
  training loss:		0.505221
  validation loss:		0.270868
  validation accuracy:		92.55 %
Epoch 32 of 100 took 14.471s
  training loss:		0.475426
  validation loss:		0.252043
  validation accuracy:		93.02 %
Epoch 33 of 100 took 14.282s
  training loss:		0.449331
  validation loss:		0.238221
  validation accuracy:		93.23 %
Epoch 34 of 100 took 13.427s
  training loss:		0.429290
  validation loss:		0.229416
  validation accuracy:		93.55 %
Epoch 35 of 100 took 14.346s
  training loss:		0.411290
  validation loss:		0.220611
  validation accuracy:		93.65 %
Epoch 36 of 100 took 14.461s
  training loss:		0.394469
  validation loss:		0.210071
  validation accuracy:		93.97 %
Epoch 37 of 100 took 13.903s
  training loss:		0.375228
  validation loss:		0.202656
  validation accuracy:		94.03 %
Epoch 38 of 100 took 14.585s
  training loss:		0.366572
  validation loss:		0.196741
  validation accuracy:		94.20 %
Epoch 39 of 100 took 14.177s
  training loss:		0.356145
  validation loss:		0.190616
  validation accuracy:		94.38 %
Epoch 40 of 100 took 13.872s
  training loss:		0.347093
  validation loss:		0.186161
  validation accuracy:		94.45 %
Epoch 41 of 100 took 13.997s
  training loss:		0.344612
  validation loss:		0.181389
  validation accuracy:		94.58 %
Epoch 42 of 100 took 13.679s
  training loss:		0.329052
  validation loss:		0.176819
  validation accuracy:		94.73 %
Epoch 43 of 100 took 14.092s
  training loss:		0.322232
  validation loss:		0.171456
  validation accuracy:		94.83 %
Epoch 44 of 100 took 14.067s
  training loss:		0.312416
  validation loss:		0.168265
  validation accuracy:		94.83 %
Epoch 45 of 100 took 14.265s
  training loss:		0.313513
  validation loss:		0.165513
  validation accuracy:		94.93 %
Epoch 46 of 100 took 14.098s
  training loss:		0.307424
  validation loss:		0.162417
  validation accuracy:		95.12 %
Epoch 47 of 100 took 13.922s
  training loss:		0.296503
  validation loss:		0.158968
  validation accuracy:		95.12 %
Epoch 48 of 100 took 13.898s
  training loss:		0.285870
  validation loss:		0.154315
  validation accuracy:		95.38 %
Epoch 49 of 100 took 14.473s
  training loss:		0.282472
  validation loss:		0.152401
  validation accuracy:		95.40 %
Epoch 50 of 100 took 14.404s
  training loss:		0.281390
  validation loss:		0.148967
  validation accuracy:		95.52 %
Epoch 51 of 100 took 14.235s
  training loss:		0.268079
  validation loss:		0.145764
  validation accuracy:		95.58 %
Epoch 52 of 100 took 13.556s
  training loss:		0.263302
  validation loss:		0.142519
  validation accuracy:		95.62 %
Epoch 53 of 100 took 14.343s
  training loss:		0.258737
  validation loss:		0.140331
  validation accuracy:		95.72 %
Epoch 54 of 100 took 14.262s
  training loss:		0.255356
  validation loss:		0.137460
  validation accuracy:		95.83 %
Epoch 55 of 100 took 14.210s
  training loss:		0.257731
  validation loss:		0.136123
  validation accuracy:		95.82 %
Epoch 56 of 100 took 13.946s
  training loss:		0.249173
  validation loss:		0.133607
  validation accuracy:		95.90 %
Epoch 57 of 100 took 14.030s
  training loss:		0.241264
  validation loss:		0.130865
  validation accuracy:		95.90 %
Epoch 58 of 100 took 13.874s
  training loss:		0.243406
  validation loss:		0.128097
  validation accuracy:		96.12 %
Epoch 59 of 100 took 13.724s
  training loss:		0.236559
  validation loss:		0.127234
  validation accuracy:		96.15 %
Epoch 60 of 100 took 14.010s
  training loss:		0.241756
  validation loss:		0.125725
  validation accuracy:		96.22 %
Epoch 61 of 100 took 14.267s
  training loss:		0.233731
  validation loss:		0.122750
  validation accuracy:		96.27 %
Epoch 62 of 100 took 14.093s
  training loss:		0.230015
  validation loss:		0.121533
  validation accuracy:		96.28 %
Epoch 63 of 100 took 14.156s
  training loss:		0.225914
  validation loss:		0.120025
  validation accuracy:		96.35 %
Epoch 64 of 100 took 14.716s
  training loss:		0.220756
  validation loss:		0.118609
  validation accuracy:		96.32 %
Epoch 65 of 100 took 13.764s
  training loss:		0.223481
  validation loss:		0.116630
  validation accuracy:		96.38 %
Epoch 66 of 100 took 14.330s
  training loss:		0.211759
  validation loss:		0.113854
  validation accuracy:		96.57 %
Epoch 67 of 100 took 13.554s
  training loss:		0.217723
  validation loss:		0.112968
  validation accuracy:		96.53 %
Epoch 68 of 100 took 14.065s
  training loss:		0.212978
  validation loss:		0.111451
  validation accuracy:		96.60 %
Epoch 69 of 100 took 13.851s
  training loss:		0.205183
  validation loss:		0.109202
  validation accuracy:		96.63 %
Epoch 70 of 100 took 13.529s
  training loss:		0.208089
  validation loss:		0.108052
  validation accuracy:		96.70 %
Epoch 71 of 100 took 13.658s
  training loss:		0.204669
  validation loss:		0.106799
  validation accuracy:		96.72 %
Epoch 72 of 100 took 13.861s
  training loss:		0.206059
  validation loss:		0.105534
  validation accuracy:		96.85 %
Epoch 73 of 100 took 13.974s
  training loss:		0.199565
  validation loss:		0.104871
  validation accuracy:		96.65 %
Epoch 74 of 100 took 13.791s
  training loss:		0.198489
  validation loss:		0.103082
  validation accuracy:		96.82 %
Epoch 75 of 100 took 14.803s
  training loss:		0.196869
  validation loss:		0.102897
  validation accuracy:		96.78 %
Epoch 76 of 100 took 13.855s
  training loss:		0.198762
  validation loss:		0.100327
  validation accuracy:		96.92 %
Epoch 77 of 100 took 14.345s
  training loss:		0.191687
  validation loss:		0.100537
  validation accuracy:		96.73 %
Epoch 78 of 100 took 14.287s
  training loss:		0.188358
  validation loss:		0.099305
  validation accuracy:		96.95 %
Epoch 79 of 100 took 14.803s
  training loss:		0.190562
  validation loss:		0.097303
  validation accuracy:		96.98 %
Epoch 80 of 100 took 15.192s
  training loss:		0.186260
  validation loss:		0.095520
  validation accuracy:		97.03 %
Epoch 81 of 100 took 14.862s
  training loss:		0.187410
  validation loss:		0.094939
  validation accuracy:		97.00 %
Epoch 82 of 100 took 13.681s
  training loss:		0.188659
  validation loss:		0.094371
  validation accuracy:		97.02 %
Epoch 83 of 100 took 15.125s
  training loss:		0.181961
  validation loss:		0.093350
  validation accuracy:		96.98 %
Epoch 84 of 100 took 14.939s
  training loss:		0.184019
  validation loss:		0.092236
  validation accuracy:		97.15 %
Epoch 85 of 100 took 14.794s
  training loss:		0.180018
  validation loss:		0.091587
  validation accuracy:		97.12 %
Epoch 86 of 100 took 13.984s
  training loss:		0.179396
  validation loss:		0.090577
  validation accuracy:		97.12 %
Epoch 87 of 100 took 14.255s
  training loss:		0.173429
  validation loss:		0.089825
  validation accuracy:		97.18 %
Epoch 88 of 100 took 14.243s
  training loss:		0.175085
  validation loss:		0.088639
  validation accuracy:		97.22 %
Epoch 89 of 100 took 14.216s
  training loss:		0.173769
  validation loss:		0.088391
  validation accuracy:		97.20 %
Epoch 90 of 100 took 15.128s
  training loss:		0.172050
  validation loss:		0.086183
  validation accuracy:		97.28 %
Epoch 91 of 100 took 15.241s
  training loss:		0.166225
  validation loss:		0.085650
  validation accuracy:		97.23 %
Epoch 92 of 100 took 14.826s
  training loss:		0.162109
  validation loss:		0.085595
  validation accuracy:		97.22 %
Epoch 93 of 100 took 14.175s
  training loss:		0.162803
  validation loss:		0.085071
  validation accuracy:		97.23 %
Epoch 94 of 100 took 14.035s
  training loss:		0.163215
  validation loss:		0.084321
  validation accuracy:		97.25 %
Epoch 95 of 100 took 15.803s
  training loss:		0.162127
  validation loss:		0.083247
  validation accuracy:		97.30 %
Epoch 96 of 100 took 15.018s
  training loss:		0.157646
  validation loss:		0.082459
  validation accuracy:		97.30 %
Epoch 97 of 100 took 14.885s
  training loss:		0.161179
  validation loss:		0.082308
  validation accuracy:		97.32 %
Epoch 98 of 100 took 13.722s
  training loss:		0.158555
  validation loss:		0.081318
  validation accuracy:		97.33 %
Epoch 99 of 100 took 13.760s
  training loss:		0.158191
  validation loss:		0.080304
  validation accuracy:		97.43 %
Epoch 100 of 100 took 14.956s
  training loss:		0.160351
  validation loss:		0.080343
  validation accuracy:		97.35 %
Final results:
  test loss:			0.052571
  test accuracy:		98.42 %
