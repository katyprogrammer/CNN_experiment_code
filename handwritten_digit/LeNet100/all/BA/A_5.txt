loading data...
#train = 24479, #test = 5139, #valid = 6117
building model and compiling functions...
w=(32, 1, 5, 5),b=(32,)
layers other than "dense", "conv" layers, donnot have params
w=(32, 32, 5, 5),b=(32,)
layers other than "dense", "conv" layers, donnot have params
layers other than "dense", "conv" layers, donnot have params
w=(512, 256),b=(256,)
layers other than "dense", "conv" layers, donnot have params
w=(256, 10),b=(10,)
decomposing tensor W of shape (4, 512, 800)...
decomposing tensor B of shape (4, 800)...
starting training...
Epoch 1 of 100 took 13.544s
  training loss:		2.346919
  validation loss:		2.320670
  validation accuracy:		0.00 %
Epoch 2 of 100 took 13.632s
  training loss:		2.295610
  validation loss:		2.268867
  validation accuracy:		22.47 %
Epoch 3 of 100 took 14.306s
  training loss:		2.242791
  validation loss:		2.212436
  validation accuracy:		22.47 %
Epoch 4 of 100 took 14.017s
  training loss:		2.170920
  validation loss:		2.110072
  validation accuracy:		22.47 %
Epoch 5 of 100 took 13.720s
  training loss:		1.971353
  validation loss:		1.767439
  validation accuracy:		22.47 %
Epoch 6 of 100 took 13.700s
  training loss:		1.671571
  validation loss:		1.619918
  validation accuracy:		19.73 %
Epoch 7 of 100 took 13.863s
  training loss:		1.618142
  validation loss:		1.608584
  validation accuracy:		20.43 %
Epoch 8 of 100 took 13.578s
  training loss:		1.610637
  validation loss:		1.601044
  validation accuracy:		19.73 %
Epoch 9 of 100 took 13.531s
  training loss:		1.607393
  validation loss:		1.597680
  validation accuracy:		33.70 %
Epoch 10 of 100 took 14.116s
  training loss:		1.602862
  validation loss:		1.592525
  validation accuracy:		46.13 %
Epoch 11 of 100 took 13.594s
  training loss:		1.600173
  validation loss:		1.587338
  validation accuracy:		34.22 %
Epoch 12 of 100 took 14.640s
  training loss:		1.596665
  validation loss:		1.582139
  validation accuracy:		44.70 %
Epoch 13 of 100 took 14.954s
  training loss:		1.590377
  validation loss:		1.572354
  validation accuracy:		32.65 %
Epoch 14 of 100 took 13.671s
  training loss:		1.584875
  validation loss:		1.558618
  validation accuracy:		43.82 %
Epoch 15 of 100 took 13.579s
  training loss:		1.573919
  validation loss:		1.540628
  validation accuracy:		41.38 %
Epoch 16 of 100 took 15.106s
  training loss:		1.559184
  validation loss:		1.516289
  validation accuracy:		62.27 %
Epoch 17 of 100 took 14.307s
  training loss:		1.534982
  validation loss:		1.466388
  validation accuracy:		66.70 %
Epoch 18 of 100 took 14.623s
  training loss:		1.493837
  validation loss:		1.394644
  validation accuracy:		69.58 %
Epoch 19 of 100 took 14.675s
  training loss:		1.429615
  validation loss:		1.275957
  validation accuracy:		74.90 %
Epoch 20 of 100 took 14.130s
  training loss:		1.322922
  validation loss:		1.106457
  validation accuracy:		72.63 %
Epoch 21 of 100 took 14.054s
  training loss:		1.200235
  validation loss:		0.954227
  validation accuracy:		77.38 %
Epoch 22 of 100 took 14.300s
  training loss:		1.092173
  validation loss:		0.838492
  validation accuracy:		80.97 %
Epoch 23 of 100 took 13.701s
  training loss:		0.998056
  validation loss:		0.732377
  validation accuracy:		82.83 %
Epoch 24 of 100 took 14.143s
  training loss:		0.918074
  validation loss:		0.638720
  validation accuracy:		84.58 %
Epoch 25 of 100 took 14.304s
  training loss:		0.819414
  validation loss:		0.542640
  validation accuracy:		87.57 %
Epoch 26 of 100 took 14.593s
  training loss:		0.725068
  validation loss:		0.458098
  validation accuracy:		89.30 %
Epoch 27 of 100 took 14.730s
  training loss:		0.643238
  validation loss:		0.393169
  validation accuracy:		90.23 %
Epoch 28 of 100 took 14.571s
  training loss:		0.580871
  validation loss:		0.347003
  validation accuracy:		91.13 %
Epoch 29 of 100 took 14.647s
  training loss:		0.512089
  validation loss:		0.304172
  validation accuracy:		91.92 %
Epoch 30 of 100 took 14.156s
  training loss:		0.464604
  validation loss:		0.272455
  validation accuracy:		92.62 %
Epoch 31 of 100 took 14.561s
  training loss:		0.429237
  validation loss:		0.251242
  validation accuracy:		93.00 %
Epoch 32 of 100 took 14.428s
  training loss:		0.401176
  validation loss:		0.235141
  validation accuracy:		93.25 %
Epoch 33 of 100 took 14.716s
  training loss:		0.378424
  validation loss:		0.221500
  validation accuracy:		93.63 %
Epoch 34 of 100 took 14.203s
  training loss:		0.358142
  validation loss:		0.208471
  validation accuracy:		93.93 %
Epoch 35 of 100 took 14.868s
  training loss:		0.333256
  validation loss:		0.197348
  validation accuracy:		94.18 %
Epoch 36 of 100 took 14.417s
  training loss:		0.320963
  validation loss:		0.188521
  validation accuracy:		94.48 %
Epoch 37 of 100 took 14.278s
  training loss:		0.307265
  validation loss:		0.179520
  validation accuracy:		94.63 %
Epoch 38 of 100 took 14.137s
  training loss:		0.299447
  validation loss:		0.174607
  validation accuracy:		94.77 %
Epoch 39 of 100 took 14.501s
  training loss:		0.280218
  validation loss:		0.168437
  validation accuracy:		94.97 %
Epoch 40 of 100 took 14.975s
  training loss:		0.270692
  validation loss:		0.161408
  validation accuracy:		95.20 %
Epoch 41 of 100 took 14.142s
  training loss:		0.265667
  validation loss:		0.157410
  validation accuracy:		95.23 %
Epoch 42 of 100 took 14.289s
  training loss:		0.255416
  validation loss:		0.151761
  validation accuracy:		95.43 %
Epoch 43 of 100 took 14.685s
  training loss:		0.240609
  validation loss:		0.146838
  validation accuracy:		95.53 %
Epoch 44 of 100 took 14.051s
  training loss:		0.235301
  validation loss:		0.143437
  validation accuracy:		95.62 %
Epoch 45 of 100 took 14.216s
  training loss:		0.231781
  validation loss:		0.139903
  validation accuracy:		95.68 %
Epoch 46 of 100 took 14.629s
  training loss:		0.224006
  validation loss:		0.135195
  validation accuracy:		95.88 %
Epoch 47 of 100 took 14.662s
  training loss:		0.217376
  validation loss:		0.132141
  validation accuracy:		95.98 %
Epoch 48 of 100 took 14.305s
  training loss:		0.207229
  validation loss:		0.128206
  validation accuracy:		96.03 %
Epoch 49 of 100 took 14.030s
  training loss:		0.207167
  validation loss:		0.125119
  validation accuracy:		96.08 %
Epoch 50 of 100 took 14.292s
  training loss:		0.202147
  validation loss:		0.122860
  validation accuracy:		96.18 %
Epoch 51 of 100 took 14.408s
  training loss:		0.197643
  validation loss:		0.119879
  validation accuracy:		96.20 %
Epoch 52 of 100 took 14.284s
  training loss:		0.190502
  validation loss:		0.116502
  validation accuracy:		96.33 %
Epoch 53 of 100 took 14.515s
  training loss:		0.192707
  validation loss:		0.114663
  validation accuracy:		96.37 %
Epoch 54 of 100 took 14.779s
  training loss:		0.185779
  validation loss:		0.113033
  validation accuracy:		96.38 %
Epoch 55 of 100 took 14.483s
  training loss:		0.179820
  validation loss:		0.110074
  validation accuracy:		96.58 %
Epoch 56 of 100 took 14.768s
  training loss:		0.181329
  validation loss:		0.108161
  validation accuracy:		96.70 %
Epoch 57 of 100 took 14.126s
  training loss:		0.176368
  validation loss:		0.106543
  validation accuracy:		96.68 %
Epoch 58 of 100 took 14.046s
  training loss:		0.172397
  validation loss:		0.105480
  validation accuracy:		96.72 %
Epoch 59 of 100 took 14.356s
  training loss:		0.172188
  validation loss:		0.103534
  validation accuracy:		96.73 %
Epoch 60 of 100 took 13.845s
  training loss:		0.168525
  validation loss:		0.101351
  validation accuracy:		96.77 %
Epoch 61 of 100 took 14.048s
  training loss:		0.167720
  validation loss:		0.099393
  validation accuracy:		96.87 %
Epoch 62 of 100 took 13.965s
  training loss:		0.164195
  validation loss:		0.098139
  validation accuracy:		96.85 %
Epoch 63 of 100 took 14.992s
  training loss:		0.162701
  validation loss:		0.097742
  validation accuracy:		96.80 %
Epoch 64 of 100 took 14.116s
  training loss:		0.159998
  validation loss:		0.094798
  validation accuracy:		97.00 %
Epoch 65 of 100 took 13.916s
  training loss:		0.154273
  validation loss:		0.094311
  validation accuracy:		96.97 %
Epoch 66 of 100 took 14.326s
  training loss:		0.154918
  validation loss:		0.092420
  validation accuracy:		97.03 %
Epoch 67 of 100 took 13.775s
  training loss:		0.151719
  validation loss:		0.091496
  validation accuracy:		97.07 %
Epoch 68 of 100 took 13.526s
  training loss:		0.150662
  validation loss:		0.089290
  validation accuracy:		97.25 %
Epoch 69 of 100 took 14.028s
  training loss:		0.146781
  validation loss:		0.088981
  validation accuracy:		97.18 %
Epoch 70 of 100 took 14.202s
  training loss:		0.148034
  validation loss:		0.088232
  validation accuracy:		97.23 %
Epoch 71 of 100 took 14.322s
  training loss:		0.141350
  validation loss:		0.086612
  validation accuracy:		97.20 %
Epoch 72 of 100 took 13.504s
  training loss:		0.141888
  validation loss:		0.085500
  validation accuracy:		97.32 %
Epoch 73 of 100 took 13.996s
  training loss:		0.143137
  validation loss:		0.084761
  validation accuracy:		97.32 %
Epoch 74 of 100 took 13.894s
  training loss:		0.138142
  validation loss:		0.083377
  validation accuracy:		97.35 %
Epoch 75 of 100 took 14.012s
  training loss:		0.140575
  validation loss:		0.083271
  validation accuracy:		97.37 %
Epoch 76 of 100 took 13.885s
  training loss:		0.137231
  validation loss:		0.081875
  validation accuracy:		97.42 %
Epoch 77 of 100 took 14.576s
  training loss:		0.132366
  validation loss:		0.080394
  validation accuracy:		97.48 %
Epoch 78 of 100 took 14.264s
  training loss:		0.131370
  validation loss:		0.079863
  validation accuracy:		97.47 %
Epoch 79 of 100 took 14.454s
  training loss:		0.133545
  validation loss:		0.079695
  validation accuracy:		97.48 %
Epoch 80 of 100 took 16.104s
  training loss:		0.129149
  validation loss:		0.078131
  validation accuracy:		97.57 %
Epoch 81 of 100 took 15.656s
  training loss:		0.127713
  validation loss:		0.076965
  validation accuracy:		97.62 %
Epoch 82 of 100 took 14.066s
  training loss:		0.131064
  validation loss:		0.076586
  validation accuracy:		97.65 %
Epoch 83 of 100 took 13.932s
  training loss:		0.126543
  validation loss:		0.076488
  validation accuracy:		97.65 %
Epoch 84 of 100 took 14.061s
  training loss:		0.125966
  validation loss:		0.075737
  validation accuracy:		97.68 %
Epoch 85 of 100 took 14.174s
  training loss:		0.126746
  validation loss:		0.074403
  validation accuracy:		97.72 %
Epoch 86 of 100 took 13.904s
  training loss:		0.123704
  validation loss:		0.073378
  validation accuracy:		97.70 %
Epoch 87 of 100 took 13.912s
  training loss:		0.121255
  validation loss:		0.073216
  validation accuracy:		97.73 %
Epoch 88 of 100 took 13.744s
  training loss:		0.122996
  validation loss:		0.072437
  validation accuracy:		97.72 %
Epoch 89 of 100 took 13.722s
  training loss:		0.121666
  validation loss:		0.072366
  validation accuracy:		97.73 %
Epoch 90 of 100 took 13.798s
  training loss:		0.117883
  validation loss:		0.071391
  validation accuracy:		97.73 %
Epoch 91 of 100 took 13.667s
  training loss:		0.115343
  validation loss:		0.070740
  validation accuracy:		97.75 %
Epoch 92 of 100 took 13.696s
  training loss:		0.115462
  validation loss:		0.070319
  validation accuracy:		97.78 %
Epoch 93 of 100 took 13.742s
  training loss:		0.118133
  validation loss:		0.069909
  validation accuracy:		97.82 %
Epoch 94 of 100 took 14.227s
  training loss:		0.114337
  validation loss:		0.069559
  validation accuracy:		97.83 %
Epoch 95 of 100 took 13.969s
  training loss:		0.114648
  validation loss:		0.068577
  validation accuracy:		97.90 %
Epoch 96 of 100 took 13.879s
  training loss:		0.114810
  validation loss:		0.067947
  validation accuracy:		97.92 %
Epoch 97 of 100 took 13.900s
  training loss:		0.112145
  validation loss:		0.067108
  validation accuracy:		97.85 %
Epoch 98 of 100 took 13.807s
  training loss:		0.112930
  validation loss:		0.067276
  validation accuracy:		97.87 %
Epoch 99 of 100 took 14.158s
  training loss:		0.114746
  validation loss:		0.066583
  validation accuracy:		97.90 %
Epoch 100 of 100 took 13.774s
  training loss:		0.107787
  validation loss:		0.066444
  validation accuracy:		97.88 %
Final results:
  test loss:			0.038555
  test accuracy:		98.80 %
