loading data...
#train = 24479, #test = 5139, #valid = 6117
building model and compiling functions...
w=(32, 1, 5, 5),b=(32,)
layers other than "dense", "conv" layers, donnot have params
w=(32, 32, 5, 5),b=(32,)
layers other than "dense", "conv" layers, donnot have params
layers other than "dense", "conv" layers, donnot have params
w=(512, 256),b=(256,)
layers other than "dense", "conv" layers, donnot have params
w=(256, 10),b=(10,)
decomposing tensor W of shape (4, 512, 800)...
decomposing tensor B of shape (4, 800)...
starting training...
Epoch 1 of 100 took 13.477s
  training loss:		2.806508
  validation loss:		2.303371
  validation accuracy:		0.07 %
Epoch 2 of 100 took 13.448s
  training loss:		2.262782
  validation loss:		2.204025
  validation accuracy:		50.83 %
Epoch 3 of 100 took 13.438s
  training loss:		2.126410
  validation loss:		1.879304
  validation accuracy:		54.53 %
Epoch 4 of 100 took 13.430s
  training loss:		1.691115
  validation loss:		1.163973
  validation accuracy:		70.12 %
Epoch 5 of 100 took 13.445s
  training loss:		1.199713
  validation loss:		0.732913
  validation accuracy:		84.10 %
Epoch 6 of 100 took 13.470s
  training loss:		0.908574
  validation loss:		0.488251
  validation accuracy:		92.93 %
Epoch 7 of 100 took 13.461s
  training loss:		0.728637
  validation loss:		0.349358
  validation accuracy:		93.58 %
Epoch 8 of 100 took 13.477s
  training loss:		0.612088
  validation loss:		0.279139
  validation accuracy:		93.92 %
Epoch 9 of 100 took 13.458s
  training loss:		0.541817
  validation loss:		0.238768
  validation accuracy:		93.98 %
Epoch 10 of 100 took 13.478s
  training loss:		0.484466
  validation loss:		0.208505
  validation accuracy:		94.48 %
Epoch 11 of 100 took 13.495s
  training loss:		0.448131
  validation loss:		0.191600
  validation accuracy:		94.63 %
Epoch 12 of 100 took 13.532s
  training loss:		0.412351
  validation loss:		0.177825
  validation accuracy:		94.88 %
Epoch 13 of 100 took 13.567s
  training loss:		0.391866
  validation loss:		0.171939
  validation accuracy:		94.85 %
Epoch 14 of 100 took 13.485s
  training loss:		0.370515
  validation loss:		0.160298
  validation accuracy:		95.17 %
Epoch 15 of 100 took 13.578s
  training loss:		0.348080
  validation loss:		0.152461
  validation accuracy:		95.40 %
Epoch 16 of 100 took 13.488s
  training loss:		0.334957
  validation loss:		0.145438
  validation accuracy:		95.58 %
Epoch 17 of 100 took 13.538s
  training loss:		0.320484
  validation loss:		0.139095
  validation accuracy:		95.67 %
Epoch 18 of 100 took 13.506s
  training loss:		0.311616
  validation loss:		0.135589
  validation accuracy:		95.80 %
Epoch 19 of 100 took 13.548s
  training loss:		0.294371
  validation loss:		0.129538
  validation accuracy:		95.98 %
Epoch 20 of 100 took 13.490s
  training loss:		0.286865
  validation loss:		0.125334
  validation accuracy:		96.13 %
Epoch 21 of 100 took 13.574s
  training loss:		0.287951
  validation loss:		0.122259
  validation accuracy:		96.27 %
Epoch 22 of 100 took 13.539s
  training loss:		0.272605
  validation loss:		0.117595
  validation accuracy:		96.43 %
Epoch 23 of 100 took 13.483s
  training loss:		0.262714
  validation loss:		0.115610
  validation accuracy:		96.53 %
Epoch 24 of 100 took 13.586s
  training loss:		0.252605
  validation loss:		0.114077
  validation accuracy:		96.53 %
Epoch 25 of 100 took 13.508s
  training loss:		0.246529
  validation loss:		0.109470
  validation accuracy:		96.52 %
Epoch 26 of 100 took 13.505s
  training loss:		0.245955
  validation loss:		0.107108
  validation accuracy:		96.72 %
Epoch 27 of 100 took 13.759s
  training loss:		0.236921
  validation loss:		0.104303
  validation accuracy:		96.88 %
Epoch 28 of 100 took 13.751s
  training loss:		0.220615
  validation loss:		0.100843
  validation accuracy:		96.92 %
Epoch 29 of 100 took 13.526s
  training loss:		0.220742
  validation loss:		0.099157
  validation accuracy:		97.02 %
Epoch 30 of 100 took 13.503s
  training loss:		0.223072
  validation loss:		0.097485
  validation accuracy:		97.10 %
Epoch 31 of 100 took 13.511s
  training loss:		0.219538
  validation loss:		0.096652
  validation accuracy:		97.07 %
Epoch 32 of 100 took 13.569s
  training loss:		0.213873
  validation loss:		0.093215
  validation accuracy:		97.22 %
Epoch 33 of 100 took 13.625s
  training loss:		0.210748
  validation loss:		0.091170
  validation accuracy:		97.27 %
Epoch 34 of 100 took 13.507s
  training loss:		0.208184
  validation loss:		0.090912
  validation accuracy:		97.30 %
Epoch 35 of 100 took 13.516s
  training loss:		0.196311
  validation loss:		0.089488
  validation accuracy:		97.30 %
Epoch 36 of 100 took 13.514s
  training loss:		0.199478
  validation loss:		0.087690
  validation accuracy:		97.40 %
Epoch 37 of 100 took 13.525s
  training loss:		0.197070
  validation loss:		0.087379
  validation accuracy:		97.47 %
Epoch 38 of 100 took 13.493s
  training loss:		0.192270
  validation loss:		0.085670
  validation accuracy:		97.48 %
Epoch 39 of 100 took 13.558s
  training loss:		0.188591
  validation loss:		0.084889
  validation accuracy:		97.52 %
Epoch 40 of 100 took 13.502s
  training loss:		0.183845
  validation loss:		0.082268
  validation accuracy:		97.60 %
Epoch 41 of 100 took 13.704s
  training loss:		0.181701
  validation loss:		0.082146
  validation accuracy:		97.58 %
Epoch 42 of 100 took 13.495s
  training loss:		0.178071
  validation loss:		0.080261
  validation accuracy:		97.58 %
Epoch 43 of 100 took 13.524s
  training loss:		0.179676
  validation loss:		0.079352
  validation accuracy:		97.68 %
Epoch 44 of 100 took 13.513s
  training loss:		0.175901
  validation loss:		0.078219
  validation accuracy:		97.70 %
Epoch 45 of 100 took 13.508s
  training loss:		0.172859
  validation loss:		0.078089
  validation accuracy:		97.75 %
Epoch 46 of 100 took 13.681s
  training loss:		0.170879
  validation loss:		0.077504
  validation accuracy:		97.78 %
Epoch 47 of 100 took 13.508s
  training loss:		0.167269
  validation loss:		0.075784
  validation accuracy:		97.77 %
Epoch 48 of 100 took 13.517s
  training loss:		0.166597
  validation loss:		0.075721
  validation accuracy:		97.83 %
Epoch 49 of 100 took 13.502s
  training loss:		0.165947
  validation loss:		0.074806
  validation accuracy:		97.80 %
Epoch 50 of 100 took 13.488s
  training loss:		0.161125
  validation loss:		0.073625
  validation accuracy:		97.85 %
Epoch 51 of 100 took 13.542s
  training loss:		0.159405
  validation loss:		0.073752
  validation accuracy:		97.87 %
Epoch 52 of 100 took 13.501s
  training loss:		0.160142
  validation loss:		0.073085
  validation accuracy:		97.88 %
Epoch 53 of 100 took 13.531s
  training loss:		0.160155
  validation loss:		0.072333
  validation accuracy:		97.92 %
Epoch 54 of 100 took 13.615s
  training loss:		0.157003
  validation loss:		0.072701
  validation accuracy:		97.92 %
Epoch 55 of 100 took 13.511s
  training loss:		0.156625
  validation loss:		0.071238
  validation accuracy:		97.93 %
Epoch 56 of 100 took 13.504s
  training loss:		0.153604
  validation loss:		0.070815
  validation accuracy:		97.97 %
Epoch 57 of 100 took 13.656s
  training loss:		0.149246
  validation loss:		0.069076
  validation accuracy:		97.92 %
Epoch 58 of 100 took 13.495s
  training loss:		0.147683
  validation loss:		0.068522
  validation accuracy:		97.95 %
Epoch 59 of 100 took 13.501s
  training loss:		0.150653
  validation loss:		0.069192
  validation accuracy:		97.93 %
Epoch 60 of 100 took 13.502s
  training loss:		0.151975
  validation loss:		0.068944
  validation accuracy:		98.03 %
Epoch 61 of 100 took 13.495s
  training loss:		0.142084
  validation loss:		0.067514
  validation accuracy:		98.02 %
Epoch 62 of 100 took 13.663s
  training loss:		0.147392
  validation loss:		0.066863
  validation accuracy:		97.95 %
Epoch 63 of 100 took 13.508s
  training loss:		0.145631
  validation loss:		0.065981
  validation accuracy:		98.08 %
Epoch 64 of 100 took 13.498s
  training loss:		0.143173
  validation loss:		0.065915
  validation accuracy:		98.07 %
Epoch 65 of 100 took 13.499s
  training loss:		0.141728
  validation loss:		0.064948
  validation accuracy:		98.08 %
Epoch 66 of 100 took 13.489s
  training loss:		0.146453
  validation loss:		0.064859
  validation accuracy:		98.12 %
Epoch 67 of 100 took 13.506s
  training loss:		0.143908
  validation loss:		0.063957
  validation accuracy:		98.10 %
Epoch 68 of 100 took 13.667s
  training loss:		0.139596
  validation loss:		0.063621
  validation accuracy:		98.10 %
Epoch 69 of 100 took 13.502s
  training loss:		0.138174
  validation loss:		0.062546
  validation accuracy:		98.12 %
Epoch 70 of 100 took 13.501s
  training loss:		0.135182
  validation loss:		0.062017
  validation accuracy:		98.22 %
Epoch 71 of 100 took 13.497s
  training loss:		0.135103
  validation loss:		0.062326
  validation accuracy:		98.15 %
Epoch 72 of 100 took 13.512s
  training loss:		0.139795
  validation loss:		0.062561
  validation accuracy:		98.13 %
Epoch 73 of 100 took 13.657s
  training loss:		0.133498
  validation loss:		0.060420
  validation accuracy:		98.15 %
Epoch 74 of 100 took 13.599s
  training loss:		0.135190
  validation loss:		0.060852
  validation accuracy:		98.17 %
Epoch 75 of 100 took 13.507s
  training loss:		0.130181
  validation loss:		0.060398
  validation accuracy:		98.20 %
Epoch 76 of 100 took 13.496s
  training loss:		0.140418
  validation loss:		0.059908
  validation accuracy:		98.25 %
Epoch 77 of 100 took 13.508s
  training loss:		0.130973
  validation loss:		0.059611
  validation accuracy:		98.22 %
Epoch 78 of 100 took 13.501s
  training loss:		0.133548
  validation loss:		0.060137
  validation accuracy:		98.17 %
Epoch 79 of 100 took 13.718s
  training loss:		0.128192
  validation loss:		0.059565
  validation accuracy:		98.17 %
Epoch 80 of 100 took 13.535s
  training loss:		0.127472
  validation loss:		0.058189
  validation accuracy:		98.23 %
Epoch 81 of 100 took 13.513s
  training loss:		0.130683
  validation loss:		0.058619
  validation accuracy:		98.23 %
Epoch 82 of 100 took 13.503s
  training loss:		0.127898
  validation loss:		0.058058
  validation accuracy:		98.20 %
Epoch 83 of 100 took 13.507s
  training loss:		0.129092
  validation loss:		0.057909
  validation accuracy:		98.23 %
Epoch 84 of 100 took 13.497s
  training loss:		0.125626
  validation loss:		0.057690
  validation accuracy:		98.25 %
Epoch 85 of 100 took 13.558s
  training loss:		0.127140
  validation loss:		0.057171
  validation accuracy:		98.27 %
Epoch 86 of 100 took 13.601s
  training loss:		0.128630
  validation loss:		0.056783
  validation accuracy:		98.25 %
Epoch 87 of 100 took 13.496s
  training loss:		0.123580
  validation loss:		0.056262
  validation accuracy:		98.28 %
Epoch 88 of 100 took 13.645s
  training loss:		0.124942
  validation loss:		0.056144
  validation accuracy:		98.33 %
Epoch 89 of 100 took 13.517s
  training loss:		0.129031
  validation loss:		0.055906
  validation accuracy:		98.30 %
Epoch 90 of 100 took 13.502s
  training loss:		0.123626
  validation loss:		0.055771
  validation accuracy:		98.35 %
Epoch 91 of 100 took 13.582s
  training loss:		0.120526
  validation loss:		0.054830
  validation accuracy:		98.30 %
Epoch 92 of 100 took 13.564s
  training loss:		0.124288
  validation loss:		0.055602
  validation accuracy:		98.27 %
Epoch 93 of 100 took 13.562s
  training loss:		0.121784
  validation loss:		0.055262
  validation accuracy:		98.30 %
Epoch 94 of 100 took 13.598s
  training loss:		0.121909
  validation loss:		0.055109
  validation accuracy:		98.28 %
Epoch 95 of 100 took 13.493s
  training loss:		0.122340
  validation loss:		0.053861
  validation accuracy:		98.33 %
Epoch 96 of 100 took 13.499s
  training loss:		0.115797
  validation loss:		0.053530
  validation accuracy:		98.30 %
Epoch 97 of 100 took 13.657s
  training loss:		0.119153
  validation loss:		0.053499
  validation accuracy:		98.40 %
Epoch 98 of 100 took 13.505s
  training loss:		0.119562
  validation loss:		0.053445
  validation accuracy:		98.38 %
Epoch 99 of 100 took 13.500s
  training loss:		0.113912
  validation loss:		0.052786
  validation accuracy:		98.40 %
Epoch 100 of 100 took 13.660s
  training loss:		0.113539
  validation loss:		0.053210
  validation accuracy:		98.42 %
Final results:
  test loss:			0.029327
  test accuracy:		99.12 %
