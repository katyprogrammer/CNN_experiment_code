loading data...
#train = 24479, #test = 5139, #valid = 6117
building model and compiling functions...
w=(32, 1, 5, 5),b=(32,)
layers other than "dense", "conv" layers, donnot have params
w=(32, 32, 5, 5),b=(32,)
layers other than "dense", "conv" layers, donnot have params
layers other than "dense", "conv" layers, donnot have params
w=(512, 256),b=(256,)
layers other than "dense", "conv" layers, donnot have params
w=(256, 10),b=(10,)
decomposing tensor W of shape (4, 512, 800)...
decomposing tensor B of shape (4, 800)...
starting training...
Epoch 1 of 100 took 13.475s
  training loss:		2.396025
  validation loss:		2.309176
  validation accuracy:		0.00 %
Epoch 2 of 100 took 13.459s
  training loss:		2.274664
  validation loss:		2.237020
  validation accuracy:		22.47 %
Epoch 3 of 100 took 13.464s
  training loss:		2.208427
  validation loss:		2.173182
  validation accuracy:		22.47 %
Epoch 4 of 100 took 13.461s
  training loss:		2.147608
  validation loss:		2.112375
  validation accuracy:		22.47 %
Epoch 5 of 100 took 13.583s
  training loss:		2.088619
  validation loss:		2.048465
  validation accuracy:		22.47 %
Epoch 6 of 100 took 13.468s
  training loss:		2.023742
  validation loss:		1.962447
  validation accuracy:		22.47 %
Epoch 7 of 100 took 13.579s
  training loss:		1.910603
  validation loss:		1.769904
  validation accuracy:		22.47 %
Epoch 8 of 100 took 13.523s
  training loss:		1.723638
  validation loss:		1.619932
  validation accuracy:		24.32 %
Epoch 9 of 100 took 13.545s
  training loss:		1.642401
  validation loss:		1.590518
  validation accuracy:		35.90 %
Epoch 10 of 100 took 13.515s
  training loss:		1.615826
  validation loss:		1.569001
  validation accuracy:		46.00 %
Epoch 11 of 100 took 13.550s
  training loss:		1.586839
  validation loss:		1.534958
  validation accuracy:		58.48 %
Epoch 12 of 100 took 13.508s
  training loss:		1.540611
  validation loss:		1.457715
  validation accuracy:		49.28 %
Epoch 13 of 100 took 13.517s
  training loss:		1.457725
  validation loss:		1.307894
  validation accuracy:		77.78 %
Epoch 14 of 100 took 13.495s
  training loss:		1.292887
  validation loss:		1.022266
  validation accuracy:		85.77 %
Epoch 15 of 100 took 13.480s
  training loss:		1.064641
  validation loss:		0.711950
  validation accuracy:		87.53 %
Epoch 16 of 100 took 13.557s
  training loss:		0.821020
  validation loss:		0.492797
  validation accuracy:		89.05 %
Epoch 17 of 100 took 13.482s
  training loss:		0.660883
  validation loss:		0.371891
  validation accuracy:		90.70 %
Epoch 18 of 100 took 13.554s
  training loss:		0.552172
  validation loss:		0.302286
  validation accuracy:		91.85 %
Epoch 19 of 100 took 13.518s
  training loss:		0.475802
  validation loss:		0.259669
  validation accuracy:		92.52 %
Epoch 20 of 100 took 13.493s
  training loss:		0.425885
  validation loss:		0.231531
  validation accuracy:		93.13 %
Epoch 21 of 100 took 13.566s
  training loss:		0.385298
  validation loss:		0.211592
  validation accuracy:		93.60 %
Epoch 22 of 100 took 13.511s
  training loss:		0.352878
  validation loss:		0.194277
  validation accuracy:		94.03 %
Epoch 23 of 100 took 13.522s
  training loss:		0.322340
  validation loss:		0.185429
  validation accuracy:		94.23 %
Epoch 24 of 100 took 13.519s
  training loss:		0.310901
  validation loss:		0.174917
  validation accuracy:		94.68 %
Epoch 25 of 100 took 13.519s
  training loss:		0.295439
  validation loss:		0.166966
  validation accuracy:		94.78 %
Epoch 26 of 100 took 13.503s
  training loss:		0.280605
  validation loss:		0.158387
  validation accuracy:		94.98 %
Epoch 27 of 100 took 13.500s
  training loss:		0.263364
  validation loss:		0.152995
  validation accuracy:		95.22 %
Epoch 28 of 100 took 13.581s
  training loss:		0.259889
  validation loss:		0.148580
  validation accuracy:		95.30 %
Epoch 29 of 100 took 13.804s
  training loss:		0.243925
  validation loss:		0.142923
  validation accuracy:		95.37 %
Epoch 30 of 100 took 13.524s
  training loss:		0.240808
  validation loss:		0.137886
  validation accuracy:		95.57 %
Epoch 31 of 100 took 13.710s
  training loss:		0.233383
  validation loss:		0.134156
  validation accuracy:		95.68 %
Epoch 32 of 100 took 13.496s
  training loss:		0.218800
  validation loss:		0.130740
  validation accuracy:		95.72 %
Epoch 33 of 100 took 13.643s
  training loss:		0.214434
  validation loss:		0.126565
  validation accuracy:		95.92 %
Epoch 34 of 100 took 13.590s
  training loss:		0.208569
  validation loss:		0.123212
  validation accuracy:		95.95 %
Epoch 35 of 100 took 13.662s
  training loss:		0.198593
  validation loss:		0.120778
  validation accuracy:		96.02 %
Epoch 36 of 100 took 13.591s
  training loss:		0.195928
  validation loss:		0.116688
  validation accuracy:		96.18 %
Epoch 37 of 100 took 13.530s
  training loss:		0.196605
  validation loss:		0.113580
  validation accuracy:		96.45 %
Epoch 38 of 100 took 13.512s
  training loss:		0.185914
  validation loss:		0.111343
  validation accuracy:		96.42 %
Epoch 39 of 100 took 13.558s
  training loss:		0.184226
  validation loss:		0.108856
  validation accuracy:		96.55 %
Epoch 40 of 100 took 13.509s
  training loss:		0.178127
  validation loss:		0.106618
  validation accuracy:		96.62 %
Epoch 41 of 100 took 13.525s
  training loss:		0.174662
  validation loss:		0.104363
  validation accuracy:		96.70 %
Epoch 42 of 100 took 13.515s
  training loss:		0.168104
  validation loss:		0.101877
  validation accuracy:		96.80 %
Epoch 43 of 100 took 13.611s
  training loss:		0.167837
  validation loss:		0.100835
  validation accuracy:		96.75 %
Epoch 44 of 100 took 13.568s
  training loss:		0.165857
  validation loss:		0.096858
  validation accuracy:		97.08 %
Epoch 45 of 100 took 13.518s
  training loss:		0.165901
  validation loss:		0.097134
  validation accuracy:		97.05 %
Epoch 46 of 100 took 13.538s
  training loss:		0.159278
  validation loss:		0.094103
  validation accuracy:		97.25 %
Epoch 47 of 100 took 13.519s
  training loss:		0.155053
  validation loss:		0.092720
  validation accuracy:		97.20 %
Epoch 48 of 100 took 13.515s
  training loss:		0.146455
  validation loss:		0.092059
  validation accuracy:		97.17 %
Epoch 49 of 100 took 13.515s
  training loss:		0.150941
  validation loss:		0.090303
  validation accuracy:		97.22 %
Epoch 50 of 100 took 13.521s
  training loss:		0.147343
  validation loss:		0.087190
  validation accuracy:		97.35 %
Epoch 51 of 100 took 13.521s
  training loss:		0.145633
  validation loss:		0.087115
  validation accuracy:		97.28 %
Epoch 52 of 100 took 13.686s
  training loss:		0.144583
  validation loss:		0.085142
  validation accuracy:		97.38 %
Epoch 53 of 100 took 13.520s
  training loss:		0.139482
  validation loss:		0.085165
  validation accuracy:		97.35 %
Epoch 54 of 100 took 13.515s
  training loss:		0.139802
  validation loss:		0.083803
  validation accuracy:		97.48 %
Epoch 55 of 100 took 13.569s
  training loss:		0.133521
  validation loss:		0.081950
  validation accuracy:		97.47 %
Epoch 56 of 100 took 13.499s
  training loss:		0.134138
  validation loss:		0.080898
  validation accuracy:		97.52 %
Epoch 57 of 100 took 13.568s
  training loss:		0.132606
  validation loss:		0.080168
  validation accuracy:		97.58 %
Epoch 58 of 100 took 13.546s
  training loss:		0.129393
  validation loss:		0.078861
  validation accuracy:		97.67 %
Epoch 59 of 100 took 13.529s
  training loss:		0.132070
  validation loss:		0.078789
  validation accuracy:		97.57 %
Epoch 60 of 100 took 13.511s
  training loss:		0.124088
  validation loss:		0.076345
  validation accuracy:		97.73 %
Epoch 61 of 100 took 13.516s
  training loss:		0.123383
  validation loss:		0.076315
  validation accuracy:		97.68 %
Epoch 62 of 100 took 13.529s
  training loss:		0.123719
  validation loss:		0.074785
  validation accuracy:		97.78 %
Epoch 63 of 100 took 13.520s
  training loss:		0.119673
  validation loss:		0.074585
  validation accuracy:		97.75 %
Epoch 64 of 100 took 13.679s
  training loss:		0.117359
  validation loss:		0.072949
  validation accuracy:		97.78 %
Epoch 65 of 100 took 13.518s
  training loss:		0.115220
  validation loss:		0.072089
  validation accuracy:		97.83 %
Epoch 66 of 100 took 13.508s
  training loss:		0.115374
  validation loss:		0.071280
  validation accuracy:		97.85 %
Epoch 67 of 100 took 13.697s
  training loss:		0.116052
  validation loss:		0.070940
  validation accuracy:		97.82 %
Epoch 68 of 100 took 13.499s
  training loss:		0.113207
  validation loss:		0.070528
  validation accuracy:		97.83 %
Epoch 69 of 100 took 13.640s
  training loss:		0.109035
  validation loss:		0.069439
  validation accuracy:		97.88 %
Epoch 70 of 100 took 13.511s
  training loss:		0.109965
  validation loss:		0.068838
  validation accuracy:		97.88 %
Epoch 71 of 100 took 13.668s
  training loss:		0.109231
  validation loss:		0.068604
  validation accuracy:		97.92 %
Epoch 72 of 100 took 13.539s
  training loss:		0.107896
  validation loss:		0.067081
  validation accuracy:		97.92 %
Epoch 73 of 100 took 13.647s
  training loss:		0.105022
  validation loss:		0.066702
  validation accuracy:		97.97 %
Epoch 74 of 100 took 13.537s
  training loss:		0.107266
  validation loss:		0.065713
  validation accuracy:		98.02 %
Epoch 75 of 100 took 13.527s
  training loss:		0.109169
  validation loss:		0.065798
  validation accuracy:		97.93 %
Epoch 76 of 100 took 13.516s
  training loss:		0.106274
  validation loss:		0.065376
  validation accuracy:		98.00 %
Epoch 77 of 100 took 13.529s
  training loss:		0.106129
  validation loss:		0.064264
  validation accuracy:		98.00 %
Epoch 78 of 100 took 13.502s
  training loss:		0.104023
  validation loss:		0.063428
  validation accuracy:		98.03 %
Epoch 79 of 100 took 13.570s
  training loss:		0.105332
  validation loss:		0.063502
  validation accuracy:		97.98 %
Epoch 80 of 100 took 13.501s
  training loss:		0.102367
  validation loss:		0.063096
  validation accuracy:		97.95 %
Epoch 81 of 100 took 13.519s
  training loss:		0.099011
  validation loss:		0.061622
  validation accuracy:		98.08 %
Epoch 82 of 100 took 13.523s
  training loss:		0.100630
  validation loss:		0.062120
  validation accuracy:		98.02 %
Epoch 83 of 100 took 13.509s
  training loss:		0.097742
  validation loss:		0.061819
  validation accuracy:		98.03 %
Epoch 84 of 100 took 13.514s
  training loss:		0.095503
  validation loss:		0.060881
  validation accuracy:		98.05 %
Epoch 85 of 100 took 13.514s
  training loss:		0.098088
  validation loss:		0.060359
  validation accuracy:		98.07 %
Epoch 86 of 100 took 13.520s
  training loss:		0.097876
  validation loss:		0.060585
  validation accuracy:		98.08 %
Epoch 87 of 100 took 13.680s
  training loss:		0.092306
  validation loss:		0.059995
  validation accuracy:		98.07 %
Epoch 88 of 100 took 13.515s
  training loss:		0.092817
  validation loss:		0.058436
  validation accuracy:		98.15 %
Epoch 89 of 100 took 13.504s
  training loss:		0.095422
  validation loss:		0.058890
  validation accuracy:		98.18 %
Epoch 90 of 100 took 13.538s
  training loss:		0.093697
  validation loss:		0.057778
  validation accuracy:		98.25 %
Epoch 91 of 100 took 13.515s
  training loss:		0.093075
  validation loss:		0.057904
  validation accuracy:		98.12 %
Epoch 92 of 100 took 13.519s
  training loss:		0.093288
  validation loss:		0.058751
  validation accuracy:		98.10 %
Epoch 93 of 100 took 13.517s
  training loss:		0.090184
  validation loss:		0.057047
  validation accuracy:		98.20 %
Epoch 94 of 100 took 13.508s
  training loss:		0.088097
  validation loss:		0.056729
  validation accuracy:		98.25 %
Epoch 95 of 100 took 13.576s
  training loss:		0.092640
  validation loss:		0.056662
  validation accuracy:		98.22 %
Epoch 96 of 100 took 13.577s
  training loss:		0.091647
  validation loss:		0.055759
  validation accuracy:		98.30 %
Epoch 97 of 100 took 13.520s
  training loss:		0.086519
  validation loss:		0.056591
  validation accuracy:		98.22 %
Epoch 98 of 100 took 13.541s
  training loss:		0.086820
  validation loss:		0.055136
  validation accuracy:		98.32 %
Epoch 99 of 100 took 13.653s
  training loss:		0.091073
  validation loss:		0.055310
  validation accuracy:		98.25 %
Epoch 100 of 100 took 13.519s
  training loss:		0.086478
  validation loss:		0.054892
  validation accuracy:		98.30 %
Final results:
  test loss:			0.032534
  test accuracy:		98.90 %
