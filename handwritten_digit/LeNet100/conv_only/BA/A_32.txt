loading data...
#train = 24479, #test = 5139, #valid = 6117
building model and compiling functions...
w=(32, 1, 5, 5),b=(32,)
w=(32, 32, 5, 5),b=(32,)
decomposing tensor W of shape (2, 32, 800)...
decomposing tensor B of shape (2, 800)...
starting training...
Epoch 1 of 100 took 13.349s
  training loss:		1.604621
  validation loss:		0.503274
  validation accuracy:		94.08 %
Epoch 2 of 100 took 13.429s
  training loss:		0.623859
  validation loss:		0.202341
  validation accuracy:		95.72 %
Epoch 3 of 100 took 13.395s
  training loss:		0.393540
  validation loss:		0.142771
  validation accuracy:		96.32 %
Epoch 4 of 100 took 13.463s
  training loss:		0.310673
  validation loss:		0.120526
  validation accuracy:		96.65 %
Epoch 5 of 100 took 13.491s
  training loss:		0.261867
  validation loss:		0.108449
  validation accuracy:		96.83 %
Epoch 6 of 100 took 13.490s
  training loss:		0.237474
  validation loss:		0.100237
  validation accuracy:		97.15 %
Epoch 7 of 100 took 13.384s
  training loss:		0.219068
  validation loss:		0.094485
  validation accuracy:		97.37 %
Epoch 8 of 100 took 13.375s
  training loss:		0.195294
  validation loss:		0.089167
  validation accuracy:		97.42 %
Epoch 9 of 100 took 13.414s
  training loss:		0.191793
  validation loss:		0.085671
  validation accuracy:		97.53 %
Epoch 10 of 100 took 13.432s
  training loss:		0.176695
  validation loss:		0.082160
  validation accuracy:		97.57 %
Epoch 11 of 100 took 13.608s
  training loss:		0.167508
  validation loss:		0.079685
  validation accuracy:		97.65 %
Epoch 12 of 100 took 13.997s
  training loss:		0.164087
  validation loss:		0.077268
  validation accuracy:		97.67 %
Epoch 13 of 100 took 15.131s
  training loss:		0.153871
  validation loss:		0.075731
  validation accuracy:		97.78 %
Epoch 14 of 100 took 15.046s
  training loss:		0.148475
  validation loss:		0.073644
  validation accuracy:		97.80 %
Epoch 15 of 100 took 15.449s
  training loss:		0.145374
  validation loss:		0.071599
  validation accuracy:		97.80 %
Epoch 16 of 100 took 16.496s
  training loss:		0.134649
  validation loss:		0.069686
  validation accuracy:		97.87 %
Epoch 17 of 100 took 15.153s
  training loss:		0.138011
  validation loss:		0.068493
  validation accuracy:		97.87 %
Epoch 18 of 100 took 14.084s
  training loss:		0.134810
  validation loss:		0.067478
  validation accuracy:		97.87 %
Epoch 19 of 100 took 13.960s
  training loss:		0.129673
  validation loss:		0.066545
  validation accuracy:		98.03 %
Epoch 20 of 100 took 13.931s
  training loss:		0.125781
  validation loss:		0.065003
  validation accuracy:		97.98 %
Epoch 21 of 100 took 13.729s
  training loss:		0.118502
  validation loss:		0.063824
  validation accuracy:		98.05 %
Epoch 22 of 100 took 14.838s
  training loss:		0.121530
  validation loss:		0.062780
  validation accuracy:		98.13 %
Epoch 23 of 100 took 14.908s
  training loss:		0.119174
  validation loss:		0.062249
  validation accuracy:		98.08 %
Epoch 24 of 100 took 14.016s
  training loss:		0.114974
  validation loss:		0.061447
  validation accuracy:		98.17 %
Epoch 25 of 100 took 13.665s
  training loss:		0.110583
  validation loss:		0.060207
  validation accuracy:		98.20 %
Epoch 26 of 100 took 13.970s
  training loss:		0.113436
  validation loss:		0.059427
  validation accuracy:		98.23 %
Epoch 27 of 100 took 13.808s
  training loss:		0.106319
  validation loss:		0.058881
  validation accuracy:		98.23 %
Epoch 28 of 100 took 13.745s
  training loss:		0.103558
  validation loss:		0.058433
  validation accuracy:		98.25 %
Epoch 29 of 100 took 15.870s
  training loss:		0.105435
  validation loss:		0.057653
  validation accuracy:		98.30 %
Epoch 30 of 100 took 15.106s
  training loss:		0.106280
  validation loss:		0.056909
  validation accuracy:		98.37 %
Epoch 31 of 100 took 14.564s
  training loss:		0.100119
  validation loss:		0.056342
  validation accuracy:		98.30 %
Epoch 32 of 100 took 14.414s
  training loss:		0.100345
  validation loss:		0.056041
  validation accuracy:		98.32 %
Epoch 33 of 100 took 14.305s
  training loss:		0.099178
  validation loss:		0.055433
  validation accuracy:		98.32 %
Epoch 34 of 100 took 14.202s
  training loss:		0.098787
  validation loss:		0.054655
  validation accuracy:		98.33 %
Epoch 35 of 100 took 14.711s
  training loss:		0.101784
  validation loss:		0.053957
  validation accuracy:		98.37 %
Epoch 36 of 100 took 14.535s
  training loss:		0.096555
  validation loss:		0.052875
  validation accuracy:		98.42 %
Epoch 37 of 100 took 15.880s
  training loss:		0.094615
  validation loss:		0.053170
  validation accuracy:		98.40 %
Epoch 38 of 100 took 14.645s
  training loss:		0.096034
  validation loss:		0.052770
  validation accuracy:		98.42 %
Epoch 39 of 100 took 15.156s
  training loss:		0.093328
  validation loss:		0.051950
  validation accuracy:		98.47 %
Epoch 40 of 100 took 14.582s
  training loss:		0.091358
  validation loss:		0.051495
  validation accuracy:		98.45 %
Epoch 41 of 100 took 14.566s
  training loss:		0.089883
  validation loss:		0.051445
  validation accuracy:		98.43 %
Epoch 42 of 100 took 14.823s
  training loss:		0.089727
  validation loss:		0.050704
  validation accuracy:		98.48 %
Epoch 43 of 100 took 14.141s
  training loss:		0.090339
  validation loss:		0.050453
  validation accuracy:		98.45 %
Epoch 44 of 100 took 14.899s
  training loss:		0.091060
  validation loss:		0.049945
  validation accuracy:		98.50 %
Epoch 45 of 100 took 14.779s
  training loss:		0.088762
  validation loss:		0.049240
  validation accuracy:		98.52 %
Epoch 46 of 100 took 14.967s
  training loss:		0.085051
  validation loss:		0.048824
  validation accuracy:		98.52 %
Epoch 47 of 100 took 15.278s
  training loss:		0.084429
  validation loss:		0.048609
  validation accuracy:		98.50 %
Epoch 48 of 100 took 16.080s
  training loss:		0.084937
  validation loss:		0.048193
  validation accuracy:		98.53 %
Epoch 49 of 100 took 15.096s
  training loss:		0.084038
  validation loss:		0.047849
  validation accuracy:		98.55 %
Epoch 50 of 100 took 15.377s
  training loss:		0.083513
  validation loss:		0.047275
  validation accuracy:		98.52 %
Epoch 51 of 100 took 16.112s
  training loss:		0.083655
  validation loss:		0.046797
  validation accuracy:		98.53 %
Epoch 52 of 100 took 16.664s
  training loss:		0.079540
  validation loss:		0.046614
  validation accuracy:		98.53 %
Epoch 53 of 100 took 15.951s
  training loss:		0.082563
  validation loss:		0.046704
  validation accuracy:		98.55 %
Epoch 54 of 100 took 17.130s
  training loss:		0.080538
  validation loss:		0.046383
  validation accuracy:		98.52 %
Epoch 55 of 100 took 16.339s
  training loss:		0.078861
  validation loss:		0.045983
  validation accuracy:		98.53 %
Epoch 56 of 100 took 15.062s
  training loss:		0.079528
  validation loss:		0.045472
  validation accuracy:		98.55 %
Epoch 57 of 100 took 14.873s
  training loss:		0.077408
  validation loss:		0.045484
  validation accuracy:		98.55 %
Epoch 58 of 100 took 14.471s
  training loss:		0.074324
  validation loss:		0.045611
  validation accuracy:		98.55 %
Epoch 59 of 100 took 14.648s
  training loss:		0.076952
  validation loss:		0.044697
  validation accuracy:		98.58 %
Epoch 60 of 100 took 14.566s
  training loss:		0.078744
  validation loss:		0.044272
  validation accuracy:		98.60 %
Epoch 61 of 100 took 15.900s
  training loss:		0.075722
  validation loss:		0.044258
  validation accuracy:		98.58 %
Epoch 62 of 100 took 15.940s
  training loss:		0.073915
  validation loss:		0.043861
  validation accuracy:		98.60 %
Epoch 63 of 100 took 14.699s
  training loss:		0.075229
  validation loss:		0.043030
  validation accuracy:		98.63 %
Epoch 64 of 100 took 14.350s
  training loss:		0.074764
  validation loss:		0.043147
  validation accuracy:		98.63 %
Epoch 65 of 100 took 14.113s
  training loss:		0.073075
  validation loss:		0.043387
  validation accuracy:		98.62 %
Epoch 66 of 100 took 14.266s
  training loss:		0.071035
  validation loss:		0.043058
  validation accuracy:		98.65 %
Epoch 67 of 100 took 19.409s
  training loss:		0.074115
  validation loss:		0.042663
  validation accuracy:		98.63 %
Epoch 68 of 100 took 14.209s
  training loss:		0.070594
  validation loss:		0.042122
  validation accuracy:		98.67 %
Epoch 69 of 100 took 13.713s
  training loss:		0.069810
  validation loss:		0.042139
  validation accuracy:		98.65 %
Epoch 70 of 100 took 14.341s
  training loss:		0.071905
  validation loss:		0.042825
  validation accuracy:		98.65 %
Epoch 71 of 100 took 15.680s
  training loss:		0.073823
  validation loss:		0.041687
  validation accuracy:		98.70 %
Epoch 72 of 100 took 15.698s
  training loss:		0.071951
  validation loss:		0.042200
  validation accuracy:		98.70 %
Epoch 73 of 100 took 16.576s
  training loss:		0.069815
  validation loss:		0.041554
  validation accuracy:		98.70 %
Epoch 74 of 100 took 15.553s
  training loss:		0.068251
  validation loss:		0.041667
  validation accuracy:		98.70 %
Epoch 75 of 100 took 15.555s
  training loss:		0.071148
  validation loss:		0.040991
  validation accuracy:		98.73 %
Epoch 76 of 100 took 15.172s
  training loss:		0.070867
  validation loss:		0.040899
  validation accuracy:		98.73 %
Epoch 77 of 100 took 15.459s
  training loss:		0.069709
  validation loss:		0.040481
  validation accuracy:		98.70 %
Epoch 78 of 100 took 14.151s
  training loss:		0.068584
  validation loss:		0.040458
  validation accuracy:		98.72 %
Epoch 79 of 100 took 13.867s
  training loss:		0.071319
  validation loss:		0.040229
  validation accuracy:		98.72 %
Epoch 80 of 100 took 14.437s
  training loss:		0.069282
  validation loss:		0.040247
  validation accuracy:		98.72 %
Epoch 81 of 100 took 14.402s
  training loss:		0.064663
  validation loss:		0.039963
  validation accuracy:		98.73 %
Epoch 82 of 100 took 15.222s
  training loss:		0.066119
  validation loss:		0.039947
  validation accuracy:		98.72 %
Epoch 83 of 100 took 13.518s
  training loss:		0.063728
  validation loss:		0.039694
  validation accuracy:		98.75 %
Epoch 84 of 100 took 13.471s
  training loss:		0.064189
  validation loss:		0.039609
  validation accuracy:		98.75 %
Epoch 85 of 100 took 13.580s
  training loss:		0.065545
  validation loss:		0.039224
  validation accuracy:		98.80 %
Epoch 86 of 100 took 14.085s
  training loss:		0.065155
  validation loss:		0.039281
  validation accuracy:		98.73 %
Epoch 87 of 100 took 14.688s
  training loss:		0.062780
  validation loss:		0.038937
  validation accuracy:		98.73 %
Epoch 88 of 100 took 15.140s
  training loss:		0.063137
  validation loss:		0.038921
  validation accuracy:		98.75 %
Epoch 89 of 100 took 15.045s
  training loss:		0.065013
  validation loss:		0.039178
  validation accuracy:		98.75 %
Epoch 90 of 100 took 15.054s
  training loss:		0.061953
  validation loss:		0.038314
  validation accuracy:		98.78 %
Epoch 91 of 100 took 14.968s
  training loss:		0.063424
  validation loss:		0.038550
  validation accuracy:		98.75 %
Epoch 92 of 100 took 15.295s
  training loss:		0.062656
  validation loss:		0.038057
  validation accuracy:		98.78 %
Epoch 93 of 100 took 15.041s
  training loss:		0.060630
  validation loss:		0.038047
  validation accuracy:		98.80 %
Epoch 94 of 100 took 15.096s
  training loss:		0.061739
  validation loss:		0.037562
  validation accuracy:		98.83 %
Epoch 95 of 100 took 15.108s
  training loss:		0.063447
  validation loss:		0.037592
  validation accuracy:		98.82 %
Epoch 96 of 100 took 15.131s
  training loss:		0.062488
  validation loss:		0.037465
  validation accuracy:		98.83 %
Epoch 97 of 100 took 15.403s
  training loss:		0.061489
  validation loss:		0.037264
  validation accuracy:		98.82 %
Epoch 98 of 100 took 14.845s
  training loss:		0.060821
  validation loss:		0.037700
  validation accuracy:		98.80 %
Epoch 99 of 100 took 16.272s
  training loss:		0.062436
  validation loss:		0.037157
  validation accuracy:		98.83 %
Epoch 100 of 100 took 16.671s
  training loss:		0.061006
  validation loss:		0.036791
  validation accuracy:		98.87 %
Final results:
  test loss:			0.017389
  test accuracy:		99.38 %
