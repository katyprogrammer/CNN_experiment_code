loading data...
#train = 23525, #test = 4861, #valid = 5879
building model and compiling functions...
w=(32, 1, 5, 5),b=(32,)
w=(32, 32, 5, 5),b=(32,)
decomposing tensor W of shape (2, 32, 800)...
decomposing tensor B of shape (2, 800)...
starting training...
Epoch 1 of 100 took 13.051s
  training loss:		2.235252
  validation loss:		2.061580
  validation accuracy:		22.78 %
Epoch 2 of 100 took 13.036s
  training loss:		1.934340
  validation loss:		1.702702
  validation accuracy:		14.73 %
Epoch 3 of 100 took 13.182s
  training loss:		1.798719
  validation loss:		1.676645
  validation accuracy:		18.95 %
Epoch 4 of 100 took 14.524s
  training loss:		1.741930
  validation loss:		1.651539
  validation accuracy:		21.27 %
Epoch 5 of 100 took 15.346s
  training loss:		1.716741
  validation loss:		1.633222
  validation accuracy:		21.27 %
Epoch 6 of 100 took 13.929s
  training loss:		1.693792
  validation loss:		1.617233
  validation accuracy:		21.29 %
Epoch 7 of 100 took 14.222s
  training loss:		1.666823
  validation loss:		1.588761
  validation accuracy:		25.15 %
Epoch 8 of 100 took 13.663s
  training loss:		1.634332
  validation loss:		1.542544
  validation accuracy:		53.45 %
Epoch 9 of 100 took 13.353s
  training loss:		1.575452
  validation loss:		1.458127
  validation accuracy:		64.53 %
Epoch 10 of 100 took 13.040s
  training loss:		1.488243
  validation loss:		1.301628
  validation accuracy:		75.35 %
Epoch 11 of 100 took 12.956s
  training loss:		1.332199
  validation loss:		1.073687
  validation accuracy:		79.47 %
Epoch 12 of 100 took 12.941s
  training loss:		1.136050
  validation loss:		0.843218
  validation accuracy:		82.93 %
Epoch 13 of 100 took 12.955s
  training loss:		0.963110
  validation loss:		0.670709
  validation accuracy:		85.11 %
Epoch 14 of 100 took 12.939s
  training loss:		0.819241
  validation loss:		0.544396
  validation accuracy:		87.67 %
Epoch 15 of 100 took 13.048s
  training loss:		0.722636
  validation loss:		0.459001
  validation accuracy:		89.13 %
Epoch 16 of 100 took 13.002s
  training loss:		0.635299
  validation loss:		0.392909
  validation accuracy:		90.36 %
Epoch 17 of 100 took 12.980s
  training loss:		0.574535
  validation loss:		0.339407
  validation accuracy:		91.36 %
Epoch 18 of 100 took 12.959s
  training loss:		0.527173
  validation loss:		0.308134
  validation accuracy:		91.87 %
Epoch 19 of 100 took 13.025s
  training loss:		0.492850
  validation loss:		0.283172
  validation accuracy:		92.25 %
Epoch 20 of 100 took 13.032s
  training loss:		0.446510
  validation loss:		0.256934
  validation accuracy:		92.85 %
Epoch 21 of 100 took 12.956s
  training loss:		0.415567
  validation loss:		0.233985
  validation accuracy:		93.44 %
Epoch 22 of 100 took 13.047s
  training loss:		0.398937
  validation loss:		0.225290
  validation accuracy:		93.58 %
Epoch 23 of 100 took 13.047s
  training loss:		0.384530
  validation loss:		0.209852
  validation accuracy:		93.93 %
Epoch 24 of 100 took 12.991s
  training loss:		0.360678
  validation loss:		0.200424
  validation accuracy:		94.00 %
Epoch 25 of 100 took 12.969s
  training loss:		0.351972
  validation loss:		0.191002
  validation accuracy:		94.25 %
Epoch 26 of 100 took 13.039s
  training loss:		0.335219
  validation loss:		0.185030
  validation accuracy:		94.38 %
Epoch 27 of 100 took 12.981s
  training loss:		0.325100
  validation loss:		0.175871
  validation accuracy:		94.56 %
Epoch 28 of 100 took 12.984s
  training loss:		0.312410
  validation loss:		0.167587
  validation accuracy:		94.75 %
Epoch 29 of 100 took 12.994s
  training loss:		0.301312
  validation loss:		0.166473
  validation accuracy:		94.73 %
Epoch 30 of 100 took 13.003s
  training loss:		0.298444
  validation loss:		0.160248
  validation accuracy:		94.89 %
Epoch 31 of 100 took 13.163s
  training loss:		0.288064
  validation loss:		0.155627
  validation accuracy:		95.04 %
Epoch 32 of 100 took 12.983s
  training loss:		0.280666
  validation loss:		0.155715
  validation accuracy:		94.98 %
Epoch 33 of 100 took 13.193s
  training loss:		0.273106
  validation loss:		0.148858
  validation accuracy:		95.18 %
Epoch 34 of 100 took 14.520s
  training loss:		0.267860
  validation loss:		0.143895
  validation accuracy:		95.35 %
Epoch 35 of 100 took 13.129s
  training loss:		0.270231
  validation loss:		0.140268
  validation accuracy:		95.45 %
Epoch 36 of 100 took 13.271s
  training loss:		0.256266
  validation loss:		0.138167
  validation accuracy:		95.45 %
Epoch 37 of 100 took 13.133s
  training loss:		0.255845
  validation loss:		0.135488
  validation accuracy:		95.56 %
Epoch 38 of 100 took 13.160s
  training loss:		0.249203
  validation loss:		0.132261
  validation accuracy:		95.73 %
Epoch 39 of 100 took 13.166s
  training loss:		0.243398
  validation loss:		0.127508
  validation accuracy:		95.85 %
Epoch 40 of 100 took 13.286s
  training loss:		0.238522
  validation loss:		0.126488
  validation accuracy:		95.91 %
Epoch 41 of 100 took 13.116s
  training loss:		0.240828
  validation loss:		0.127087
  validation accuracy:		95.87 %
Epoch 42 of 100 took 13.447s
  training loss:		0.229075
  validation loss:		0.122364
  validation accuracy:		96.07 %
Epoch 43 of 100 took 13.605s
  training loss:		0.232704
  validation loss:		0.119125
  validation accuracy:		96.04 %
Epoch 44 of 100 took 15.352s
  training loss:		0.222271
  validation loss:		0.117956
  validation accuracy:		96.05 %
Epoch 45 of 100 took 15.558s
  training loss:		0.222077
  validation loss:		0.118544
  validation accuracy:		96.00 %
Epoch 46 of 100 took 14.546s
  training loss:		0.214711
  validation loss:		0.115185
  validation accuracy:		96.09 %
Epoch 47 of 100 took 14.969s
  training loss:		0.213439
  validation loss:		0.114093
  validation accuracy:		96.20 %
Epoch 48 of 100 took 14.460s
  training loss:		0.210167
  validation loss:		0.110967
  validation accuracy:		96.25 %
Epoch 49 of 100 took 13.123s
  training loss:		0.211619
  validation loss:		0.112864
  validation accuracy:		96.24 %
Epoch 50 of 100 took 13.103s
  training loss:		0.204856
  validation loss:		0.107787
  validation accuracy:		96.31 %
Epoch 51 of 100 took 13.077s
  training loss:		0.205729
  validation loss:		0.105834
  validation accuracy:		96.45 %
Epoch 52 of 100 took 13.088s
  training loss:		0.202882
  validation loss:		0.104839
  validation accuracy:		96.51 %
Epoch 53 of 100 took 12.982s
  training loss:		0.198966
  validation loss:		0.103134
  validation accuracy:		96.55 %
Epoch 54 of 100 took 13.131s
  training loss:		0.199010
  validation loss:		0.101570
  validation accuracy:		96.55 %
Epoch 55 of 100 took 13.009s
  training loss:		0.192163
  validation loss:		0.099529
  validation accuracy:		96.67 %
Epoch 56 of 100 took 14.323s
  training loss:		0.189549
  validation loss:		0.100189
  validation accuracy:		96.51 %
Epoch 57 of 100 took 14.824s
  training loss:		0.190052
  validation loss:		0.097805
  validation accuracy:		96.69 %
Epoch 58 of 100 took 14.053s
  training loss:		0.185119
  validation loss:		0.097596
  validation accuracy:		96.62 %
Epoch 59 of 100 took 13.986s
  training loss:		0.185734
  validation loss:		0.095824
  validation accuracy:		96.76 %
Epoch 60 of 100 took 14.691s
  training loss:		0.187726
  validation loss:		0.095643
  validation accuracy:		96.73 %
Epoch 61 of 100 took 13.211s
  training loss:		0.184801
  validation loss:		0.092716
  validation accuracy:		96.84 %
Epoch 62 of 100 took 13.574s
  training loss:		0.177585
  validation loss:		0.093428
  validation accuracy:		96.76 %
Epoch 63 of 100 took 15.915s
  training loss:		0.175606
  validation loss:		0.091094
  validation accuracy:		96.87 %
Epoch 64 of 100 took 14.840s
  training loss:		0.175072
  validation loss:		0.091048
  validation accuracy:		96.85 %
Epoch 65 of 100 took 15.017s
  training loss:		0.176757
  validation loss:		0.090091
  validation accuracy:		96.87 %
Epoch 66 of 100 took 13.410s
  training loss:		0.172813
  validation loss:		0.088773
  validation accuracy:		96.98 %
Epoch 67 of 100 took 14.212s
  training loss:		0.170641
  validation loss:		0.090007
  validation accuracy:		96.84 %
Epoch 68 of 100 took 16.087s
  training loss:		0.170190
  validation loss:		0.086064
  validation accuracy:		97.02 %
Epoch 69 of 100 took 15.306s
  training loss:		0.169905
  validation loss:		0.085532
  validation accuracy:		97.04 %
Epoch 70 of 100 took 15.046s
  training loss:		0.168226
  validation loss:		0.084916
  validation accuracy:		97.15 %
Epoch 71 of 100 took 15.173s
  training loss:		0.167901
  validation loss:		0.084741
  validation accuracy:		97.16 %
Epoch 72 of 100 took 14.038s
  training loss:		0.163105
  validation loss:		0.085113
  validation accuracy:		97.22 %
Epoch 73 of 100 took 13.107s
  training loss:		0.163739
  validation loss:		0.085354
  validation accuracy:		97.11 %
Epoch 74 of 100 took 13.125s
  training loss:		0.164099
  validation loss:		0.082022
  validation accuracy:		97.35 %
Epoch 75 of 100 took 13.325s
  training loss:		0.164540
  validation loss:		0.081442
  validation accuracy:		97.29 %
Epoch 76 of 100 took 13.312s
  training loss:		0.161886
  validation loss:		0.079847
  validation accuracy:		97.44 %
Epoch 77 of 100 took 13.173s
  training loss:		0.155740
  validation loss:		0.079183
  validation accuracy:		97.35 %
Epoch 78 of 100 took 13.329s
  training loss:		0.160381
  validation loss:		0.078956
  validation accuracy:		97.40 %
Epoch 79 of 100 took 13.325s
  training loss:		0.158606
  validation loss:		0.079501
  validation accuracy:		97.44 %
Epoch 80 of 100 took 14.657s
  training loss:		0.155623
  validation loss:		0.078013
  validation accuracy:		97.49 %
Epoch 81 of 100 took 15.522s
  training loss:		0.151565
  validation loss:		0.078622
  validation accuracy:		97.47 %
Epoch 82 of 100 took 13.460s
  training loss:		0.156405
  validation loss:		0.077232
  validation accuracy:		97.51 %
Epoch 83 of 100 took 13.882s
  training loss:		0.148311
  validation loss:		0.075592
  validation accuracy:		97.55 %
Epoch 84 of 100 took 13.850s
  training loss:		0.150301
  validation loss:		0.075621
  validation accuracy:		97.42 %
Epoch 85 of 100 took 14.918s
  training loss:		0.149434
  validation loss:		0.075143
  validation accuracy:		97.56 %
Epoch 86 of 100 took 14.618s
  training loss:		0.149145
  validation loss:		0.075041
  validation accuracy:		97.47 %
Epoch 87 of 100 took 14.218s
  training loss:		0.147761
  validation loss:		0.075165
  validation accuracy:		97.42 %
Epoch 88 of 100 took 13.455s
  training loss:		0.144964
  validation loss:		0.072998
  validation accuracy:		97.60 %
Epoch 89 of 100 took 13.655s
  training loss:		0.147104
  validation loss:		0.072578
  validation accuracy:		97.55 %
Epoch 90 of 100 took 13.309s
  training loss:		0.146672
  validation loss:		0.072451
  validation accuracy:		97.65 %
Epoch 91 of 100 took 13.290s
  training loss:		0.141059
  validation loss:		0.070800
  validation accuracy:		97.71 %
Epoch 92 of 100 took 13.193s
  training loss:		0.144488
  validation loss:		0.071668
  validation accuracy:		97.64 %
Epoch 93 of 100 took 13.323s
  training loss:		0.141092
  validation loss:		0.071044
  validation accuracy:		97.64 %
Epoch 94 of 100 took 13.313s
  training loss:		0.142990
  validation loss:		0.070451
  validation accuracy:		97.64 %
Epoch 95 of 100 took 13.281s
  training loss:		0.141535
  validation loss:		0.069925
  validation accuracy:		97.67 %
Epoch 96 of 100 took 13.389s
  training loss:		0.142008
  validation loss:		0.069269
  validation accuracy:		97.71 %
Epoch 97 of 100 took 13.941s
  training loss:		0.138347
  validation loss:		0.069657
  validation accuracy:		97.60 %
Epoch 98 of 100 took 13.424s
  training loss:		0.143042
  validation loss:		0.067157
  validation accuracy:		97.76 %
Epoch 99 of 100 took 13.391s
  training loss:		0.135096
  validation loss:		0.067902
  validation accuracy:		97.76 %
Epoch 100 of 100 took 13.770s
  training loss:		0.136523
  validation loss:		0.067705
  validation accuracy:		97.76 %
Final results:
  test loss:			0.064844
  test accuracy:		97.78 %
