loading data...
#train = 23525, #test = 4861, #valid = 5879
building model and compiling functions...
w=(32, 1, 5, 5),b=(32,)
w=(32, 32, 5, 5),b=(32,)
decomposing tensor W of shape (2, 32, 800)...
decomposing tensor B of shape (2, 800)...
starting training...
Epoch 1 of 100 took 12.952s
  training loss:		1.740439
  validation loss:		0.891868
  validation accuracy:		82.22 %
Epoch 2 of 100 took 12.939s
  training loss:		1.003599
  validation loss:		0.534261
  validation accuracy:		88.58 %
Epoch 3 of 100 took 12.942s
  training loss:		0.743258
  validation loss:		0.382853
  validation accuracy:		90.73 %
Epoch 4 of 100 took 12.946s
  training loss:		0.611477
  validation loss:		0.307686
  validation accuracy:		92.22 %
Epoch 5 of 100 took 12.940s
  training loss:		0.528535
  validation loss:		0.265694
  validation accuracy:		92.93 %
Epoch 6 of 100 took 12.932s
  training loss:		0.474372
  validation loss:		0.227391
  validation accuracy:		93.78 %
Epoch 7 of 100 took 12.935s
  training loss:		0.420684
  validation loss:		0.203956
  validation accuracy:		94.29 %
Epoch 8 of 100 took 12.936s
  training loss:		0.393827
  validation loss:		0.187157
  validation accuracy:		94.64 %
Epoch 9 of 100 took 12.934s
  training loss:		0.369896
  validation loss:		0.176876
  validation accuracy:		94.96 %
Epoch 10 of 100 took 12.935s
  training loss:		0.344593
  validation loss:		0.163884
  validation accuracy:		95.24 %
Epoch 11 of 100 took 12.936s
  training loss:		0.325304
  validation loss:		0.155900
  validation accuracy:		95.35 %
Epoch 12 of 100 took 12.946s
  training loss:		0.318538
  validation loss:		0.149426
  validation accuracy:		95.67 %
Epoch 13 of 100 took 12.934s
  training loss:		0.299192
  validation loss:		0.141982
  validation accuracy:		95.82 %
Epoch 14 of 100 took 12.939s
  training loss:		0.287514
  validation loss:		0.137413
  validation accuracy:		95.84 %
Epoch 15 of 100 took 12.933s
  training loss:		0.281130
  validation loss:		0.132098
  validation accuracy:		96.07 %
Epoch 16 of 100 took 12.937s
  training loss:		0.267285
  validation loss:		0.127861
  validation accuracy:		96.15 %
Epoch 17 of 100 took 12.934s
  training loss:		0.255883
  validation loss:		0.126597
  validation accuracy:		96.09 %
Epoch 18 of 100 took 12.937s
  training loss:		0.255379
  validation loss:		0.122912
  validation accuracy:		96.33 %
Epoch 19 of 100 took 12.939s
  training loss:		0.245038
  validation loss:		0.118090
  validation accuracy:		96.45 %
Epoch 20 of 100 took 12.936s
  training loss:		0.243884
  validation loss:		0.115674
  validation accuracy:		96.55 %
Epoch 21 of 100 took 13.028s
  training loss:		0.231102
  validation loss:		0.112432
  validation accuracy:		96.55 %
Epoch 22 of 100 took 14.643s
  training loss:		0.228710
  validation loss:		0.111480
  validation accuracy:		96.53 %
Epoch 23 of 100 took 13.085s
  training loss:		0.224449
  validation loss:		0.106473
  validation accuracy:		96.82 %
Epoch 24 of 100 took 13.079s
  training loss:		0.215559
  validation loss:		0.105144
  validation accuracy:		96.80 %
Epoch 25 of 100 took 13.084s
  training loss:		0.218528
  validation loss:		0.103282
  validation accuracy:		96.85 %
Epoch 26 of 100 took 13.088s
  training loss:		0.211154
  validation loss:		0.102672
  validation accuracy:		96.85 %
Epoch 27 of 100 took 13.066s
  training loss:		0.209172
  validation loss:		0.099468
  validation accuracy:		96.96 %
Epoch 28 of 100 took 13.078s
  training loss:		0.201183
  validation loss:		0.097723
  validation accuracy:		96.96 %
Epoch 29 of 100 took 13.084s
  training loss:		0.202683
  validation loss:		0.096649
  validation accuracy:		97.05 %
Epoch 30 of 100 took 13.082s
  training loss:		0.197113
  validation loss:		0.095555
  validation accuracy:		97.13 %
Epoch 31 of 100 took 13.098s
  training loss:		0.196446
  validation loss:		0.093043
  validation accuracy:		97.15 %
Epoch 32 of 100 took 13.088s
  training loss:		0.191868
  validation loss:		0.091480
  validation accuracy:		97.20 %
Epoch 33 of 100 took 13.138s
  training loss:		0.189347
  validation loss:		0.089959
  validation accuracy:		97.27 %
Epoch 34 of 100 took 13.105s
  training loss:		0.187839
  validation loss:		0.087869
  validation accuracy:		97.31 %
Epoch 35 of 100 took 13.091s
  training loss:		0.180214
  validation loss:		0.086375
  validation accuracy:		97.31 %
Epoch 36 of 100 took 13.079s
  training loss:		0.182315
  validation loss:		0.085232
  validation accuracy:		97.45 %
Epoch 37 of 100 took 13.088s
  training loss:		0.176824
  validation loss:		0.084636
  validation accuracy:		97.42 %
Epoch 38 of 100 took 13.082s
  training loss:		0.176759
  validation loss:		0.085326
  validation accuracy:		97.44 %
Epoch 39 of 100 took 13.072s
  training loss:		0.174978
  validation loss:		0.083417
  validation accuracy:		97.42 %
Epoch 40 of 100 took 13.086s
  training loss:		0.173773
  validation loss:		0.081250
  validation accuracy:		97.47 %
Epoch 41 of 100 took 13.102s
  training loss:		0.169333
  validation loss:		0.080232
  validation accuracy:		97.56 %
Epoch 42 of 100 took 13.158s
  training loss:		0.164896
  validation loss:		0.080232
  validation accuracy:		97.49 %
Epoch 43 of 100 took 13.084s
  training loss:		0.163908
  validation loss:		0.079561
  validation accuracy:		97.55 %
Epoch 44 of 100 took 13.173s
  training loss:		0.164107
  validation loss:		0.079025
  validation accuracy:		97.60 %
Epoch 45 of 100 took 13.161s
  training loss:		0.162825
  validation loss:		0.077193
  validation accuracy:		97.64 %
Epoch 46 of 100 took 13.088s
  training loss:		0.163285
  validation loss:		0.075507
  validation accuracy:		97.69 %
Epoch 47 of 100 took 13.071s
  training loss:		0.159028
  validation loss:		0.075269
  validation accuracy:		97.67 %
Epoch 48 of 100 took 13.089s
  training loss:		0.161904
  validation loss:		0.074521
  validation accuracy:		97.69 %
Epoch 49 of 100 took 13.179s
  training loss:		0.156929
  validation loss:		0.074093
  validation accuracy:		97.71 %
Epoch 50 of 100 took 13.161s
  training loss:		0.157412
  validation loss:		0.072420
  validation accuracy:		97.69 %
Epoch 51 of 100 took 13.094s
  training loss:		0.157613
  validation loss:		0.073353
  validation accuracy:		97.73 %
Epoch 52 of 100 took 13.180s
  training loss:		0.155631
  validation loss:		0.073631
  validation accuracy:		97.65 %
Epoch 53 of 100 took 13.084s
  training loss:		0.147875
  validation loss:		0.073215
  validation accuracy:		97.71 %
Epoch 54 of 100 took 13.184s
  training loss:		0.150547
  validation loss:		0.070255
  validation accuracy:		97.85 %
Epoch 55 of 100 took 13.080s
  training loss:		0.146630
  validation loss:		0.069850
  validation accuracy:		97.80 %
Epoch 56 of 100 took 13.186s
  training loss:		0.145007
  validation loss:		0.069716
  validation accuracy:		97.78 %
Epoch 57 of 100 took 13.123s
  training loss:		0.146069
  validation loss:		0.069670
  validation accuracy:		97.84 %
Epoch 58 of 100 took 13.132s
  training loss:		0.141933
  validation loss:		0.069092
  validation accuracy:		97.87 %
Epoch 59 of 100 took 13.087s
  training loss:		0.141847
  validation loss:		0.067604
  validation accuracy:		97.87 %
Epoch 60 of 100 took 13.166s
  training loss:		0.145470
  validation loss:		0.067936
  validation accuracy:		97.95 %
Epoch 61 of 100 took 13.095s
  training loss:		0.140837
  validation loss:		0.065683
  validation accuracy:		98.00 %
Epoch 62 of 100 took 13.073s
  training loss:		0.141146
  validation loss:		0.065760
  validation accuracy:		97.98 %
Epoch 63 of 100 took 13.094s
  training loss:		0.136621
  validation loss:		0.066879
  validation accuracy:		97.89 %
Epoch 64 of 100 took 13.166s
  training loss:		0.136690
  validation loss:		0.065348
  validation accuracy:		97.96 %
Epoch 65 of 100 took 13.113s
  training loss:		0.135494
  validation loss:		0.065081
  validation accuracy:		98.00 %
Epoch 66 of 100 took 13.102s
  training loss:		0.140406
  validation loss:		0.064996
  validation accuracy:		98.00 %
Epoch 67 of 100 took 13.177s
  training loss:		0.137557
  validation loss:		0.064746
  validation accuracy:		98.02 %
Epoch 68 of 100 took 13.080s
  training loss:		0.135553
  validation loss:		0.064799
  validation accuracy:		97.96 %
Epoch 69 of 100 took 13.087s
  training loss:		0.132724
  validation loss:		0.063707
  validation accuracy:		98.02 %
Epoch 70 of 100 took 13.154s
  training loss:		0.130388
  validation loss:		0.062893
  validation accuracy:		97.98 %
Epoch 71 of 100 took 13.124s
  training loss:		0.132096
  validation loss:		0.062060
  validation accuracy:		98.02 %
Epoch 72 of 100 took 13.133s
  training loss:		0.130090
  validation loss:		0.061370
  validation accuracy:		98.07 %
Epoch 73 of 100 took 13.131s
  training loss:		0.129759
  validation loss:		0.061341
  validation accuracy:		98.09 %
Epoch 74 of 100 took 13.098s
  training loss:		0.129300
  validation loss:		0.061128
  validation accuracy:		98.05 %
Epoch 75 of 100 took 13.161s
  training loss:		0.126904
  validation loss:		0.060384
  validation accuracy:		98.04 %
Epoch 76 of 100 took 13.085s
  training loss:		0.125833
  validation loss:		0.059749
  validation accuracy:		98.05 %
Epoch 77 of 100 took 13.075s
  training loss:		0.128386
  validation loss:		0.059250
  validation accuracy:		98.07 %
Epoch 78 of 100 took 13.182s
  training loss:		0.126138
  validation loss:		0.058974
  validation accuracy:		98.09 %
Epoch 79 of 100 took 13.073s
  training loss:		0.125852
  validation loss:		0.059249
  validation accuracy:		98.09 %
Epoch 80 of 100 took 13.070s
  training loss:		0.124316
  validation loss:		0.059263
  validation accuracy:		98.07 %
Epoch 81 of 100 took 13.175s
  training loss:		0.120854
  validation loss:		0.058829
  validation accuracy:		98.05 %
Epoch 82 of 100 took 13.084s
  training loss:		0.126798
  validation loss:		0.057532
  validation accuracy:		98.13 %
Epoch 83 of 100 took 13.083s
  training loss:		0.121787
  validation loss:		0.057746
  validation accuracy:		98.09 %
Epoch 84 of 100 took 13.167s
  training loss:		0.123374
  validation loss:		0.057951
  validation accuracy:		98.13 %
Epoch 85 of 100 took 13.075s
  training loss:		0.121737
  validation loss:		0.056965
  validation accuracy:		98.16 %
Epoch 86 of 100 took 13.182s
  training loss:		0.125782
  validation loss:		0.057331
  validation accuracy:		98.13 %
Epoch 87 of 100 took 13.299s
  training loss:		0.119118
  validation loss:		0.056765
  validation accuracy:		98.15 %
Epoch 88 of 100 took 14.100s
  training loss:		0.113672
  validation loss:		0.055729
  validation accuracy:		98.15 %
Epoch 89 of 100 took 13.054s
  training loss:		0.118930
  validation loss:		0.055812
  validation accuracy:		98.13 %
Epoch 90 of 100 took 12.960s
  training loss:		0.116444
  validation loss:		0.056732
  validation accuracy:		98.09 %
Epoch 91 of 100 took 13.037s
  training loss:		0.122383
  validation loss:		0.054866
  validation accuracy:		98.15 %
Epoch 92 of 100 took 12.962s
  training loss:		0.111423
  validation loss:		0.055071
  validation accuracy:		98.13 %
Epoch 93 of 100 took 13.057s
  training loss:		0.114130
  validation loss:		0.055228
  validation accuracy:		98.15 %
Epoch 94 of 100 took 12.946s
  training loss:		0.118887
  validation loss:		0.054528
  validation accuracy:		98.20 %
Epoch 95 of 100 took 12.989s
  training loss:		0.114292
  validation loss:		0.053846
  validation accuracy:		98.20 %
Epoch 96 of 100 took 12.998s
  training loss:		0.114040
  validation loss:		0.053711
  validation accuracy:		98.22 %
Epoch 97 of 100 took 13.057s
  training loss:		0.116407
  validation loss:		0.053359
  validation accuracy:		98.15 %
Epoch 98 of 100 took 12.986s
  training loss:		0.113805
  validation loss:		0.053103
  validation accuracy:		98.22 %
Epoch 99 of 100 took 13.163s
  training loss:		0.116158
  validation loss:		0.053601
  validation accuracy:		98.22 %
Epoch 100 of 100 took 13.485s
  training loss:		0.110472
  validation loss:		0.052645
  validation accuracy:		98.24 %
Final results:
  test loss:			0.047688
  test accuracy:		98.56 %
