loading data...
#train = 23525, #test = 4861, #valid = 5879
building model and compiling functions...
w=(32, 1, 5, 5),b=(32,)
w=(32, 32, 5, 5),b=(32,)
decomposing tensor W of shape (2, 32, 800)...
decomposing tensor B of shape (2, 800)...
starting training...
Epoch 1 of 100 took 13.074s
  training loss:		1.854623
  validation loss:		1.190020
  validation accuracy:		78.15 %
Epoch 2 of 100 took 13.127s
  training loss:		1.229180
  validation loss:		0.729290
  validation accuracy:		88.02 %
Epoch 3 of 100 took 13.094s
  training loss:		0.915240
  validation loss:		0.497941
  validation accuracy:		90.33 %
Epoch 4 of 100 took 13.098s
  training loss:		0.730970
  validation loss:		0.378188
  validation accuracy:		91.44 %
Epoch 5 of 100 took 13.086s
  training loss:		0.615652
  validation loss:		0.316047
  validation accuracy:		92.00 %
Epoch 6 of 100 took 13.070s
  training loss:		0.532342
  validation loss:		0.263769
  validation accuracy:		92.91 %
Epoch 7 of 100 took 13.098s
  training loss:		0.482277
  validation loss:		0.238998
  validation accuracy:		93.24 %
Epoch 8 of 100 took 13.181s
  training loss:		0.435357
  validation loss:		0.216805
  validation accuracy:		93.76 %
Epoch 9 of 100 took 13.138s
  training loss:		0.403922
  validation loss:		0.197127
  validation accuracy:		94.22 %
Epoch 10 of 100 took 13.088s
  training loss:		0.380099
  validation loss:		0.186074
  validation accuracy:		94.45 %
Epoch 11 of 100 took 13.106s
  training loss:		0.361570
  validation loss:		0.179113
  validation accuracy:		94.62 %
Epoch 12 of 100 took 13.262s
  training loss:		0.340410
  validation loss:		0.169286
  validation accuracy:		94.69 %
Epoch 13 of 100 took 13.076s
  training loss:		0.325364
  validation loss:		0.161496
  validation accuracy:		94.89 %
Epoch 14 of 100 took 13.082s
  training loss:		0.314469
  validation loss:		0.156140
  validation accuracy:		95.07 %
Epoch 15 of 100 took 13.123s
  training loss:		0.305694
  validation loss:		0.153399
  validation accuracy:		95.13 %
Epoch 16 of 100 took 13.086s
  training loss:		0.286991
  validation loss:		0.147098
  validation accuracy:		95.25 %
Epoch 17 of 100 took 13.155s
  training loss:		0.281302
  validation loss:		0.144424
  validation accuracy:		95.22 %
Epoch 18 of 100 took 13.185s
  training loss:		0.283657
  validation loss:		0.139510
  validation accuracy:		95.42 %
Epoch 19 of 100 took 13.111s
  training loss:		0.272381
  validation loss:		0.135085
  validation accuracy:		95.62 %
Epoch 20 of 100 took 13.082s
  training loss:		0.256815
  validation loss:		0.131503
  validation accuracy:		95.67 %
Epoch 21 of 100 took 13.085s
  training loss:		0.253805
  validation loss:		0.131948
  validation accuracy:		95.53 %
Epoch 22 of 100 took 13.099s
  training loss:		0.244905
  validation loss:		0.126624
  validation accuracy:		95.73 %
Epoch 23 of 100 took 13.061s
  training loss:		0.240560
  validation loss:		0.125629
  validation accuracy:		95.91 %
Epoch 24 of 100 took 13.101s
  training loss:		0.242051
  validation loss:		0.122719
  validation accuracy:		95.89 %
Epoch 25 of 100 took 13.090s
  training loss:		0.239587
  validation loss:		0.120839
  validation accuracy:		95.91 %
Epoch 26 of 100 took 13.077s
  training loss:		0.228730
  validation loss:		0.118907
  validation accuracy:		96.05 %
Epoch 27 of 100 took 13.148s
  training loss:		0.228457
  validation loss:		0.115595
  validation accuracy:		96.27 %
Epoch 28 of 100 took 13.223s
  training loss:		0.220645
  validation loss:		0.113461
  validation accuracy:		96.36 %
Epoch 29 of 100 took 13.103s
  training loss:		0.218227
  validation loss:		0.111950
  validation accuracy:		96.24 %
Epoch 30 of 100 took 14.613s
  training loss:		0.216348
  validation loss:		0.111040
  validation accuracy:		96.35 %
Epoch 31 of 100 took 13.496s
  training loss:		0.208538
  validation loss:		0.107329
  validation accuracy:		96.47 %
Epoch 32 of 100 took 13.188s
  training loss:		0.207281
  validation loss:		0.107658
  validation accuracy:		96.42 %
Epoch 33 of 100 took 13.225s
  training loss:		0.203398
  validation loss:		0.105929
  validation accuracy:		96.53 %
Epoch 34 of 100 took 13.223s
  training loss:		0.206413
  validation loss:		0.104333
  validation accuracy:		96.44 %
Epoch 35 of 100 took 13.214s
  training loss:		0.196807
  validation loss:		0.104373
  validation accuracy:		96.56 %
Epoch 36 of 100 took 13.401s
  training loss:		0.195990
  validation loss:		0.101060
  validation accuracy:		96.69 %
Epoch 37 of 100 took 13.219s
  training loss:		0.190428
  validation loss:		0.100819
  validation accuracy:		96.67 %
Epoch 38 of 100 took 13.270s
  training loss:		0.186287
  validation loss:		0.097835
  validation accuracy:		96.82 %
Epoch 39 of 100 took 13.201s
  training loss:		0.189736
  validation loss:		0.099441
  validation accuracy:		96.69 %
Epoch 40 of 100 took 13.599s
  training loss:		0.185109
  validation loss:		0.097751
  validation accuracy:		96.71 %
Epoch 41 of 100 took 13.562s
  training loss:		0.183541
  validation loss:		0.094835
  validation accuracy:		96.84 %
Epoch 42 of 100 took 14.343s
  training loss:		0.184381
  validation loss:		0.095538
  validation accuracy:		96.73 %
Epoch 43 of 100 took 15.533s
  training loss:		0.181266
  validation loss:		0.093498
  validation accuracy:		96.87 %
Epoch 44 of 100 took 15.295s
  training loss:		0.173654
  validation loss:		0.091090
  validation accuracy:		97.00 %
Epoch 45 of 100 took 16.014s
  training loss:		0.178917
  validation loss:		0.092202
  validation accuracy:		96.91 %
Epoch 46 of 100 took 14.695s
  training loss:		0.174644
  validation loss:		0.091524
  validation accuracy:		96.87 %
Epoch 47 of 100 took 13.502s
  training loss:		0.171681
  validation loss:		0.089827
  validation accuracy:		97.07 %
Epoch 48 of 100 took 14.070s
  training loss:		0.166475
  validation loss:		0.090307
  validation accuracy:		96.98 %
Epoch 49 of 100 took 15.817s
  training loss:		0.164494
  validation loss:		0.087510
  validation accuracy:		97.13 %
Epoch 50 of 100 took 15.835s
  training loss:		0.163578
  validation loss:		0.085534
  validation accuracy:		97.24 %
Epoch 51 of 100 took 14.986s
  training loss:		0.164543
  validation loss:		0.085865
  validation accuracy:		97.16 %
Epoch 52 of 100 took 14.363s
  training loss:		0.166730
  validation loss:		0.085577
  validation accuracy:		97.20 %
Epoch 53 of 100 took 14.188s
  training loss:		0.167200
  validation loss:		0.086152
  validation accuracy:		97.11 %
Epoch 54 of 100 took 14.097s
  training loss:		0.159572
  validation loss:		0.083402
  validation accuracy:		97.18 %
Epoch 55 of 100 took 13.799s
  training loss:		0.153606
  validation loss:		0.083165
  validation accuracy:		97.18 %
Epoch 56 of 100 took 13.694s
  training loss:		0.157576
  validation loss:		0.080424
  validation accuracy:		97.25 %
Epoch 57 of 100 took 13.653s
  training loss:		0.162216
  validation loss:		0.083099
  validation accuracy:		97.22 %
Epoch 58 of 100 took 13.999s
  training loss:		0.154001
  validation loss:		0.081525
  validation accuracy:		97.20 %
Epoch 59 of 100 took 13.969s
  training loss:		0.154722
  validation loss:		0.081171
  validation accuracy:		97.29 %
Epoch 60 of 100 took 13.765s
  training loss:		0.152354
  validation loss:		0.080370
  validation accuracy:		97.29 %
Epoch 61 of 100 took 13.752s
  training loss:		0.152819
  validation loss:		0.080195
  validation accuracy:		97.24 %
Epoch 62 of 100 took 13.495s
  training loss:		0.153633
  validation loss:		0.080155
  validation accuracy:		97.25 %
Epoch 63 of 100 took 13.876s
  training loss:		0.150216
  validation loss:		0.078057
  validation accuracy:		97.25 %
Epoch 64 of 100 took 13.892s
  training loss:		0.149997
  validation loss:		0.077758
  validation accuracy:		97.35 %
Epoch 65 of 100 took 14.252s
  training loss:		0.151136
  validation loss:		0.076955
  validation accuracy:		97.44 %
Epoch 66 of 100 took 14.062s
  training loss:		0.149405
  validation loss:		0.077161
  validation accuracy:		97.42 %
Epoch 67 of 100 took 13.820s
  training loss:		0.147899
  validation loss:		0.076980
  validation accuracy:		97.40 %
Epoch 68 of 100 took 13.803s
  training loss:		0.142210
  validation loss:		0.075390
  validation accuracy:		97.38 %
Epoch 69 of 100 took 14.041s
  training loss:		0.143169
  validation loss:		0.074421
  validation accuracy:		97.47 %
Epoch 70 of 100 took 13.611s
  training loss:		0.144088
  validation loss:		0.073368
  validation accuracy:		97.55 %
Epoch 71 of 100 took 14.140s
  training loss:		0.140995
  validation loss:		0.073962
  validation accuracy:		97.49 %
Epoch 72 of 100 took 13.885s
  training loss:		0.141842
  validation loss:		0.073077
  validation accuracy:		97.49 %
Epoch 73 of 100 took 13.480s
  training loss:		0.137050
  validation loss:		0.071839
  validation accuracy:		97.53 %
Epoch 74 of 100 took 13.589s
  training loss:		0.139250
  validation loss:		0.072164
  validation accuracy:		97.55 %
Epoch 75 of 100 took 14.040s
  training loss:		0.138106
  validation loss:		0.073507
  validation accuracy:		97.42 %
Epoch 76 of 100 took 14.368s
  training loss:		0.138668
  validation loss:		0.071184
  validation accuracy:		97.53 %
Epoch 77 of 100 took 14.157s
  training loss:		0.129685
  validation loss:		0.070222
  validation accuracy:		97.67 %
Epoch 78 of 100 took 13.726s
  training loss:		0.137640
  validation loss:		0.071568
  validation accuracy:		97.53 %
Epoch 79 of 100 took 13.516s
  training loss:		0.132030
  validation loss:		0.069435
  validation accuracy:		97.69 %
Epoch 80 of 100 took 13.576s
  training loss:		0.135425
  validation loss:		0.069908
  validation accuracy:		97.65 %
Epoch 81 of 100 took 13.672s
  training loss:		0.134184
  validation loss:		0.071044
  validation accuracy:		97.62 %
Epoch 82 of 100 took 13.527s
  training loss:		0.131401
  validation loss:		0.069129
  validation accuracy:		97.62 %
Epoch 83 of 100 took 13.625s
  training loss:		0.131091
  validation loss:		0.069182
  validation accuracy:		97.65 %
Epoch 84 of 100 took 13.588s
  training loss:		0.134878
  validation loss:		0.070101
  validation accuracy:		97.60 %
Epoch 85 of 100 took 13.575s
  training loss:		0.130495
  validation loss:		0.067198
  validation accuracy:		97.73 %
Epoch 86 of 100 took 13.525s
  training loss:		0.130860
  validation loss:		0.067814
  validation accuracy:		97.71 %
Epoch 87 of 100 took 13.455s
  training loss:		0.127903
  validation loss:		0.067724
  validation accuracy:		97.73 %
Epoch 88 of 100 took 13.819s
  training loss:		0.128597
  validation loss:		0.066826
  validation accuracy:		97.67 %
Epoch 89 of 100 took 13.351s
  training loss:		0.124964
  validation loss:		0.066033
  validation accuracy:		97.87 %
Epoch 90 of 100 took 13.479s
  training loss:		0.128696
  validation loss:		0.066018
  validation accuracy:		97.82 %
Epoch 91 of 100 took 15.625s
  training loss:		0.128768
  validation loss:		0.065562
  validation accuracy:		97.84 %
Epoch 92 of 100 took 15.612s
  training loss:		0.127461
  validation loss:		0.067147
  validation accuracy:		97.67 %
Epoch 93 of 100 took 14.956s
  training loss:		0.124625
  validation loss:		0.065894
  validation accuracy:		97.78 %
Epoch 94 of 100 took 14.363s
  training loss:		0.122093
  validation loss:		0.065327
  validation accuracy:		97.78 %
Epoch 95 of 100 took 14.749s
  training loss:		0.117369
  validation loss:		0.064212
  validation accuracy:		97.76 %
Epoch 96 of 100 took 14.805s
  training loss:		0.120476
  validation loss:		0.063434
  validation accuracy:		97.89 %
Epoch 97 of 100 took 13.644s
  training loss:		0.123131
  validation loss:		0.063985
  validation accuracy:		97.84 %
Epoch 98 of 100 took 13.835s
  training loss:		0.117487
  validation loss:		0.063162
  validation accuracy:		97.87 %
Epoch 99 of 100 took 14.731s
  training loss:		0.126235
  validation loss:		0.063355
  validation accuracy:		97.82 %
Epoch 100 of 100 took 15.855s
  training loss:		0.119916
  validation loss:		0.063307
  validation accuracy:		97.76 %
Final results:
  test loss:			0.057372
  test accuracy:		98.11 %
